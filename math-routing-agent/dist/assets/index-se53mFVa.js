(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function dg(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var iu={exports:{}},Ys={},su={exports:{}},we={},df;function _y(){if(df)return we;df=1;/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function y(N){return N===null||typeof N!="object"?null:(N=v&&N[v]||N["@@iterator"],typeof N=="function"?N:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,C={};function T(N,V,oe){this.props=N,this.context=V,this.refs=C,this.updater=oe||A}T.prototype.isReactComponent={},T.prototype.setState=function(N,V){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,V,"setState")},T.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function x(){}x.prototype=T.prototype;function I(N,V,oe){this.props=N,this.context=V,this.refs=C,this.updater=oe||A}var P=I.prototype=new x;P.constructor=I,w(P,T.prototype),P.isPureReactComponent=!0;var M=Array.isArray,F=Object.prototype.hasOwnProperty,H={current:null},O={key:!0,ref:!0,__self:!0,__source:!0};function K(N,V,oe){var ve,Ee={},_e=null,fe=null;if(V!=null)for(ve in V.ref!==void 0&&(fe=V.ref),V.key!==void 0&&(_e=""+V.key),V)F.call(V,ve)&&!O.hasOwnProperty(ve)&&(Ee[ve]=V[ve]);var Ae=arguments.length-2;if(Ae===1)Ee.children=oe;else if(1<Ae){for(var De=Array(Ae),Pt=0;Pt<Ae;Pt++)De[Pt]=arguments[Pt+2];Ee.children=De}if(N&&N.defaultProps)for(ve in Ae=N.defaultProps,Ae)Ee[ve]===void 0&&(Ee[ve]=Ae[ve]);return{$$typeof:i,type:N,key:_e,ref:fe,props:Ee,_owner:H.current}}function q(N,V){return{$$typeof:i,type:N.type,key:V,ref:N.ref,props:N.props,_owner:N._owner}}function J(N){return typeof N=="object"&&N!==null&&N.$$typeof===i}function j(N){var V={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(oe){return V[oe]})}var le=/\/+/g;function ge(N,V){return typeof N=="object"&&N!==null&&N.key!=null?j(""+N.key):V.toString(36)}function Pe(N,V,oe,ve,Ee){var _e=typeof N;(_e==="undefined"||_e==="boolean")&&(N=null);var fe=!1;if(N===null)fe=!0;else switch(_e){case"string":case"number":fe=!0;break;case"object":switch(N.$$typeof){case i:case e:fe=!0}}if(fe)return fe=N,Ee=Ee(fe),N=ve===""?"."+ge(fe,0):ve,M(Ee)?(oe="",N!=null&&(oe=N.replace(le,"$&/")+"/"),Pe(Ee,V,oe,"",function(Pt){return Pt})):Ee!=null&&(J(Ee)&&(Ee=q(Ee,oe+(!Ee.key||fe&&fe.key===Ee.key?"":(""+Ee.key).replace(le,"$&/")+"/")+N)),V.push(Ee)),1;if(fe=0,ve=ve===""?".":ve+":",M(N))for(var Ae=0;Ae<N.length;Ae++){_e=N[Ae];var De=ve+ge(_e,Ae);fe+=Pe(_e,V,oe,De,Ee)}else if(De=y(N),typeof De=="function")for(N=De.call(N),Ae=0;!(_e=N.next()).done;)_e=_e.value,De=ve+ge(_e,Ae++),fe+=Pe(_e,V,oe,De,Ee);else if(_e==="object")throw V=String(N),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return fe}function Te(N,V,oe){if(N==null)return N;var ve=[],Ee=0;return Pe(N,ve,"","",function(_e){return V.call(oe,_e,Ee++)}),ve}function ye(N){if(N._status===-1){var V=N._result;V=V(),V.then(function(oe){(N._status===0||N._status===-1)&&(N._status=1,N._result=oe)},function(oe){(N._status===0||N._status===-1)&&(N._status=2,N._result=oe)}),N._status===-1&&(N._status=0,N._result=V)}if(N._status===1)return N._result.default;throw N._result}var X={current:null},G={transition:null},ae={ReactCurrentDispatcher:X,ReactCurrentBatchConfig:G,ReactCurrentOwner:H};function Q(){throw Error("act(...) is not supported in production builds of React.")}return we.Children={map:Te,forEach:function(N,V,oe){Te(N,function(){V.apply(this,arguments)},oe)},count:function(N){var V=0;return Te(N,function(){V++}),V},toArray:function(N){return Te(N,function(V){return V})||[]},only:function(N){if(!J(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},we.Component=T,we.Fragment=t,we.Profiler=s,we.PureComponent=I,we.StrictMode=n,we.Suspense=d,we.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ae,we.act=Q,we.cloneElement=function(N,V,oe){if(N==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+N+".");var ve=w({},N.props),Ee=N.key,_e=N.ref,fe=N._owner;if(V!=null){if(V.ref!==void 0&&(_e=V.ref,fe=H.current),V.key!==void 0&&(Ee=""+V.key),N.type&&N.type.defaultProps)var Ae=N.type.defaultProps;for(De in V)F.call(V,De)&&!O.hasOwnProperty(De)&&(ve[De]=V[De]===void 0&&Ae!==void 0?Ae[De]:V[De])}var De=arguments.length-2;if(De===1)ve.children=oe;else if(1<De){Ae=Array(De);for(var Pt=0;Pt<De;Pt++)Ae[Pt]=arguments[Pt+2];ve.children=Ae}return{$$typeof:i,type:N.type,key:Ee,ref:_e,props:ve,_owner:fe}},we.createContext=function(N){return N={$$typeof:l,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},N.Provider={$$typeof:o,_context:N},N.Consumer=N},we.createElement=K,we.createFactory=function(N){var V=K.bind(null,N);return V.type=N,V},we.createRef=function(){return{current:null}},we.forwardRef=function(N){return{$$typeof:u,render:N}},we.isValidElement=J,we.lazy=function(N){return{$$typeof:p,_payload:{_status:-1,_result:N},_init:ye}},we.memo=function(N,V){return{$$typeof:h,type:N,compare:V===void 0?null:V}},we.startTransition=function(N){var V=G.transition;G.transition={};try{N()}finally{G.transition=V}},we.unstable_act=Q,we.useCallback=function(N,V){return X.current.useCallback(N,V)},we.useContext=function(N){return X.current.useContext(N)},we.useDebugValue=function(){},we.useDeferredValue=function(N){return X.current.useDeferredValue(N)},we.useEffect=function(N,V){return X.current.useEffect(N,V)},we.useId=function(){return X.current.useId()},we.useImperativeHandle=function(N,V,oe){return X.current.useImperativeHandle(N,V,oe)},we.useInsertionEffect=function(N,V){return X.current.useInsertionEffect(N,V)},we.useLayoutEffect=function(N,V){return X.current.useLayoutEffect(N,V)},we.useMemo=function(N,V){return X.current.useMemo(N,V)},we.useReducer=function(N,V,oe){return X.current.useReducer(N,V,oe)},we.useRef=function(N){return X.current.useRef(N)},we.useState=function(N){return X.current.useState(N)},we.useSyncExternalStore=function(N,V,oe){return X.current.useSyncExternalStore(N,V,oe)},we.useTransition=function(){return X.current.useTransition()},we.version="18.3.1",we}var hf;function Hu(){return hf||(hf=1,su.exports=_y()),su.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ff;function Ey(){if(ff)return Ys;ff=1;var i=Hu(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(u,d,h){var p,v={},y=null,A=null;h!==void 0&&(y=""+h),d.key!==void 0&&(y=""+d.key),d.ref!==void 0&&(A=d.ref);for(p in d)n.call(d,p)&&!o.hasOwnProperty(p)&&(v[p]=d[p]);if(u&&u.defaultProps)for(p in d=u.defaultProps,d)v[p]===void 0&&(v[p]=d[p]);return{$$typeof:e,type:u,key:y,ref:A,props:v,_owner:s.current}}return Ys.Fragment=t,Ys.jsx=l,Ys.jsxs=l,Ys}var pf;function Ay(){return pf||(pf=1,iu.exports=Ey()),iu.exports}var U=Ay(),pt=Hu();const wy=dg(pt);var To={},ru={exports:{}},xt={},ou={exports:{}},au={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gf;function Sy(){return gf||(gf=1,(function(i){function e(G,ae){var Q=G.length;G.push(ae);e:for(;0<Q;){var N=Q-1>>>1,V=G[N];if(0<s(V,ae))G[N]=ae,G[Q]=V,Q=N;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var ae=G[0],Q=G.pop();if(Q!==ae){G[0]=Q;e:for(var N=0,V=G.length,oe=V>>>1;N<oe;){var ve=2*(N+1)-1,Ee=G[ve],_e=ve+1,fe=G[_e];if(0>s(Ee,Q))_e<V&&0>s(fe,Ee)?(G[N]=fe,G[_e]=Q,N=_e):(G[N]=Ee,G[ve]=Q,N=ve);else if(_e<V&&0>s(fe,Q))G[N]=fe,G[_e]=Q,N=_e;else break e}}return ae}function s(G,ae){var Q=G.sortIndex-ae.sortIndex;return Q!==0?Q:G.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var d=[],h=[],p=1,v=null,y=3,A=!1,w=!1,C=!1,T=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(G){for(var ae=t(h);ae!==null;){if(ae.callback===null)n(h);else if(ae.startTime<=G)n(h),ae.sortIndex=ae.expirationTime,e(d,ae);else break;ae=t(h)}}function M(G){if(C=!1,P(G),!w)if(t(d)!==null)w=!0,ye(F);else{var ae=t(h);ae!==null&&X(M,ae.startTime-G)}}function F(G,ae){w=!1,C&&(C=!1,x(K),K=-1),A=!0;var Q=y;try{for(P(ae),v=t(d);v!==null&&(!(v.expirationTime>ae)||G&&!j());){var N=v.callback;if(typeof N=="function"){v.callback=null,y=v.priorityLevel;var V=N(v.expirationTime<=ae);ae=i.unstable_now(),typeof V=="function"?v.callback=V:v===t(d)&&n(d),P(ae)}else n(d);v=t(d)}if(v!==null)var oe=!0;else{var ve=t(h);ve!==null&&X(M,ve.startTime-ae),oe=!1}return oe}finally{v=null,y=Q,A=!1}}var H=!1,O=null,K=-1,q=5,J=-1;function j(){return!(i.unstable_now()-J<q)}function le(){if(O!==null){var G=i.unstable_now();J=G;var ae=!0;try{ae=O(!0,G)}finally{ae?ge():(H=!1,O=null)}}else H=!1}var ge;if(typeof I=="function")ge=function(){I(le)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,Te=Pe.port2;Pe.port1.onmessage=le,ge=function(){Te.postMessage(null)}}else ge=function(){T(le,0)};function ye(G){O=G,H||(H=!0,ge())}function X(G,ae){K=T(function(){G(i.unstable_now())},ae)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_continueExecution=function(){w||A||(w=!0,ye(F))},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return y},i.unstable_getFirstCallbackNode=function(){return t(d)},i.unstable_next=function(G){switch(y){case 1:case 2:case 3:var ae=3;break;default:ae=y}var Q=y;y=ae;try{return G()}finally{y=Q}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(G,ae){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var Q=y;y=G;try{return ae()}finally{y=Q}},i.unstable_scheduleCallback=function(G,ae,Q){var N=i.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?N+Q:N):Q=N,G){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=Q+V,G={id:p++,callback:ae,priorityLevel:G,startTime:Q,expirationTime:V,sortIndex:-1},Q>N?(G.sortIndex=Q,e(h,G),t(d)===null&&G===t(h)&&(C?(x(K),K=-1):C=!0,X(M,Q-N))):(G.sortIndex=V,e(d,G),w||A||(w=!0,ye(F))),G},i.unstable_shouldYield=j,i.unstable_wrapCallback=function(G){var ae=y;return function(){var Q=y;y=ae;try{return G.apply(this,arguments)}finally{y=Q}}}})(au)),au}var mf;function Cy(){return mf||(mf=1,ou.exports=Sy()),ou.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vf;function Ty(){if(vf)return xt;vf=1;var i=Hu(),e=Cy();function t(r){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+r,c=1;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function o(r,a){l(r,a),l(r+"Capture",a)}function l(r,a){for(s[r]=a,r=0;r<a.length;r++)n.add(a[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},v={};function y(r){return d.call(v,r)?!0:d.call(p,r)?!1:h.test(r)?v[r]=!0:(p[r]=!0,!1)}function A(r,a,c,m){if(c!==null&&c.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return m?!1:c!==null?!c.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function w(r,a,c,m){if(a===null||typeof a>"u"||A(r,a,c,m))return!0;if(m)return!1;if(c!==null)switch(c.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function C(r,a,c,m,_,E,S){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=m,this.attributeNamespace=_,this.mustUseProperty=c,this.propertyName=r,this.type=a,this.sanitizeURL=E,this.removeEmptyString=S}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){T[r]=new C(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var a=r[0];T[a]=new C(a,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){T[r]=new C(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){T[r]=new C(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){T[r]=new C(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){T[r]=new C(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){T[r]=new C(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){T[r]=new C(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){T[r]=new C(r,5,!1,r.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function I(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var a=r.replace(x,I);T[a]=new C(a,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var a=r.replace(x,I);T[a]=new C(a,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var a=r.replace(x,I);T[a]=new C(a,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){T[r]=new C(r,1,!1,r.toLowerCase(),null,!1,!1)}),T.xlinkHref=new C("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){T[r]=new C(r,1,!1,r.toLowerCase(),null,!0,!0)});function P(r,a,c,m){var _=T.hasOwnProperty(a)?T[a]:null;(_!==null?_.type!==0:m||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(w(a,c,_,m)&&(c=null),m||_===null?y(a)&&(c===null?r.removeAttribute(a):r.setAttribute(a,""+c)):_.mustUseProperty?r[_.propertyName]=c===null?_.type===3?!1:"":c:(a=_.attributeName,m=_.attributeNamespace,c===null?r.removeAttribute(a):(_=_.type,c=_===3||_===4&&c===!0?"":""+c,m?r.setAttributeNS(m,a,c):r.setAttribute(a,c))))}var M=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),H=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),K=Symbol.for("react.strict_mode"),q=Symbol.for("react.profiler"),J=Symbol.for("react.provider"),j=Symbol.for("react.context"),le=Symbol.for("react.forward_ref"),ge=Symbol.for("react.suspense"),Pe=Symbol.for("react.suspense_list"),Te=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),X=Symbol.for("react.offscreen"),G=Symbol.iterator;function ae(r){return r===null||typeof r!="object"?null:(r=G&&r[G]||r["@@iterator"],typeof r=="function"?r:null)}var Q=Object.assign,N;function V(r){if(N===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);N=a&&a[1]||""}return`
`+N+r}var oe=!1;function ve(r,a){if(!r||oe)return"";oe=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(B){var m=B}Reflect.construct(r,[],a)}else{try{a.call()}catch(B){m=B}r.call(a.prototype)}else{try{throw Error()}catch(B){m=B}r()}}catch(B){if(B&&m&&typeof B.stack=="string"){for(var _=B.stack.split(`
`),E=m.stack.split(`
`),S=_.length-1,k=E.length-1;1<=S&&0<=k&&_[S]!==E[k];)k--;for(;1<=S&&0<=k;S--,k--)if(_[S]!==E[k]){if(S!==1||k!==1)do if(S--,k--,0>k||_[S]!==E[k]){var R=`
`+_[S].replace(" at new "," at ");return r.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",r.displayName)),R}while(1<=S&&0<=k);break}}}finally{oe=!1,Error.prepareStackTrace=c}return(r=r?r.displayName||r.name:"")?V(r):""}function Ee(r){switch(r.tag){case 5:return V(r.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return r=ve(r.type,!1),r;case 11:return r=ve(r.type.render,!1),r;case 1:return r=ve(r.type,!0),r;default:return""}}function _e(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case O:return"Fragment";case H:return"Portal";case q:return"Profiler";case K:return"StrictMode";case ge:return"Suspense";case Pe:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case j:return(r.displayName||"Context")+".Consumer";case J:return(r._context.displayName||"Context")+".Provider";case le:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Te:return a=r.displayName||null,a!==null?a:_e(r.type)||"Memo";case ye:a=r._payload,r=r._init;try{return _e(r(a))}catch{}}return null}function fe(r){var a=r.type;switch(r.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=a.render,r=r.displayName||r.name||"",a.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _e(a);case 8:return a===K?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Ae(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function De(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Pt(r){var a=De(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),m=""+r[a];if(!r.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var _=c.get,E=c.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return _.call(this)},set:function(S){m=""+S,E.call(this,S)}}),Object.defineProperty(r,a,{enumerable:c.enumerable}),{getValue:function(){return m},setValue:function(S){m=""+S},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function pr(r){r._valueTracker||(r._valueTracker=Pt(r))}function mc(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var c=a.getValue(),m="";return r&&(m=De(r)?r.checked?"true":"false":r.value),r=m,r!==c?(a.setValue(r),!0):!1}function gr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function ca(r,a){var c=a.checked;return Q({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??r._wrapperState.initialChecked})}function vc(r,a){var c=a.defaultValue==null?"":a.defaultValue,m=a.checked!=null?a.checked:a.defaultChecked;c=Ae(a.value!=null?a.value:c),r._wrapperState={initialChecked:m,initialValue:c,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function yc(r,a){a=a.checked,a!=null&&P(r,"checked",a,!1)}function da(r,a){yc(r,a);var c=Ae(a.value),m=a.type;if(c!=null)m==="number"?(c===0&&r.value===""||r.value!=c)&&(r.value=""+c):r.value!==""+c&&(r.value=""+c);else if(m==="submit"||m==="reset"){r.removeAttribute("value");return}a.hasOwnProperty("value")?ha(r,a.type,c):a.hasOwnProperty("defaultValue")&&ha(r,a.type,Ae(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(r.defaultChecked=!!a.defaultChecked)}function _c(r,a,c){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var m=a.type;if(!(m!=="submit"&&m!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+r._wrapperState.initialValue,c||a===r.value||(r.value=a),r.defaultValue=a}c=r.name,c!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,c!==""&&(r.name=c)}function ha(r,a,c){(a!=="number"||gr(r.ownerDocument)!==r)&&(c==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+c&&(r.defaultValue=""+c))}var ls=Array.isArray;function ki(r,a,c,m){if(r=r.options,a){a={};for(var _=0;_<c.length;_++)a["$"+c[_]]=!0;for(c=0;c<r.length;c++)_=a.hasOwnProperty("$"+r[c].value),r[c].selected!==_&&(r[c].selected=_),_&&m&&(r[c].defaultSelected=!0)}else{for(c=""+Ae(c),a=null,_=0;_<r.length;_++){if(r[_].value===c){r[_].selected=!0,m&&(r[_].defaultSelected=!0);return}a!==null||r[_].disabled||(a=r[_])}a!==null&&(a.selected=!0)}}function fa(r,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return Q({},a,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Ec(r,a){var c=a.value;if(c==null){if(c=a.children,a=a.defaultValue,c!=null){if(a!=null)throw Error(t(92));if(ls(c)){if(1<c.length)throw Error(t(93));c=c[0]}a=c}a==null&&(a=""),c=a}r._wrapperState={initialValue:Ae(c)}}function Ac(r,a){var c=Ae(a.value),m=Ae(a.defaultValue);c!=null&&(c=""+c,c!==r.value&&(r.value=c),a.defaultValue==null&&r.defaultValue!==c&&(r.defaultValue=c)),m!=null&&(r.defaultValue=""+m)}function wc(r){var a=r.textContent;a===r._wrapperState.initialValue&&a!==""&&a!==null&&(r.value=a)}function Sc(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pa(r,a){return r==null||r==="http://www.w3.org/1999/xhtml"?Sc(a):r==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var mr,Cc=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,c,m,_){MSApp.execUnsafeLocalFunction(function(){return r(a,c,m,_)})}:r})(function(r,a){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=a;else{for(mr=mr||document.createElement("div"),mr.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=mr.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;a.firstChild;)r.appendChild(a.firstChild)}});function us(r,a){if(a){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=a;return}}r.textContent=a}var cs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sm=["Webkit","ms","Moz","O"];Object.keys(cs).forEach(function(r){Sm.forEach(function(a){a=a+r.charAt(0).toUpperCase()+r.substring(1),cs[a]=cs[r]})});function Tc(r,a,c){return a==null||typeof a=="boolean"||a===""?"":c||typeof a!="number"||a===0||cs.hasOwnProperty(r)&&cs[r]?(""+a).trim():a+"px"}function xc(r,a){r=r.style;for(var c in a)if(a.hasOwnProperty(c)){var m=c.indexOf("--")===0,_=Tc(c,a[c],m);c==="float"&&(c="cssFloat"),m?r.setProperty(c,_):r[c]=_}}var Cm=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ga(r,a){if(a){if(Cm[r]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function ma(r,a){if(r.indexOf("-")===-1)return typeof a.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var va=null;function ya(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var _a=null,Ii=null,Ri=null;function kc(r){if(r=Ms(r)){if(typeof _a!="function")throw Error(t(280));var a=r.stateNode;a&&(a=Br(a),_a(r.stateNode,r.type,a))}}function Ic(r){Ii?Ri?Ri.push(r):Ri=[r]:Ii=r}function Rc(){if(Ii){var r=Ii,a=Ri;if(Ri=Ii=null,kc(r),a)for(r=0;r<a.length;r++)kc(a[r])}}function bc(r,a){return r(a)}function Pc(){}var Ea=!1;function Mc(r,a,c){if(Ea)return r(a,c);Ea=!0;try{return bc(r,a,c)}finally{Ea=!1,(Ii!==null||Ri!==null)&&(Pc(),Rc())}}function ds(r,a){var c=r.stateNode;if(c===null)return null;var m=Br(c);if(m===null)return null;c=m[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(r=r.type,m=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!m;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(t(231,a,typeof c));return c}var Aa=!1;if(u)try{var hs={};Object.defineProperty(hs,"passive",{get:function(){Aa=!0}}),window.addEventListener("test",hs,hs),window.removeEventListener("test",hs,hs)}catch{Aa=!1}function Tm(r,a,c,m,_,E,S,k,R){var B=Array.prototype.slice.call(arguments,3);try{a.apply(c,B)}catch($){this.onError($)}}var fs=!1,vr=null,yr=!1,wa=null,xm={onError:function(r){fs=!0,vr=r}};function km(r,a,c,m,_,E,S,k,R){fs=!1,vr=null,Tm.apply(xm,arguments)}function Im(r,a,c,m,_,E,S,k,R){if(km.apply(this,arguments),fs){if(fs){var B=vr;fs=!1,vr=null}else throw Error(t(198));yr||(yr=!0,wa=B)}}function ni(r){var a=r,c=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(c=a.return),r=a.return;while(r)}return a.tag===3?c:null}function Nc(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function Lc(r){if(ni(r)!==r)throw Error(t(188))}function Rm(r){var a=r.alternate;if(!a){if(a=ni(r),a===null)throw Error(t(188));return a!==r?null:r}for(var c=r,m=a;;){var _=c.return;if(_===null)break;var E=_.alternate;if(E===null){if(m=_.return,m!==null){c=m;continue}break}if(_.child===E.child){for(E=_.child;E;){if(E===c)return Lc(_),r;if(E===m)return Lc(_),a;E=E.sibling}throw Error(t(188))}if(c.return!==m.return)c=_,m=E;else{for(var S=!1,k=_.child;k;){if(k===c){S=!0,c=_,m=E;break}if(k===m){S=!0,m=_,c=E;break}k=k.sibling}if(!S){for(k=E.child;k;){if(k===c){S=!0,c=E,m=_;break}if(k===m){S=!0,m=E,c=_;break}k=k.sibling}if(!S)throw Error(t(189))}}if(c.alternate!==m)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?r:a}function Dc(r){return r=Rm(r),r!==null?Fc(r):null}function Fc(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var a=Fc(r);if(a!==null)return a;r=r.sibling}return null}var Uc=e.unstable_scheduleCallback,Hc=e.unstable_cancelCallback,bm=e.unstable_shouldYield,Pm=e.unstable_requestPaint,$e=e.unstable_now,Mm=e.unstable_getCurrentPriorityLevel,Sa=e.unstable_ImmediatePriority,Bc=e.unstable_UserBlockingPriority,_r=e.unstable_NormalPriority,Nm=e.unstable_LowPriority,Oc=e.unstable_IdlePriority,Er=null,an=null;function Lm(r){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Er,r,void 0,(r.current.flags&128)===128)}catch{}}var Kt=Math.clz32?Math.clz32:Um,Dm=Math.log,Fm=Math.LN2;function Um(r){return r>>>=0,r===0?32:31-(Dm(r)/Fm|0)|0}var Ar=64,wr=4194304;function ps(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Sr(r,a){var c=r.pendingLanes;if(c===0)return 0;var m=0,_=r.suspendedLanes,E=r.pingedLanes,S=c&268435455;if(S!==0){var k=S&~_;k!==0?m=ps(k):(E&=S,E!==0&&(m=ps(E)))}else S=c&~_,S!==0?m=ps(S):E!==0&&(m=ps(E));if(m===0)return 0;if(a!==0&&a!==m&&(a&_)===0&&(_=m&-m,E=a&-a,_>=E||_===16&&(E&4194240)!==0))return a;if((m&4)!==0&&(m|=c&16),a=r.entangledLanes,a!==0)for(r=r.entanglements,a&=m;0<a;)c=31-Kt(a),_=1<<c,m|=r[c],a&=~_;return m}function Hm(r,a){switch(r){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bm(r,a){for(var c=r.suspendedLanes,m=r.pingedLanes,_=r.expirationTimes,E=r.pendingLanes;0<E;){var S=31-Kt(E),k=1<<S,R=_[S];R===-1?((k&c)===0||(k&m)!==0)&&(_[S]=Hm(k,a)):R<=a&&(r.expiredLanes|=k),E&=~k}}function Ca(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function Vc(){var r=Ar;return Ar<<=1,(Ar&4194240)===0&&(Ar=64),r}function Ta(r){for(var a=[],c=0;31>c;c++)a.push(r);return a}function gs(r,a,c){r.pendingLanes|=a,a!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,a=31-Kt(a),r[a]=c}function Om(r,a){var c=r.pendingLanes&~a;r.pendingLanes=a,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=a,r.mutableReadLanes&=a,r.entangledLanes&=a,a=r.entanglements;var m=r.eventTimes;for(r=r.expirationTimes;0<c;){var _=31-Kt(c),E=1<<_;a[_]=0,m[_]=-1,r[_]=-1,c&=~E}}function xa(r,a){var c=r.entangledLanes|=a;for(r=r.entanglements;c;){var m=31-Kt(c),_=1<<m;_&a|r[m]&a&&(r[m]|=a),c&=~_}}var Me=0;function Gc(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var zc,ka,qc,$c,Wc,Ia=!1,Cr=[],Mn=null,Nn=null,Ln=null,ms=new Map,vs=new Map,Dn=[],Vm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yc(r,a){switch(r){case"focusin":case"focusout":Mn=null;break;case"dragenter":case"dragleave":Nn=null;break;case"mouseover":case"mouseout":Ln=null;break;case"pointerover":case"pointerout":ms.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":vs.delete(a.pointerId)}}function ys(r,a,c,m,_,E){return r===null||r.nativeEvent!==E?(r={blockedOn:a,domEventName:c,eventSystemFlags:m,nativeEvent:E,targetContainers:[_]},a!==null&&(a=Ms(a),a!==null&&ka(a)),r):(r.eventSystemFlags|=m,a=r.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),r)}function Gm(r,a,c,m,_){switch(a){case"focusin":return Mn=ys(Mn,r,a,c,m,_),!0;case"dragenter":return Nn=ys(Nn,r,a,c,m,_),!0;case"mouseover":return Ln=ys(Ln,r,a,c,m,_),!0;case"pointerover":var E=_.pointerId;return ms.set(E,ys(ms.get(E)||null,r,a,c,m,_)),!0;case"gotpointercapture":return E=_.pointerId,vs.set(E,ys(vs.get(E)||null,r,a,c,m,_)),!0}return!1}function Kc(r){var a=ii(r.target);if(a!==null){var c=ni(a);if(c!==null){if(a=c.tag,a===13){if(a=Nc(c),a!==null){r.blockedOn=a,Wc(r.priority,function(){qc(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Tr(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var c=ba(r.domEventName,r.eventSystemFlags,a[0],r.nativeEvent);if(c===null){c=r.nativeEvent;var m=new c.constructor(c.type,c);va=m,c.target.dispatchEvent(m),va=null}else return a=Ms(c),a!==null&&ka(a),r.blockedOn=c,!1;a.shift()}return!0}function Jc(r,a,c){Tr(r)&&c.delete(a)}function zm(){Ia=!1,Mn!==null&&Tr(Mn)&&(Mn=null),Nn!==null&&Tr(Nn)&&(Nn=null),Ln!==null&&Tr(Ln)&&(Ln=null),ms.forEach(Jc),vs.forEach(Jc)}function _s(r,a){r.blockedOn===a&&(r.blockedOn=null,Ia||(Ia=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,zm)))}function Es(r){function a(_){return _s(_,r)}if(0<Cr.length){_s(Cr[0],r);for(var c=1;c<Cr.length;c++){var m=Cr[c];m.blockedOn===r&&(m.blockedOn=null)}}for(Mn!==null&&_s(Mn,r),Nn!==null&&_s(Nn,r),Ln!==null&&_s(Ln,r),ms.forEach(a),vs.forEach(a),c=0;c<Dn.length;c++)m=Dn[c],m.blockedOn===r&&(m.blockedOn=null);for(;0<Dn.length&&(c=Dn[0],c.blockedOn===null);)Kc(c),c.blockedOn===null&&Dn.shift()}var bi=M.ReactCurrentBatchConfig,xr=!0;function qm(r,a,c,m){var _=Me,E=bi.transition;bi.transition=null;try{Me=1,Ra(r,a,c,m)}finally{Me=_,bi.transition=E}}function $m(r,a,c,m){var _=Me,E=bi.transition;bi.transition=null;try{Me=4,Ra(r,a,c,m)}finally{Me=_,bi.transition=E}}function Ra(r,a,c,m){if(xr){var _=ba(r,a,c,m);if(_===null)Ya(r,a,m,kr,c),Yc(r,m);else if(Gm(_,r,a,c,m))m.stopPropagation();else if(Yc(r,m),a&4&&-1<Vm.indexOf(r)){for(;_!==null;){var E=Ms(_);if(E!==null&&zc(E),E=ba(r,a,c,m),E===null&&Ya(r,a,m,kr,c),E===_)break;_=E}_!==null&&m.stopPropagation()}else Ya(r,a,m,null,c)}}var kr=null;function ba(r,a,c,m){if(kr=null,r=ya(m),r=ii(r),r!==null)if(a=ni(r),a===null)r=null;else if(c=a.tag,c===13){if(r=Nc(a),r!==null)return r;r=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null);return kr=r,null}function Xc(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Mm()){case Sa:return 1;case Bc:return 4;case _r:case Nm:return 16;case Oc:return 536870912;default:return 16}default:return 16}}var Fn=null,Pa=null,Ir=null;function Qc(){if(Ir)return Ir;var r,a=Pa,c=a.length,m,_="value"in Fn?Fn.value:Fn.textContent,E=_.length;for(r=0;r<c&&a[r]===_[r];r++);var S=c-r;for(m=1;m<=S&&a[c-m]===_[E-m];m++);return Ir=_.slice(r,1<m?1-m:void 0)}function Rr(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function br(){return!0}function Zc(){return!1}function Mt(r){function a(c,m,_,E,S){this._reactName=c,this._targetInst=_,this.type=m,this.nativeEvent=E,this.target=S,this.currentTarget=null;for(var k in r)r.hasOwnProperty(k)&&(c=r[k],this[k]=c?c(E):E[k]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?br:Zc,this.isPropagationStopped=Zc,this}return Q(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=br)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=br)},persist:function(){},isPersistent:br}),a}var Pi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ma=Mt(Pi),As=Q({},Pi,{view:0,detail:0}),Wm=Mt(As),Na,La,ws,Pr=Q({},As,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fa,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ws&&(ws&&r.type==="mousemove"?(Na=r.screenX-ws.screenX,La=r.screenY-ws.screenY):La=Na=0,ws=r),Na)},movementY:function(r){return"movementY"in r?r.movementY:La}}),jc=Mt(Pr),Ym=Q({},Pr,{dataTransfer:0}),Km=Mt(Ym),Jm=Q({},As,{relatedTarget:0}),Da=Mt(Jm),Xm=Q({},Pi,{animationName:0,elapsedTime:0,pseudoElement:0}),Qm=Mt(Xm),Zm=Q({},Pi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),jm=Mt(Zm),ev=Q({},Pi,{data:0}),ed=Mt(ev),tv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},iv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sv(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=iv[r])?!!a[r]:!1}function Fa(){return sv}var rv=Q({},As,{key:function(r){if(r.key){var a=tv[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=Rr(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?nv[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fa,charCode:function(r){return r.type==="keypress"?Rr(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Rr(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),ov=Mt(rv),av=Q({},Pr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),td=Mt(av),lv=Q({},As,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fa}),uv=Mt(lv),cv=Q({},Pi,{propertyName:0,elapsedTime:0,pseudoElement:0}),dv=Mt(cv),hv=Q({},Pr,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),fv=Mt(hv),pv=[9,13,27,32],Ua=u&&"CompositionEvent"in window,Ss=null;u&&"documentMode"in document&&(Ss=document.documentMode);var gv=u&&"TextEvent"in window&&!Ss,nd=u&&(!Ua||Ss&&8<Ss&&11>=Ss),id=" ",sd=!1;function rd(r,a){switch(r){case"keyup":return pv.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function od(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Mi=!1;function mv(r,a){switch(r){case"compositionend":return od(a);case"keypress":return a.which!==32?null:(sd=!0,id);case"textInput":return r=a.data,r===id&&sd?null:r;default:return null}}function vv(r,a){if(Mi)return r==="compositionend"||!Ua&&rd(r,a)?(r=Qc(),Ir=Pa=Fn=null,Mi=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return nd&&a.locale!=="ko"?null:a.data;default:return null}}var yv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ad(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!yv[r.type]:a==="textarea"}function ld(r,a,c,m){Ic(m),a=Fr(a,"onChange"),0<a.length&&(c=new Ma("onChange","change",null,c,m),r.push({event:c,listeners:a}))}var Cs=null,Ts=null;function _v(r){xd(r,0)}function Mr(r){var a=Ui(r);if(mc(a))return r}function Ev(r,a){if(r==="change")return a}var ud=!1;if(u){var Ha;if(u){var Ba="oninput"in document;if(!Ba){var cd=document.createElement("div");cd.setAttribute("oninput","return;"),Ba=typeof cd.oninput=="function"}Ha=Ba}else Ha=!1;ud=Ha&&(!document.documentMode||9<document.documentMode)}function dd(){Cs&&(Cs.detachEvent("onpropertychange",hd),Ts=Cs=null)}function hd(r){if(r.propertyName==="value"&&Mr(Ts)){var a=[];ld(a,Ts,r,ya(r)),Mc(_v,a)}}function Av(r,a,c){r==="focusin"?(dd(),Cs=a,Ts=c,Cs.attachEvent("onpropertychange",hd)):r==="focusout"&&dd()}function wv(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Mr(Ts)}function Sv(r,a){if(r==="click")return Mr(a)}function Cv(r,a){if(r==="input"||r==="change")return Mr(a)}function Tv(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Jt=typeof Object.is=="function"?Object.is:Tv;function xs(r,a){if(Jt(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var c=Object.keys(r),m=Object.keys(a);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var _=c[m];if(!d.call(a,_)||!Jt(r[_],a[_]))return!1}return!0}function fd(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function pd(r,a){var c=fd(r);r=0;for(var m;c;){if(c.nodeType===3){if(m=r+c.textContent.length,r<=a&&m>=a)return{node:c,offset:a-r};r=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=fd(c)}}function gd(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?gd(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function md(){for(var r=window,a=gr();a instanceof r.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)r=a.contentWindow;else break;a=gr(r.document)}return a}function Oa(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}function xv(r){var a=md(),c=r.focusedElem,m=r.selectionRange;if(a!==c&&c&&c.ownerDocument&&gd(c.ownerDocument.documentElement,c)){if(m!==null&&Oa(c)){if(a=m.start,r=m.end,r===void 0&&(r=a),"selectionStart"in c)c.selectionStart=a,c.selectionEnd=Math.min(r,c.value.length);else if(r=(a=c.ownerDocument||document)&&a.defaultView||window,r.getSelection){r=r.getSelection();var _=c.textContent.length,E=Math.min(m.start,_);m=m.end===void 0?E:Math.min(m.end,_),!r.extend&&E>m&&(_=m,m=E,E=_),_=pd(c,E);var S=pd(c,m);_&&S&&(r.rangeCount!==1||r.anchorNode!==_.node||r.anchorOffset!==_.offset||r.focusNode!==S.node||r.focusOffset!==S.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),r.removeAllRanges(),E>m?(r.addRange(a),r.extend(S.node,S.offset)):(a.setEnd(S.node,S.offset),r.addRange(a)))}}for(a=[],r=c;r=r.parentNode;)r.nodeType===1&&a.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<a.length;c++)r=a[c],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var kv=u&&"documentMode"in document&&11>=document.documentMode,Ni=null,Va=null,ks=null,Ga=!1;function vd(r,a,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Ga||Ni==null||Ni!==gr(m)||(m=Ni,"selectionStart"in m&&Oa(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),ks&&xs(ks,m)||(ks=m,m=Fr(Va,"onSelect"),0<m.length&&(a=new Ma("onSelect","select",null,a,c),r.push({event:a,listeners:m}),a.target=Ni)))}function Nr(r,a){var c={};return c[r.toLowerCase()]=a.toLowerCase(),c["Webkit"+r]="webkit"+a,c["Moz"+r]="moz"+a,c}var Li={animationend:Nr("Animation","AnimationEnd"),animationiteration:Nr("Animation","AnimationIteration"),animationstart:Nr("Animation","AnimationStart"),transitionend:Nr("Transition","TransitionEnd")},za={},yd={};u&&(yd=document.createElement("div").style,"AnimationEvent"in window||(delete Li.animationend.animation,delete Li.animationiteration.animation,delete Li.animationstart.animation),"TransitionEvent"in window||delete Li.transitionend.transition);function Lr(r){if(za[r])return za[r];if(!Li[r])return r;var a=Li[r],c;for(c in a)if(a.hasOwnProperty(c)&&c in yd)return za[r]=a[c];return r}var _d=Lr("animationend"),Ed=Lr("animationiteration"),Ad=Lr("animationstart"),wd=Lr("transitionend"),Sd=new Map,Cd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Un(r,a){Sd.set(r,a),o(a,[r])}for(var qa=0;qa<Cd.length;qa++){var $a=Cd[qa],Iv=$a.toLowerCase(),Rv=$a[0].toUpperCase()+$a.slice(1);Un(Iv,"on"+Rv)}Un(_d,"onAnimationEnd"),Un(Ed,"onAnimationIteration"),Un(Ad,"onAnimationStart"),Un("dblclick","onDoubleClick"),Un("focusin","onFocus"),Un("focusout","onBlur"),Un(wd,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Is="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Is));function Td(r,a,c){var m=r.type||"unknown-event";r.currentTarget=c,Im(m,a,void 0,r),r.currentTarget=null}function xd(r,a){a=(a&4)!==0;for(var c=0;c<r.length;c++){var m=r[c],_=m.event;m=m.listeners;e:{var E=void 0;if(a)for(var S=m.length-1;0<=S;S--){var k=m[S],R=k.instance,B=k.currentTarget;if(k=k.listener,R!==E&&_.isPropagationStopped())break e;Td(_,k,B),E=R}else for(S=0;S<m.length;S++){if(k=m[S],R=k.instance,B=k.currentTarget,k=k.listener,R!==E&&_.isPropagationStopped())break e;Td(_,k,B),E=R}}}if(yr)throw r=wa,yr=!1,wa=null,r}function Ue(r,a){var c=a[ja];c===void 0&&(c=a[ja]=new Set);var m=r+"__bubble";c.has(m)||(kd(a,r,2,!1),c.add(m))}function Wa(r,a,c){var m=0;a&&(m|=4),kd(c,r,m,a)}var Dr="_reactListening"+Math.random().toString(36).slice(2);function Rs(r){if(!r[Dr]){r[Dr]=!0,n.forEach(function(c){c!=="selectionchange"&&(bv.has(c)||Wa(c,!1,r),Wa(c,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[Dr]||(a[Dr]=!0,Wa("selectionchange",!1,a))}}function kd(r,a,c,m){switch(Xc(a)){case 1:var _=qm;break;case 4:_=$m;break;default:_=Ra}c=_.bind(null,a,c,r),_=void 0,!Aa||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),m?_!==void 0?r.addEventListener(a,c,{capture:!0,passive:_}):r.addEventListener(a,c,!0):_!==void 0?r.addEventListener(a,c,{passive:_}):r.addEventListener(a,c,!1)}function Ya(r,a,c,m,_){var E=m;if((a&1)===0&&(a&2)===0&&m!==null)e:for(;;){if(m===null)return;var S=m.tag;if(S===3||S===4){var k=m.stateNode.containerInfo;if(k===_||k.nodeType===8&&k.parentNode===_)break;if(S===4)for(S=m.return;S!==null;){var R=S.tag;if((R===3||R===4)&&(R=S.stateNode.containerInfo,R===_||R.nodeType===8&&R.parentNode===_))return;S=S.return}for(;k!==null;){if(S=ii(k),S===null)return;if(R=S.tag,R===5||R===6){m=E=S;continue e}k=k.parentNode}}m=m.return}Mc(function(){var B=E,$=ya(c),W=[];e:{var z=Sd.get(r);if(z!==void 0){var Z=Ma,te=r;switch(r){case"keypress":if(Rr(c)===0)break e;case"keydown":case"keyup":Z=ov;break;case"focusin":te="focus",Z=Da;break;case"focusout":te="blur",Z=Da;break;case"beforeblur":case"afterblur":Z=Da;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=jc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=Km;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=uv;break;case _d:case Ed:case Ad:Z=Qm;break;case wd:Z=dv;break;case"scroll":Z=Wm;break;case"wheel":Z=fv;break;case"copy":case"cut":case"paste":Z=jm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=td}var ie=(a&4)!==0,We=!ie&&r==="scroll",L=ie?z!==null?z+"Capture":null:z;ie=[];for(var b=B,D;b!==null;){D=b;var Y=D.stateNode;if(D.tag===5&&Y!==null&&(D=Y,L!==null&&(Y=ds(b,L),Y!=null&&ie.push(bs(b,Y,D)))),We)break;b=b.return}0<ie.length&&(z=new Z(z,te,null,c,$),W.push({event:z,listeners:ie}))}}if((a&7)===0){e:{if(z=r==="mouseover"||r==="pointerover",Z=r==="mouseout"||r==="pointerout",z&&c!==va&&(te=c.relatedTarget||c.fromElement)&&(ii(te)||te[vn]))break e;if((Z||z)&&(z=$.window===$?$:(z=$.ownerDocument)?z.defaultView||z.parentWindow:window,Z?(te=c.relatedTarget||c.toElement,Z=B,te=te?ii(te):null,te!==null&&(We=ni(te),te!==We||te.tag!==5&&te.tag!==6)&&(te=null)):(Z=null,te=B),Z!==te)){if(ie=jc,Y="onMouseLeave",L="onMouseEnter",b="mouse",(r==="pointerout"||r==="pointerover")&&(ie=td,Y="onPointerLeave",L="onPointerEnter",b="pointer"),We=Z==null?z:Ui(Z),D=te==null?z:Ui(te),z=new ie(Y,b+"leave",Z,c,$),z.target=We,z.relatedTarget=D,Y=null,ii($)===B&&(ie=new ie(L,b+"enter",te,c,$),ie.target=D,ie.relatedTarget=We,Y=ie),We=Y,Z&&te)t:{for(ie=Z,L=te,b=0,D=ie;D;D=Di(D))b++;for(D=0,Y=L;Y;Y=Di(Y))D++;for(;0<b-D;)ie=Di(ie),b--;for(;0<D-b;)L=Di(L),D--;for(;b--;){if(ie===L||L!==null&&ie===L.alternate)break t;ie=Di(ie),L=Di(L)}ie=null}else ie=null;Z!==null&&Id(W,z,Z,ie,!1),te!==null&&We!==null&&Id(W,We,te,ie,!0)}}e:{if(z=B?Ui(B):window,Z=z.nodeName&&z.nodeName.toLowerCase(),Z==="select"||Z==="input"&&z.type==="file")var se=Ev;else if(ad(z))if(ud)se=Cv;else{se=wv;var ue=Av}else(Z=z.nodeName)&&Z.toLowerCase()==="input"&&(z.type==="checkbox"||z.type==="radio")&&(se=Sv);if(se&&(se=se(r,B))){ld(W,se,c,$);break e}ue&&ue(r,z,B),r==="focusout"&&(ue=z._wrapperState)&&ue.controlled&&z.type==="number"&&ha(z,"number",z.value)}switch(ue=B?Ui(B):window,r){case"focusin":(ad(ue)||ue.contentEditable==="true")&&(Ni=ue,Va=B,ks=null);break;case"focusout":ks=Va=Ni=null;break;case"mousedown":Ga=!0;break;case"contextmenu":case"mouseup":case"dragend":Ga=!1,vd(W,c,$);break;case"selectionchange":if(kv)break;case"keydown":case"keyup":vd(W,c,$)}var ce;if(Ua)e:{switch(r){case"compositionstart":var de="onCompositionStart";break e;case"compositionend":de="onCompositionEnd";break e;case"compositionupdate":de="onCompositionUpdate";break e}de=void 0}else Mi?rd(r,c)&&(de="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(de="onCompositionStart");de&&(nd&&c.locale!=="ko"&&(Mi||de!=="onCompositionStart"?de==="onCompositionEnd"&&Mi&&(ce=Qc()):(Fn=$,Pa="value"in Fn?Fn.value:Fn.textContent,Mi=!0)),ue=Fr(B,de),0<ue.length&&(de=new ed(de,r,null,c,$),W.push({event:de,listeners:ue}),ce?de.data=ce:(ce=od(c),ce!==null&&(de.data=ce)))),(ce=gv?mv(r,c):vv(r,c))&&(B=Fr(B,"onBeforeInput"),0<B.length&&($=new ed("onBeforeInput","beforeinput",null,c,$),W.push({event:$,listeners:B}),$.data=ce))}xd(W,a)})}function bs(r,a,c){return{instance:r,listener:a,currentTarget:c}}function Fr(r,a){for(var c=a+"Capture",m=[];r!==null;){var _=r,E=_.stateNode;_.tag===5&&E!==null&&(_=E,E=ds(r,c),E!=null&&m.unshift(bs(r,E,_)),E=ds(r,a),E!=null&&m.push(bs(r,E,_))),r=r.return}return m}function Di(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Id(r,a,c,m,_){for(var E=a._reactName,S=[];c!==null&&c!==m;){var k=c,R=k.alternate,B=k.stateNode;if(R!==null&&R===m)break;k.tag===5&&B!==null&&(k=B,_?(R=ds(c,E),R!=null&&S.unshift(bs(c,R,k))):_||(R=ds(c,E),R!=null&&S.push(bs(c,R,k)))),c=c.return}S.length!==0&&r.push({event:a,listeners:S})}var Pv=/\r\n?/g,Mv=/\u0000|\uFFFD/g;function Rd(r){return(typeof r=="string"?r:""+r).replace(Pv,`
`).replace(Mv,"")}function Ur(r,a,c){if(a=Rd(a),Rd(r)!==a&&c)throw Error(t(425))}function Hr(){}var Ka=null,Ja=null;function Xa(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Qa=typeof setTimeout=="function"?setTimeout:void 0,Nv=typeof clearTimeout=="function"?clearTimeout:void 0,bd=typeof Promise=="function"?Promise:void 0,Lv=typeof queueMicrotask=="function"?queueMicrotask:typeof bd<"u"?function(r){return bd.resolve(null).then(r).catch(Dv)}:Qa;function Dv(r){setTimeout(function(){throw r})}function Za(r,a){var c=a,m=0;do{var _=c.nextSibling;if(r.removeChild(c),_&&_.nodeType===8)if(c=_.data,c==="/$"){if(m===0){r.removeChild(_),Es(a);return}m--}else c!=="$"&&c!=="$?"&&c!=="$!"||m++;c=_}while(c);Es(a)}function Hn(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return r}function Pd(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(a===0)return r;a--}else c==="/$"&&a++}r=r.previousSibling}return null}var Fi=Math.random().toString(36).slice(2),ln="__reactFiber$"+Fi,Ps="__reactProps$"+Fi,vn="__reactContainer$"+Fi,ja="__reactEvents$"+Fi,Fv="__reactListeners$"+Fi,Uv="__reactHandles$"+Fi;function ii(r){var a=r[ln];if(a)return a;for(var c=r.parentNode;c;){if(a=c[vn]||c[ln]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(r=Pd(r);r!==null;){if(c=r[ln])return c;r=Pd(r)}return a}r=c,c=r.parentNode}return null}function Ms(r){return r=r[ln]||r[vn],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Ui(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function Br(r){return r[Ps]||null}var el=[],Hi=-1;function Bn(r){return{current:r}}function He(r){0>Hi||(r.current=el[Hi],el[Hi]=null,Hi--)}function Fe(r,a){Hi++,el[Hi]=r.current,r.current=a}var On={},lt=Bn(On),At=Bn(!1),si=On;function Bi(r,a){var c=r.type.contextTypes;if(!c)return On;var m=r.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===a)return m.__reactInternalMemoizedMaskedChildContext;var _={},E;for(E in c)_[E]=a[E];return m&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=a,r.__reactInternalMemoizedMaskedChildContext=_),_}function wt(r){return r=r.childContextTypes,r!=null}function Or(){He(At),He(lt)}function Md(r,a,c){if(lt.current!==On)throw Error(t(168));Fe(lt,a),Fe(At,c)}function Nd(r,a,c){var m=r.stateNode;if(a=a.childContextTypes,typeof m.getChildContext!="function")return c;m=m.getChildContext();for(var _ in m)if(!(_ in a))throw Error(t(108,fe(r)||"Unknown",_));return Q({},c,m)}function Vr(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||On,si=lt.current,Fe(lt,r),Fe(At,At.current),!0}function Ld(r,a,c){var m=r.stateNode;if(!m)throw Error(t(169));c?(r=Nd(r,a,si),m.__reactInternalMemoizedMergedChildContext=r,He(At),He(lt),Fe(lt,r)):He(At),Fe(At,c)}var yn=null,Gr=!1,tl=!1;function Dd(r){yn===null?yn=[r]:yn.push(r)}function Hv(r){Gr=!0,Dd(r)}function Vn(){if(!tl&&yn!==null){tl=!0;var r=0,a=Me;try{var c=yn;for(Me=1;r<c.length;r++){var m=c[r];do m=m(!0);while(m!==null)}yn=null,Gr=!1}catch(_){throw yn!==null&&(yn=yn.slice(r+1)),Uc(Sa,Vn),_}finally{Me=a,tl=!1}}return null}var Oi=[],Vi=0,zr=null,qr=0,Bt=[],Ot=0,ri=null,_n=1,En="";function oi(r,a){Oi[Vi++]=qr,Oi[Vi++]=zr,zr=r,qr=a}function Fd(r,a,c){Bt[Ot++]=_n,Bt[Ot++]=En,Bt[Ot++]=ri,ri=r;var m=_n;r=En;var _=32-Kt(m)-1;m&=~(1<<_),c+=1;var E=32-Kt(a)+_;if(30<E){var S=_-_%5;E=(m&(1<<S)-1).toString(32),m>>=S,_-=S,_n=1<<32-Kt(a)+_|c<<_|m,En=E+r}else _n=1<<E|c<<_|m,En=r}function nl(r){r.return!==null&&(oi(r,1),Fd(r,1,0))}function il(r){for(;r===zr;)zr=Oi[--Vi],Oi[Vi]=null,qr=Oi[--Vi],Oi[Vi]=null;for(;r===ri;)ri=Bt[--Ot],Bt[Ot]=null,En=Bt[--Ot],Bt[Ot]=null,_n=Bt[--Ot],Bt[Ot]=null}var Nt=null,Lt=null,Oe=!1,Xt=null;function Ud(r,a){var c=qt(5,null,null,0);c.elementType="DELETED",c.stateNode=a,c.return=r,a=r.deletions,a===null?(r.deletions=[c],r.flags|=16):a.push(c)}function Hd(r,a){switch(r.tag){case 5:var c=r.type;return a=a.nodeType!==1||c.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(r.stateNode=a,Nt=r,Lt=Hn(a.firstChild),!0):!1;case 6:return a=r.pendingProps===""||a.nodeType!==3?null:a,a!==null?(r.stateNode=a,Nt=r,Lt=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(c=ri!==null?{id:_n,overflow:En}:null,r.memoizedState={dehydrated:a,treeContext:c,retryLane:1073741824},c=qt(18,null,null,0),c.stateNode=a,c.return=r,r.child=c,Nt=r,Lt=null,!0):!1;default:return!1}}function sl(r){return(r.mode&1)!==0&&(r.flags&128)===0}function rl(r){if(Oe){var a=Lt;if(a){var c=a;if(!Hd(r,a)){if(sl(r))throw Error(t(418));a=Hn(c.nextSibling);var m=Nt;a&&Hd(r,a)?Ud(m,c):(r.flags=r.flags&-4097|2,Oe=!1,Nt=r)}}else{if(sl(r))throw Error(t(418));r.flags=r.flags&-4097|2,Oe=!1,Nt=r}}}function Bd(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Nt=r}function $r(r){if(r!==Nt)return!1;if(!Oe)return Bd(r),Oe=!0,!1;var a;if((a=r.tag!==3)&&!(a=r.tag!==5)&&(a=r.type,a=a!=="head"&&a!=="body"&&!Xa(r.type,r.memoizedProps)),a&&(a=Lt)){if(sl(r))throw Od(),Error(t(418));for(;a;)Ud(r,a),a=Hn(a.nextSibling)}if(Bd(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"){if(a===0){Lt=Hn(r.nextSibling);break e}a--}else c!=="$"&&c!=="$!"&&c!=="$?"||a++}r=r.nextSibling}Lt=null}}else Lt=Nt?Hn(r.stateNode.nextSibling):null;return!0}function Od(){for(var r=Lt;r;)r=Hn(r.nextSibling)}function Gi(){Lt=Nt=null,Oe=!1}function ol(r){Xt===null?Xt=[r]:Xt.push(r)}var Bv=M.ReactCurrentBatchConfig;function Ns(r,a,c){if(r=c.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var m=c.stateNode}if(!m)throw Error(t(147,r));var _=m,E=""+r;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===E?a.ref:(a=function(S){var k=_.refs;S===null?delete k[E]:k[E]=S},a._stringRef=E,a)}if(typeof r!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,r))}return r}function Wr(r,a){throw r=Object.prototype.toString.call(a),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r))}function Vd(r){var a=r._init;return a(r._payload)}function Gd(r){function a(L,b){if(r){var D=L.deletions;D===null?(L.deletions=[b],L.flags|=16):D.push(b)}}function c(L,b){if(!r)return null;for(;b!==null;)a(L,b),b=b.sibling;return null}function m(L,b){for(L=new Map;b!==null;)b.key!==null?L.set(b.key,b):L.set(b.index,b),b=b.sibling;return L}function _(L,b){return L=Jn(L,b),L.index=0,L.sibling=null,L}function E(L,b,D){return L.index=D,r?(D=L.alternate,D!==null?(D=D.index,D<b?(L.flags|=2,b):D):(L.flags|=2,b)):(L.flags|=1048576,b)}function S(L){return r&&L.alternate===null&&(L.flags|=2),L}function k(L,b,D,Y){return b===null||b.tag!==6?(b=Ql(D,L.mode,Y),b.return=L,b):(b=_(b,D),b.return=L,b)}function R(L,b,D,Y){var se=D.type;return se===O?$(L,b,D.props.children,Y,D.key):b!==null&&(b.elementType===se||typeof se=="object"&&se!==null&&se.$$typeof===ye&&Vd(se)===b.type)?(Y=_(b,D.props),Y.ref=Ns(L,b,D),Y.return=L,Y):(Y=vo(D.type,D.key,D.props,null,L.mode,Y),Y.ref=Ns(L,b,D),Y.return=L,Y)}function B(L,b,D,Y){return b===null||b.tag!==4||b.stateNode.containerInfo!==D.containerInfo||b.stateNode.implementation!==D.implementation?(b=Zl(D,L.mode,Y),b.return=L,b):(b=_(b,D.children||[]),b.return=L,b)}function $(L,b,D,Y,se){return b===null||b.tag!==7?(b=pi(D,L.mode,Y,se),b.return=L,b):(b=_(b,D),b.return=L,b)}function W(L,b,D){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Ql(""+b,L.mode,D),b.return=L,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case F:return D=vo(b.type,b.key,b.props,null,L.mode,D),D.ref=Ns(L,null,b),D.return=L,D;case H:return b=Zl(b,L.mode,D),b.return=L,b;case ye:var Y=b._init;return W(L,Y(b._payload),D)}if(ls(b)||ae(b))return b=pi(b,L.mode,D,null),b.return=L,b;Wr(L,b)}return null}function z(L,b,D,Y){var se=b!==null?b.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return se!==null?null:k(L,b,""+D,Y);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case F:return D.key===se?R(L,b,D,Y):null;case H:return D.key===se?B(L,b,D,Y):null;case ye:return se=D._init,z(L,b,se(D._payload),Y)}if(ls(D)||ae(D))return se!==null?null:$(L,b,D,Y,null);Wr(L,D)}return null}function Z(L,b,D,Y,se){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return L=L.get(D)||null,k(b,L,""+Y,se);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case F:return L=L.get(Y.key===null?D:Y.key)||null,R(b,L,Y,se);case H:return L=L.get(Y.key===null?D:Y.key)||null,B(b,L,Y,se);case ye:var ue=Y._init;return Z(L,b,D,ue(Y._payload),se)}if(ls(Y)||ae(Y))return L=L.get(D)||null,$(b,L,Y,se,null);Wr(b,Y)}return null}function te(L,b,D,Y){for(var se=null,ue=null,ce=b,de=b=0,st=null;ce!==null&&de<D.length;de++){ce.index>de?(st=ce,ce=null):st=ce.sibling;var Ie=z(L,ce,D[de],Y);if(Ie===null){ce===null&&(ce=st);break}r&&ce&&Ie.alternate===null&&a(L,ce),b=E(Ie,b,de),ue===null?se=Ie:ue.sibling=Ie,ue=Ie,ce=st}if(de===D.length)return c(L,ce),Oe&&oi(L,de),se;if(ce===null){for(;de<D.length;de++)ce=W(L,D[de],Y),ce!==null&&(b=E(ce,b,de),ue===null?se=ce:ue.sibling=ce,ue=ce);return Oe&&oi(L,de),se}for(ce=m(L,ce);de<D.length;de++)st=Z(ce,L,de,D[de],Y),st!==null&&(r&&st.alternate!==null&&ce.delete(st.key===null?de:st.key),b=E(st,b,de),ue===null?se=st:ue.sibling=st,ue=st);return r&&ce.forEach(function(Xn){return a(L,Xn)}),Oe&&oi(L,de),se}function ie(L,b,D,Y){var se=ae(D);if(typeof se!="function")throw Error(t(150));if(D=se.call(D),D==null)throw Error(t(151));for(var ue=se=null,ce=b,de=b=0,st=null,Ie=D.next();ce!==null&&!Ie.done;de++,Ie=D.next()){ce.index>de?(st=ce,ce=null):st=ce.sibling;var Xn=z(L,ce,Ie.value,Y);if(Xn===null){ce===null&&(ce=st);break}r&&ce&&Xn.alternate===null&&a(L,ce),b=E(Xn,b,de),ue===null?se=Xn:ue.sibling=Xn,ue=Xn,ce=st}if(Ie.done)return c(L,ce),Oe&&oi(L,de),se;if(ce===null){for(;!Ie.done;de++,Ie=D.next())Ie=W(L,Ie.value,Y),Ie!==null&&(b=E(Ie,b,de),ue===null?se=Ie:ue.sibling=Ie,ue=Ie);return Oe&&oi(L,de),se}for(ce=m(L,ce);!Ie.done;de++,Ie=D.next())Ie=Z(ce,L,de,Ie.value,Y),Ie!==null&&(r&&Ie.alternate!==null&&ce.delete(Ie.key===null?de:Ie.key),b=E(Ie,b,de),ue===null?se=Ie:ue.sibling=Ie,ue=Ie);return r&&ce.forEach(function(yy){return a(L,yy)}),Oe&&oi(L,de),se}function We(L,b,D,Y){if(typeof D=="object"&&D!==null&&D.type===O&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case F:e:{for(var se=D.key,ue=b;ue!==null;){if(ue.key===se){if(se=D.type,se===O){if(ue.tag===7){c(L,ue.sibling),b=_(ue,D.props.children),b.return=L,L=b;break e}}else if(ue.elementType===se||typeof se=="object"&&se!==null&&se.$$typeof===ye&&Vd(se)===ue.type){c(L,ue.sibling),b=_(ue,D.props),b.ref=Ns(L,ue,D),b.return=L,L=b;break e}c(L,ue);break}else a(L,ue);ue=ue.sibling}D.type===O?(b=pi(D.props.children,L.mode,Y,D.key),b.return=L,L=b):(Y=vo(D.type,D.key,D.props,null,L.mode,Y),Y.ref=Ns(L,b,D),Y.return=L,L=Y)}return S(L);case H:e:{for(ue=D.key;b!==null;){if(b.key===ue)if(b.tag===4&&b.stateNode.containerInfo===D.containerInfo&&b.stateNode.implementation===D.implementation){c(L,b.sibling),b=_(b,D.children||[]),b.return=L,L=b;break e}else{c(L,b);break}else a(L,b);b=b.sibling}b=Zl(D,L.mode,Y),b.return=L,L=b}return S(L);case ye:return ue=D._init,We(L,b,ue(D._payload),Y)}if(ls(D))return te(L,b,D,Y);if(ae(D))return ie(L,b,D,Y);Wr(L,D)}return typeof D=="string"&&D!==""||typeof D=="number"?(D=""+D,b!==null&&b.tag===6?(c(L,b.sibling),b=_(b,D),b.return=L,L=b):(c(L,b),b=Ql(D,L.mode,Y),b.return=L,L=b),S(L)):c(L,b)}return We}var zi=Gd(!0),zd=Gd(!1),Yr=Bn(null),Kr=null,qi=null,al=null;function ll(){al=qi=Kr=null}function ul(r){var a=Yr.current;He(Yr),r._currentValue=a}function cl(r,a,c){for(;r!==null;){var m=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,m!==null&&(m.childLanes|=a)):m!==null&&(m.childLanes&a)!==a&&(m.childLanes|=a),r===c)break;r=r.return}}function $i(r,a){Kr=r,al=qi=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&a)!==0&&(St=!0),r.firstContext=null)}function Vt(r){var a=r._currentValue;if(al!==r)if(r={context:r,memoizedValue:a,next:null},qi===null){if(Kr===null)throw Error(t(308));qi=r,Kr.dependencies={lanes:0,firstContext:r}}else qi=qi.next=r;return a}var ai=null;function dl(r){ai===null?ai=[r]:ai.push(r)}function qd(r,a,c,m){var _=a.interleaved;return _===null?(c.next=c,dl(a)):(c.next=_.next,_.next=c),a.interleaved=c,An(r,m)}function An(r,a){r.lanes|=a;var c=r.alternate;for(c!==null&&(c.lanes|=a),c=r,r=r.return;r!==null;)r.childLanes|=a,c=r.alternate,c!==null&&(c.childLanes|=a),c=r,r=r.return;return c.tag===3?c.stateNode:null}var Gn=!1;function hl(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $d(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function wn(r,a){return{eventTime:r,lane:a,tag:0,payload:null,callback:null,next:null}}function zn(r,a,c){var m=r.updateQueue;if(m===null)return null;if(m=m.shared,(ke&2)!==0){var _=m.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),m.pending=a,An(r,c)}return _=m.interleaved,_===null?(a.next=a,dl(m)):(a.next=_.next,_.next=a),m.interleaved=a,An(r,c)}function Jr(r,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194240)!==0)){var m=a.lanes;m&=r.pendingLanes,c|=m,a.lanes=c,xa(r,c)}}function Wd(r,a){var c=r.updateQueue,m=r.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var _=null,E=null;if(c=c.firstBaseUpdate,c!==null){do{var S={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};E===null?_=E=S:E=E.next=S,c=c.next}while(c!==null);E===null?_=E=a:E=E.next=a}else _=E=a;c={baseState:m.baseState,firstBaseUpdate:_,lastBaseUpdate:E,shared:m.shared,effects:m.effects},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=a:r.next=a,c.lastBaseUpdate=a}function Xr(r,a,c,m){var _=r.updateQueue;Gn=!1;var E=_.firstBaseUpdate,S=_.lastBaseUpdate,k=_.shared.pending;if(k!==null){_.shared.pending=null;var R=k,B=R.next;R.next=null,S===null?E=B:S.next=B,S=R;var $=r.alternate;$!==null&&($=$.updateQueue,k=$.lastBaseUpdate,k!==S&&(k===null?$.firstBaseUpdate=B:k.next=B,$.lastBaseUpdate=R))}if(E!==null){var W=_.baseState;S=0,$=B=R=null,k=E;do{var z=k.lane,Z=k.eventTime;if((m&z)===z){$!==null&&($=$.next={eventTime:Z,lane:0,tag:k.tag,payload:k.payload,callback:k.callback,next:null});e:{var te=r,ie=k;switch(z=a,Z=c,ie.tag){case 1:if(te=ie.payload,typeof te=="function"){W=te.call(Z,W,z);break e}W=te;break e;case 3:te.flags=te.flags&-65537|128;case 0:if(te=ie.payload,z=typeof te=="function"?te.call(Z,W,z):te,z==null)break e;W=Q({},W,z);break e;case 2:Gn=!0}}k.callback!==null&&k.lane!==0&&(r.flags|=64,z=_.effects,z===null?_.effects=[k]:z.push(k))}else Z={eventTime:Z,lane:z,tag:k.tag,payload:k.payload,callback:k.callback,next:null},$===null?(B=$=Z,R=W):$=$.next=Z,S|=z;if(k=k.next,k===null){if(k=_.shared.pending,k===null)break;z=k,k=z.next,z.next=null,_.lastBaseUpdate=z,_.shared.pending=null}}while(!0);if($===null&&(R=W),_.baseState=R,_.firstBaseUpdate=B,_.lastBaseUpdate=$,a=_.shared.interleaved,a!==null){_=a;do S|=_.lane,_=_.next;while(_!==a)}else E===null&&(_.shared.lanes=0);ci|=S,r.lanes=S,r.memoizedState=W}}function Yd(r,a,c){if(r=a.effects,a.effects=null,r!==null)for(a=0;a<r.length;a++){var m=r[a],_=m.callback;if(_!==null){if(m.callback=null,m=c,typeof _!="function")throw Error(t(191,_));_.call(m)}}}var Ls={},un=Bn(Ls),Ds=Bn(Ls),Fs=Bn(Ls);function li(r){if(r===Ls)throw Error(t(174));return r}function fl(r,a){switch(Fe(Fs,a),Fe(Ds,r),Fe(un,Ls),r=a.nodeType,r){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:pa(null,"");break;default:r=r===8?a.parentNode:a,a=r.namespaceURI||null,r=r.tagName,a=pa(a,r)}He(un),Fe(un,a)}function Wi(){He(un),He(Ds),He(Fs)}function Kd(r){li(Fs.current);var a=li(un.current),c=pa(a,r.type);a!==c&&(Fe(Ds,r),Fe(un,c))}function pl(r){Ds.current===r&&(He(un),He(Ds))}var Ve=Bn(0);function Qr(r){for(var a=r;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var gl=[];function ml(){for(var r=0;r<gl.length;r++)gl[r]._workInProgressVersionPrimary=null;gl.length=0}var Zr=M.ReactCurrentDispatcher,vl=M.ReactCurrentBatchConfig,ui=0,Ge=null,Qe=null,nt=null,jr=!1,Us=!1,Hs=0,Ov=0;function ut(){throw Error(t(321))}function yl(r,a){if(a===null)return!1;for(var c=0;c<a.length&&c<r.length;c++)if(!Jt(r[c],a[c]))return!1;return!0}function _l(r,a,c,m,_,E){if(ui=E,Ge=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Zr.current=r===null||r.memoizedState===null?qv:$v,r=c(m,_),Us){E=0;do{if(Us=!1,Hs=0,25<=E)throw Error(t(301));E+=1,nt=Qe=null,a.updateQueue=null,Zr.current=Wv,r=c(m,_)}while(Us)}if(Zr.current=no,a=Qe!==null&&Qe.next!==null,ui=0,nt=Qe=Ge=null,jr=!1,a)throw Error(t(300));return r}function El(){var r=Hs!==0;return Hs=0,r}function cn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nt===null?Ge.memoizedState=nt=r:nt=nt.next=r,nt}function Gt(){if(Qe===null){var r=Ge.alternate;r=r!==null?r.memoizedState:null}else r=Qe.next;var a=nt===null?Ge.memoizedState:nt.next;if(a!==null)nt=a,Qe=r;else{if(r===null)throw Error(t(310));Qe=r,r={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},nt===null?Ge.memoizedState=nt=r:nt=nt.next=r}return nt}function Bs(r,a){return typeof a=="function"?a(r):a}function Al(r){var a=Gt(),c=a.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var m=Qe,_=m.baseQueue,E=c.pending;if(E!==null){if(_!==null){var S=_.next;_.next=E.next,E.next=S}m.baseQueue=_=E,c.pending=null}if(_!==null){E=_.next,m=m.baseState;var k=S=null,R=null,B=E;do{var $=B.lane;if((ui&$)===$)R!==null&&(R=R.next={lane:0,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),m=B.hasEagerState?B.eagerState:r(m,B.action);else{var W={lane:$,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null};R===null?(k=R=W,S=m):R=R.next=W,Ge.lanes|=$,ci|=$}B=B.next}while(B!==null&&B!==E);R===null?S=m:R.next=k,Jt(m,a.memoizedState)||(St=!0),a.memoizedState=m,a.baseState=S,a.baseQueue=R,c.lastRenderedState=m}if(r=c.interleaved,r!==null){_=r;do E=_.lane,Ge.lanes|=E,ci|=E,_=_.next;while(_!==r)}else _===null&&(c.lanes=0);return[a.memoizedState,c.dispatch]}function wl(r){var a=Gt(),c=a.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var m=c.dispatch,_=c.pending,E=a.memoizedState;if(_!==null){c.pending=null;var S=_=_.next;do E=r(E,S.action),S=S.next;while(S!==_);Jt(E,a.memoizedState)||(St=!0),a.memoizedState=E,a.baseQueue===null&&(a.baseState=E),c.lastRenderedState=E}return[E,m]}function Jd(){}function Xd(r,a){var c=Ge,m=Gt(),_=a(),E=!Jt(m.memoizedState,_);if(E&&(m.memoizedState=_,St=!0),m=m.queue,Sl(jd.bind(null,c,m,r),[r]),m.getSnapshot!==a||E||nt!==null&&nt.memoizedState.tag&1){if(c.flags|=2048,Os(9,Zd.bind(null,c,m,_,a),void 0,null),it===null)throw Error(t(349));(ui&30)!==0||Qd(c,a,_)}return _}function Qd(r,a,c){r.flags|=16384,r={getSnapshot:a,value:c},a=Ge.updateQueue,a===null?(a={lastEffect:null,stores:null},Ge.updateQueue=a,a.stores=[r]):(c=a.stores,c===null?a.stores=[r]:c.push(r))}function Zd(r,a,c,m){a.value=c,a.getSnapshot=m,eh(a)&&th(r)}function jd(r,a,c){return c(function(){eh(a)&&th(r)})}function eh(r){var a=r.getSnapshot;r=r.value;try{var c=a();return!Jt(r,c)}catch{return!0}}function th(r){var a=An(r,1);a!==null&&en(a,r,1,-1)}function nh(r){var a=cn();return typeof r=="function"&&(r=r()),a.memoizedState=a.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bs,lastRenderedState:r},a.queue=r,r=r.dispatch=zv.bind(null,Ge,r),[a.memoizedState,r]}function Os(r,a,c,m){return r={tag:r,create:a,destroy:c,deps:m,next:null},a=Ge.updateQueue,a===null?(a={lastEffect:null,stores:null},Ge.updateQueue=a,a.lastEffect=r.next=r):(c=a.lastEffect,c===null?a.lastEffect=r.next=r:(m=c.next,c.next=r,r.next=m,a.lastEffect=r)),r}function ih(){return Gt().memoizedState}function eo(r,a,c,m){var _=cn();Ge.flags|=r,_.memoizedState=Os(1|a,c,void 0,m===void 0?null:m)}function to(r,a,c,m){var _=Gt();m=m===void 0?null:m;var E=void 0;if(Qe!==null){var S=Qe.memoizedState;if(E=S.destroy,m!==null&&yl(m,S.deps)){_.memoizedState=Os(a,c,E,m);return}}Ge.flags|=r,_.memoizedState=Os(1|a,c,E,m)}function sh(r,a){return eo(8390656,8,r,a)}function Sl(r,a){return to(2048,8,r,a)}function rh(r,a){return to(4,2,r,a)}function oh(r,a){return to(4,4,r,a)}function ah(r,a){if(typeof a=="function")return r=r(),a(r),function(){a(null)};if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function lh(r,a,c){return c=c!=null?c.concat([r]):null,to(4,4,ah.bind(null,a,r),c)}function Cl(){}function uh(r,a){var c=Gt();a=a===void 0?null:a;var m=c.memoizedState;return m!==null&&a!==null&&yl(a,m[1])?m[0]:(c.memoizedState=[r,a],r)}function ch(r,a){var c=Gt();a=a===void 0?null:a;var m=c.memoizedState;return m!==null&&a!==null&&yl(a,m[1])?m[0]:(r=r(),c.memoizedState=[r,a],r)}function dh(r,a,c){return(ui&21)===0?(r.baseState&&(r.baseState=!1,St=!0),r.memoizedState=c):(Jt(c,a)||(c=Vc(),Ge.lanes|=c,ci|=c,r.baseState=!0),a)}function Vv(r,a){var c=Me;Me=c!==0&&4>c?c:4,r(!0);var m=vl.transition;vl.transition={};try{r(!1),a()}finally{Me=c,vl.transition=m}}function hh(){return Gt().memoizedState}function Gv(r,a,c){var m=Yn(r);if(c={lane:m,action:c,hasEagerState:!1,eagerState:null,next:null},fh(r))ph(a,c);else if(c=qd(r,a,c,m),c!==null){var _=yt();en(c,r,m,_),gh(c,a,m)}}function zv(r,a,c){var m=Yn(r),_={lane:m,action:c,hasEagerState:!1,eagerState:null,next:null};if(fh(r))ph(a,_);else{var E=r.alternate;if(r.lanes===0&&(E===null||E.lanes===0)&&(E=a.lastRenderedReducer,E!==null))try{var S=a.lastRenderedState,k=E(S,c);if(_.hasEagerState=!0,_.eagerState=k,Jt(k,S)){var R=a.interleaved;R===null?(_.next=_,dl(a)):(_.next=R.next,R.next=_),a.interleaved=_;return}}catch{}finally{}c=qd(r,a,_,m),c!==null&&(_=yt(),en(c,r,m,_),gh(c,a,m))}}function fh(r){var a=r.alternate;return r===Ge||a!==null&&a===Ge}function ph(r,a){Us=jr=!0;var c=r.pending;c===null?a.next=a:(a.next=c.next,c.next=a),r.pending=a}function gh(r,a,c){if((c&4194240)!==0){var m=a.lanes;m&=r.pendingLanes,c|=m,a.lanes=c,xa(r,c)}}var no={readContext:Vt,useCallback:ut,useContext:ut,useEffect:ut,useImperativeHandle:ut,useInsertionEffect:ut,useLayoutEffect:ut,useMemo:ut,useReducer:ut,useRef:ut,useState:ut,useDebugValue:ut,useDeferredValue:ut,useTransition:ut,useMutableSource:ut,useSyncExternalStore:ut,useId:ut,unstable_isNewReconciler:!1},qv={readContext:Vt,useCallback:function(r,a){return cn().memoizedState=[r,a===void 0?null:a],r},useContext:Vt,useEffect:sh,useImperativeHandle:function(r,a,c){return c=c!=null?c.concat([r]):null,eo(4194308,4,ah.bind(null,a,r),c)},useLayoutEffect:function(r,a){return eo(4194308,4,r,a)},useInsertionEffect:function(r,a){return eo(4,2,r,a)},useMemo:function(r,a){var c=cn();return a=a===void 0?null:a,r=r(),c.memoizedState=[r,a],r},useReducer:function(r,a,c){var m=cn();return a=c!==void 0?c(a):a,m.memoizedState=m.baseState=a,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:a},m.queue=r,r=r.dispatch=Gv.bind(null,Ge,r),[m.memoizedState,r]},useRef:function(r){var a=cn();return r={current:r},a.memoizedState=r},useState:nh,useDebugValue:Cl,useDeferredValue:function(r){return cn().memoizedState=r},useTransition:function(){var r=nh(!1),a=r[0];return r=Vv.bind(null,r[1]),cn().memoizedState=r,[a,r]},useMutableSource:function(){},useSyncExternalStore:function(r,a,c){var m=Ge,_=cn();if(Oe){if(c===void 0)throw Error(t(407));c=c()}else{if(c=a(),it===null)throw Error(t(349));(ui&30)!==0||Qd(m,a,c)}_.memoizedState=c;var E={value:c,getSnapshot:a};return _.queue=E,sh(jd.bind(null,m,E,r),[r]),m.flags|=2048,Os(9,Zd.bind(null,m,E,c,a),void 0,null),c},useId:function(){var r=cn(),a=it.identifierPrefix;if(Oe){var c=En,m=_n;c=(m&~(1<<32-Kt(m)-1)).toString(32)+c,a=":"+a+"R"+c,c=Hs++,0<c&&(a+="H"+c.toString(32)),a+=":"}else c=Ov++,a=":"+a+"r"+c.toString(32)+":";return r.memoizedState=a},unstable_isNewReconciler:!1},$v={readContext:Vt,useCallback:uh,useContext:Vt,useEffect:Sl,useImperativeHandle:lh,useInsertionEffect:rh,useLayoutEffect:oh,useMemo:ch,useReducer:Al,useRef:ih,useState:function(){return Al(Bs)},useDebugValue:Cl,useDeferredValue:function(r){var a=Gt();return dh(a,Qe.memoizedState,r)},useTransition:function(){var r=Al(Bs)[0],a=Gt().memoizedState;return[r,a]},useMutableSource:Jd,useSyncExternalStore:Xd,useId:hh,unstable_isNewReconciler:!1},Wv={readContext:Vt,useCallback:uh,useContext:Vt,useEffect:Sl,useImperativeHandle:lh,useInsertionEffect:rh,useLayoutEffect:oh,useMemo:ch,useReducer:wl,useRef:ih,useState:function(){return wl(Bs)},useDebugValue:Cl,useDeferredValue:function(r){var a=Gt();return Qe===null?a.memoizedState=r:dh(a,Qe.memoizedState,r)},useTransition:function(){var r=wl(Bs)[0],a=Gt().memoizedState;return[r,a]},useMutableSource:Jd,useSyncExternalStore:Xd,useId:hh,unstable_isNewReconciler:!1};function Qt(r,a){if(r&&r.defaultProps){a=Q({},a),r=r.defaultProps;for(var c in r)a[c]===void 0&&(a[c]=r[c]);return a}return a}function Tl(r,a,c,m){a=r.memoizedState,c=c(m,a),c=c==null?a:Q({},a,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var io={isMounted:function(r){return(r=r._reactInternals)?ni(r)===r:!1},enqueueSetState:function(r,a,c){r=r._reactInternals;var m=yt(),_=Yn(r),E=wn(m,_);E.payload=a,c!=null&&(E.callback=c),a=zn(r,E,_),a!==null&&(en(a,r,_,m),Jr(a,r,_))},enqueueReplaceState:function(r,a,c){r=r._reactInternals;var m=yt(),_=Yn(r),E=wn(m,_);E.tag=1,E.payload=a,c!=null&&(E.callback=c),a=zn(r,E,_),a!==null&&(en(a,r,_,m),Jr(a,r,_))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var c=yt(),m=Yn(r),_=wn(c,m);_.tag=2,a!=null&&(_.callback=a),a=zn(r,_,m),a!==null&&(en(a,r,m,c),Jr(a,r,m))}};function mh(r,a,c,m,_,E,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(m,E,S):a.prototype&&a.prototype.isPureReactComponent?!xs(c,m)||!xs(_,E):!0}function vh(r,a,c){var m=!1,_=On,E=a.contextType;return typeof E=="object"&&E!==null?E=Vt(E):(_=wt(a)?si:lt.current,m=a.contextTypes,E=(m=m!=null)?Bi(r,_):On),a=new a(c,E),r.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=io,r.stateNode=a,a._reactInternals=r,m&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=_,r.__reactInternalMemoizedMaskedChildContext=E),a}function yh(r,a,c,m){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,m),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,m),a.state!==r&&io.enqueueReplaceState(a,a.state,null)}function xl(r,a,c,m){var _=r.stateNode;_.props=c,_.state=r.memoizedState,_.refs={},hl(r);var E=a.contextType;typeof E=="object"&&E!==null?_.context=Vt(E):(E=wt(a)?si:lt.current,_.context=Bi(r,E)),_.state=r.memoizedState,E=a.getDerivedStateFromProps,typeof E=="function"&&(Tl(r,a,E,c),_.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(a=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),a!==_.state&&io.enqueueReplaceState(_,_.state,null),Xr(r,c,_,m),_.state=r.memoizedState),typeof _.componentDidMount=="function"&&(r.flags|=4194308)}function Yi(r,a){try{var c="",m=a;do c+=Ee(m),m=m.return;while(m);var _=c}catch(E){_=`
Error generating stack: `+E.message+`
`+E.stack}return{value:r,source:a,stack:_,digest:null}}function kl(r,a,c){return{value:r,source:null,stack:c??null,digest:a??null}}function Il(r,a){try{console.error(a.value)}catch(c){setTimeout(function(){throw c})}}var Yv=typeof WeakMap=="function"?WeakMap:Map;function _h(r,a,c){c=wn(-1,c),c.tag=3,c.payload={element:null};var m=a.value;return c.callback=function(){co||(co=!0,zl=m),Il(r,a)},c}function Eh(r,a,c){c=wn(-1,c),c.tag=3;var m=r.type.getDerivedStateFromError;if(typeof m=="function"){var _=a.value;c.payload=function(){return m(_)},c.callback=function(){Il(r,a)}}var E=r.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(c.callback=function(){Il(r,a),typeof m!="function"&&($n===null?$n=new Set([this]):$n.add(this));var S=a.stack;this.componentDidCatch(a.value,{componentStack:S!==null?S:""})}),c}function Ah(r,a,c){var m=r.pingCache;if(m===null){m=r.pingCache=new Yv;var _=new Set;m.set(a,_)}else _=m.get(a),_===void 0&&(_=new Set,m.set(a,_));_.has(c)||(_.add(c),r=ay.bind(null,r,a,c),a.then(r,r))}function wh(r){do{var a;if((a=r.tag===13)&&(a=r.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return r;r=r.return}while(r!==null);return null}function Sh(r,a,c,m,_){return(r.mode&1)===0?(r===a?r.flags|=65536:(r.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(a=wn(-1,1),a.tag=2,zn(c,a,1))),c.lanes|=1),r):(r.flags|=65536,r.lanes=_,r)}var Kv=M.ReactCurrentOwner,St=!1;function vt(r,a,c,m){a.child=r===null?zd(a,null,c,m):zi(a,r.child,c,m)}function Ch(r,a,c,m,_){c=c.render;var E=a.ref;return $i(a,_),m=_l(r,a,c,m,E,_),c=El(),r!==null&&!St?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~_,Sn(r,a,_)):(Oe&&c&&nl(a),a.flags|=1,vt(r,a,m,_),a.child)}function Th(r,a,c,m,_){if(r===null){var E=c.type;return typeof E=="function"&&!Xl(E)&&E.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(a.tag=15,a.type=E,xh(r,a,E,m,_)):(r=vo(c.type,null,m,a,a.mode,_),r.ref=a.ref,r.return=a,a.child=r)}if(E=r.child,(r.lanes&_)===0){var S=E.memoizedProps;if(c=c.compare,c=c!==null?c:xs,c(S,m)&&r.ref===a.ref)return Sn(r,a,_)}return a.flags|=1,r=Jn(E,m),r.ref=a.ref,r.return=a,a.child=r}function xh(r,a,c,m,_){if(r!==null){var E=r.memoizedProps;if(xs(E,m)&&r.ref===a.ref)if(St=!1,a.pendingProps=m=E,(r.lanes&_)!==0)(r.flags&131072)!==0&&(St=!0);else return a.lanes=r.lanes,Sn(r,a,_)}return Rl(r,a,c,m,_)}function kh(r,a,c){var m=a.pendingProps,_=m.children,E=r!==null?r.memoizedState:null;if(m.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(Ji,Dt),Dt|=c;else{if((c&1073741824)===0)return r=E!==null?E.baseLanes|c:c,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:r,cachePool:null,transitions:null},a.updateQueue=null,Fe(Ji,Dt),Dt|=r,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=E!==null?E.baseLanes:c,Fe(Ji,Dt),Dt|=m}else E!==null?(m=E.baseLanes|c,a.memoizedState=null):m=c,Fe(Ji,Dt),Dt|=m;return vt(r,a,_,c),a.child}function Ih(r,a){var c=a.ref;(r===null&&c!==null||r!==null&&r.ref!==c)&&(a.flags|=512,a.flags|=2097152)}function Rl(r,a,c,m,_){var E=wt(c)?si:lt.current;return E=Bi(a,E),$i(a,_),c=_l(r,a,c,m,E,_),m=El(),r!==null&&!St?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~_,Sn(r,a,_)):(Oe&&m&&nl(a),a.flags|=1,vt(r,a,c,_),a.child)}function Rh(r,a,c,m,_){if(wt(c)){var E=!0;Vr(a)}else E=!1;if($i(a,_),a.stateNode===null)ro(r,a),vh(a,c,m),xl(a,c,m,_),m=!0;else if(r===null){var S=a.stateNode,k=a.memoizedProps;S.props=k;var R=S.context,B=c.contextType;typeof B=="object"&&B!==null?B=Vt(B):(B=wt(c)?si:lt.current,B=Bi(a,B));var $=c.getDerivedStateFromProps,W=typeof $=="function"||typeof S.getSnapshotBeforeUpdate=="function";W||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(k!==m||R!==B)&&yh(a,S,m,B),Gn=!1;var z=a.memoizedState;S.state=z,Xr(a,m,S,_),R=a.memoizedState,k!==m||z!==R||At.current||Gn?(typeof $=="function"&&(Tl(a,c,$,m),R=a.memoizedState),(k=Gn||mh(a,c,k,m,z,R,B))?(W||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=m,a.memoizedState=R),S.props=m,S.state=R,S.context=B,m=k):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),m=!1)}else{S=a.stateNode,$d(r,a),k=a.memoizedProps,B=a.type===a.elementType?k:Qt(a.type,k),S.props=B,W=a.pendingProps,z=S.context,R=c.contextType,typeof R=="object"&&R!==null?R=Vt(R):(R=wt(c)?si:lt.current,R=Bi(a,R));var Z=c.getDerivedStateFromProps;($=typeof Z=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(k!==W||z!==R)&&yh(a,S,m,R),Gn=!1,z=a.memoizedState,S.state=z,Xr(a,m,S,_);var te=a.memoizedState;k!==W||z!==te||At.current||Gn?(typeof Z=="function"&&(Tl(a,c,Z,m),te=a.memoizedState),(B=Gn||mh(a,c,B,m,z,te,R)||!1)?($||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(m,te,R),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(m,te,R)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||k===r.memoizedProps&&z===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||k===r.memoizedProps&&z===r.memoizedState||(a.flags|=1024),a.memoizedProps=m,a.memoizedState=te),S.props=m,S.state=te,S.context=R,m=B):(typeof S.componentDidUpdate!="function"||k===r.memoizedProps&&z===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||k===r.memoizedProps&&z===r.memoizedState||(a.flags|=1024),m=!1)}return bl(r,a,c,m,E,_)}function bl(r,a,c,m,_,E){Ih(r,a);var S=(a.flags&128)!==0;if(!m&&!S)return _&&Ld(a,c,!1),Sn(r,a,E);m=a.stateNode,Kv.current=a;var k=S&&typeof c.getDerivedStateFromError!="function"?null:m.render();return a.flags|=1,r!==null&&S?(a.child=zi(a,r.child,null,E),a.child=zi(a,null,k,E)):vt(r,a,k,E),a.memoizedState=m.state,_&&Ld(a,c,!0),a.child}function bh(r){var a=r.stateNode;a.pendingContext?Md(r,a.pendingContext,a.pendingContext!==a.context):a.context&&Md(r,a.context,!1),fl(r,a.containerInfo)}function Ph(r,a,c,m,_){return Gi(),ol(_),a.flags|=256,vt(r,a,c,m),a.child}var Pl={dehydrated:null,treeContext:null,retryLane:0};function Ml(r){return{baseLanes:r,cachePool:null,transitions:null}}function Mh(r,a,c){var m=a.pendingProps,_=Ve.current,E=!1,S=(a.flags&128)!==0,k;if((k=S)||(k=r!==null&&r.memoizedState===null?!1:(_&2)!==0),k?(E=!0,a.flags&=-129):(r===null||r.memoizedState!==null)&&(_|=1),Fe(Ve,_&1),r===null)return rl(a),r=a.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((a.mode&1)===0?a.lanes=1:r.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(S=m.children,r=m.fallback,E?(m=a.mode,E=a.child,S={mode:"hidden",children:S},(m&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=S):E=yo(S,m,0,null),r=pi(r,m,c,null),E.return=a,r.return=a,E.sibling=r,a.child=E,a.child.memoizedState=Ml(c),a.memoizedState=Pl,r):Nl(a,S));if(_=r.memoizedState,_!==null&&(k=_.dehydrated,k!==null))return Jv(r,a,S,m,k,_,c);if(E){E=m.fallback,S=a.mode,_=r.child,k=_.sibling;var R={mode:"hidden",children:m.children};return(S&1)===0&&a.child!==_?(m=a.child,m.childLanes=0,m.pendingProps=R,a.deletions=null):(m=Jn(_,R),m.subtreeFlags=_.subtreeFlags&14680064),k!==null?E=Jn(k,E):(E=pi(E,S,c,null),E.flags|=2),E.return=a,m.return=a,m.sibling=E,a.child=m,m=E,E=a.child,S=r.child.memoizedState,S=S===null?Ml(c):{baseLanes:S.baseLanes|c,cachePool:null,transitions:S.transitions},E.memoizedState=S,E.childLanes=r.childLanes&~c,a.memoizedState=Pl,m}return E=r.child,r=E.sibling,m=Jn(E,{mode:"visible",children:m.children}),(a.mode&1)===0&&(m.lanes=c),m.return=a,m.sibling=null,r!==null&&(c=a.deletions,c===null?(a.deletions=[r],a.flags|=16):c.push(r)),a.child=m,a.memoizedState=null,m}function Nl(r,a){return a=yo({mode:"visible",children:a},r.mode,0,null),a.return=r,r.child=a}function so(r,a,c,m){return m!==null&&ol(m),zi(a,r.child,null,c),r=Nl(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function Jv(r,a,c,m,_,E,S){if(c)return a.flags&256?(a.flags&=-257,m=kl(Error(t(422))),so(r,a,S,m)):a.memoizedState!==null?(a.child=r.child,a.flags|=128,null):(E=m.fallback,_=a.mode,m=yo({mode:"visible",children:m.children},_,0,null),E=pi(E,_,S,null),E.flags|=2,m.return=a,E.return=a,m.sibling=E,a.child=m,(a.mode&1)!==0&&zi(a,r.child,null,S),a.child.memoizedState=Ml(S),a.memoizedState=Pl,E);if((a.mode&1)===0)return so(r,a,S,null);if(_.data==="$!"){if(m=_.nextSibling&&_.nextSibling.dataset,m)var k=m.dgst;return m=k,E=Error(t(419)),m=kl(E,m,void 0),so(r,a,S,m)}if(k=(S&r.childLanes)!==0,St||k){if(m=it,m!==null){switch(S&-S){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(m.suspendedLanes|S))!==0?0:_,_!==0&&_!==E.retryLane&&(E.retryLane=_,An(r,_),en(m,r,_,-1))}return Jl(),m=kl(Error(t(421))),so(r,a,S,m)}return _.data==="$?"?(a.flags|=128,a.child=r.child,a=ly.bind(null,r),_._reactRetry=a,null):(r=E.treeContext,Lt=Hn(_.nextSibling),Nt=a,Oe=!0,Xt=null,r!==null&&(Bt[Ot++]=_n,Bt[Ot++]=En,Bt[Ot++]=ri,_n=r.id,En=r.overflow,ri=a),a=Nl(a,m.children),a.flags|=4096,a)}function Nh(r,a,c){r.lanes|=a;var m=r.alternate;m!==null&&(m.lanes|=a),cl(r.return,a,c)}function Ll(r,a,c,m,_){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:_}:(E.isBackwards=a,E.rendering=null,E.renderingStartTime=0,E.last=m,E.tail=c,E.tailMode=_)}function Lh(r,a,c){var m=a.pendingProps,_=m.revealOrder,E=m.tail;if(vt(r,a,m.children,c),m=Ve.current,(m&2)!==0)m=m&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Nh(r,c,a);else if(r.tag===19)Nh(r,c,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}m&=1}if(Fe(Ve,m),(a.mode&1)===0)a.memoizedState=null;else switch(_){case"forwards":for(c=a.child,_=null;c!==null;)r=c.alternate,r!==null&&Qr(r)===null&&(_=c),c=c.sibling;c=_,c===null?(_=a.child,a.child=null):(_=c.sibling,c.sibling=null),Ll(a,!1,_,c,E);break;case"backwards":for(c=null,_=a.child,a.child=null;_!==null;){if(r=_.alternate,r!==null&&Qr(r)===null){a.child=_;break}r=_.sibling,_.sibling=c,c=_,_=r}Ll(a,!0,c,null,E);break;case"together":Ll(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ro(r,a){(a.mode&1)===0&&r!==null&&(r.alternate=null,a.alternate=null,a.flags|=2)}function Sn(r,a,c){if(r!==null&&(a.dependencies=r.dependencies),ci|=a.lanes,(c&a.childLanes)===0)return null;if(r!==null&&a.child!==r.child)throw Error(t(153));if(a.child!==null){for(r=a.child,c=Jn(r,r.pendingProps),a.child=c,c.return=a;r.sibling!==null;)r=r.sibling,c=c.sibling=Jn(r,r.pendingProps),c.return=a;c.sibling=null}return a.child}function Xv(r,a,c){switch(a.tag){case 3:bh(a),Gi();break;case 5:Kd(a);break;case 1:wt(a.type)&&Vr(a);break;case 4:fl(a,a.stateNode.containerInfo);break;case 10:var m=a.type._context,_=a.memoizedProps.value;Fe(Yr,m._currentValue),m._currentValue=_;break;case 13:if(m=a.memoizedState,m!==null)return m.dehydrated!==null?(Fe(Ve,Ve.current&1),a.flags|=128,null):(c&a.child.childLanes)!==0?Mh(r,a,c):(Fe(Ve,Ve.current&1),r=Sn(r,a,c),r!==null?r.sibling:null);Fe(Ve,Ve.current&1);break;case 19:if(m=(c&a.childLanes)!==0,(r.flags&128)!==0){if(m)return Lh(r,a,c);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Fe(Ve,Ve.current),m)break;return null;case 22:case 23:return a.lanes=0,kh(r,a,c)}return Sn(r,a,c)}var Dh,Dl,Fh,Uh;Dh=function(r,a){for(var c=a.child;c!==null;){if(c.tag===5||c.tag===6)r.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Dl=function(){},Fh=function(r,a,c,m){var _=r.memoizedProps;if(_!==m){r=a.stateNode,li(un.current);var E=null;switch(c){case"input":_=ca(r,_),m=ca(r,m),E=[];break;case"select":_=Q({},_,{value:void 0}),m=Q({},m,{value:void 0}),E=[];break;case"textarea":_=fa(r,_),m=fa(r,m),E=[];break;default:typeof _.onClick!="function"&&typeof m.onClick=="function"&&(r.onclick=Hr)}ga(c,m);var S;c=null;for(B in _)if(!m.hasOwnProperty(B)&&_.hasOwnProperty(B)&&_[B]!=null)if(B==="style"){var k=_[B];for(S in k)k.hasOwnProperty(S)&&(c||(c={}),c[S]="")}else B!=="dangerouslySetInnerHTML"&&B!=="children"&&B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(s.hasOwnProperty(B)?E||(E=[]):(E=E||[]).push(B,null));for(B in m){var R=m[B];if(k=_?.[B],m.hasOwnProperty(B)&&R!==k&&(R!=null||k!=null))if(B==="style")if(k){for(S in k)!k.hasOwnProperty(S)||R&&R.hasOwnProperty(S)||(c||(c={}),c[S]="");for(S in R)R.hasOwnProperty(S)&&k[S]!==R[S]&&(c||(c={}),c[S]=R[S])}else c||(E||(E=[]),E.push(B,c)),c=R;else B==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,k=k?k.__html:void 0,R!=null&&k!==R&&(E=E||[]).push(B,R)):B==="children"?typeof R!="string"&&typeof R!="number"||(E=E||[]).push(B,""+R):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&(s.hasOwnProperty(B)?(R!=null&&B==="onScroll"&&Ue("scroll",r),E||k===R||(E=[])):(E=E||[]).push(B,R))}c&&(E=E||[]).push("style",c);var B=E;(a.updateQueue=B)&&(a.flags|=4)}},Uh=function(r,a,c,m){c!==m&&(a.flags|=4)};function Vs(r,a){if(!Oe)switch(r.tailMode){case"hidden":a=r.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:m.sibling=null}}function ct(r){var a=r.alternate!==null&&r.alternate.child===r.child,c=0,m=0;if(a)for(var _=r.child;_!==null;)c|=_.lanes|_.childLanes,m|=_.subtreeFlags&14680064,m|=_.flags&14680064,_.return=r,_=_.sibling;else for(_=r.child;_!==null;)c|=_.lanes|_.childLanes,m|=_.subtreeFlags,m|=_.flags,_.return=r,_=_.sibling;return r.subtreeFlags|=m,r.childLanes=c,a}function Qv(r,a,c){var m=a.pendingProps;switch(il(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ct(a),null;case 1:return wt(a.type)&&Or(),ct(a),null;case 3:return m=a.stateNode,Wi(),He(At),He(lt),ml(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(r===null||r.child===null)&&($r(a)?a.flags|=4:r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Xt!==null&&(Wl(Xt),Xt=null))),Dl(r,a),ct(a),null;case 5:pl(a);var _=li(Fs.current);if(c=a.type,r!==null&&a.stateNode!=null)Fh(r,a,c,m,_),r.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!m){if(a.stateNode===null)throw Error(t(166));return ct(a),null}if(r=li(un.current),$r(a)){m=a.stateNode,c=a.type;var E=a.memoizedProps;switch(m[ln]=a,m[Ps]=E,r=(a.mode&1)!==0,c){case"dialog":Ue("cancel",m),Ue("close",m);break;case"iframe":case"object":case"embed":Ue("load",m);break;case"video":case"audio":for(_=0;_<Is.length;_++)Ue(Is[_],m);break;case"source":Ue("error",m);break;case"img":case"image":case"link":Ue("error",m),Ue("load",m);break;case"details":Ue("toggle",m);break;case"input":vc(m,E),Ue("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!E.multiple},Ue("invalid",m);break;case"textarea":Ec(m,E),Ue("invalid",m)}ga(c,E),_=null;for(var S in E)if(E.hasOwnProperty(S)){var k=E[S];S==="children"?typeof k=="string"?m.textContent!==k&&(E.suppressHydrationWarning!==!0&&Ur(m.textContent,k,r),_=["children",k]):typeof k=="number"&&m.textContent!==""+k&&(E.suppressHydrationWarning!==!0&&Ur(m.textContent,k,r),_=["children",""+k]):s.hasOwnProperty(S)&&k!=null&&S==="onScroll"&&Ue("scroll",m)}switch(c){case"input":pr(m),_c(m,E,!0);break;case"textarea":pr(m),wc(m);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(m.onclick=Hr)}m=_,a.updateQueue=m,m!==null&&(a.flags|=4)}else{S=_.nodeType===9?_:_.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Sc(c)),r==="http://www.w3.org/1999/xhtml"?c==="script"?(r=S.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof m.is=="string"?r=S.createElement(c,{is:m.is}):(r=S.createElement(c),c==="select"&&(S=r,m.multiple?S.multiple=!0:m.size&&(S.size=m.size))):r=S.createElementNS(r,c),r[ln]=a,r[Ps]=m,Dh(r,a,!1,!1),a.stateNode=r;e:{switch(S=ma(c,m),c){case"dialog":Ue("cancel",r),Ue("close",r),_=m;break;case"iframe":case"object":case"embed":Ue("load",r),_=m;break;case"video":case"audio":for(_=0;_<Is.length;_++)Ue(Is[_],r);_=m;break;case"source":Ue("error",r),_=m;break;case"img":case"image":case"link":Ue("error",r),Ue("load",r),_=m;break;case"details":Ue("toggle",r),_=m;break;case"input":vc(r,m),_=ca(r,m),Ue("invalid",r);break;case"option":_=m;break;case"select":r._wrapperState={wasMultiple:!!m.multiple},_=Q({},m,{value:void 0}),Ue("invalid",r);break;case"textarea":Ec(r,m),_=fa(r,m),Ue("invalid",r);break;default:_=m}ga(c,_),k=_;for(E in k)if(k.hasOwnProperty(E)){var R=k[E];E==="style"?xc(r,R):E==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&Cc(r,R)):E==="children"?typeof R=="string"?(c!=="textarea"||R!=="")&&us(r,R):typeof R=="number"&&us(r,""+R):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(s.hasOwnProperty(E)?R!=null&&E==="onScroll"&&Ue("scroll",r):R!=null&&P(r,E,R,S))}switch(c){case"input":pr(r),_c(r,m,!1);break;case"textarea":pr(r),wc(r);break;case"option":m.value!=null&&r.setAttribute("value",""+Ae(m.value));break;case"select":r.multiple=!!m.multiple,E=m.value,E!=null?ki(r,!!m.multiple,E,!1):m.defaultValue!=null&&ki(r,!!m.multiple,m.defaultValue,!0);break;default:typeof _.onClick=="function"&&(r.onclick=Hr)}switch(c){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return ct(a),null;case 6:if(r&&a.stateNode!=null)Uh(r,a,r.memoizedProps,m);else{if(typeof m!="string"&&a.stateNode===null)throw Error(t(166));if(c=li(Fs.current),li(un.current),$r(a)){if(m=a.stateNode,c=a.memoizedProps,m[ln]=a,(E=m.nodeValue!==c)&&(r=Nt,r!==null))switch(r.tag){case 3:Ur(m.nodeValue,c,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Ur(m.nodeValue,c,(r.mode&1)!==0)}E&&(a.flags|=4)}else m=(c.nodeType===9?c:c.ownerDocument).createTextNode(m),m[ln]=a,a.stateNode=m}return ct(a),null;case 13:if(He(Ve),m=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Oe&&Lt!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Od(),Gi(),a.flags|=98560,E=!1;else if(E=$r(a),m!==null&&m.dehydrated!==null){if(r===null){if(!E)throw Error(t(318));if(E=a.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(t(317));E[ln]=a}else Gi(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ct(a),E=!1}else Xt!==null&&(Wl(Xt),Xt=null),E=!0;if(!E)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=c,a):(m=m!==null,m!==(r!==null&&r.memoizedState!==null)&&m&&(a.child.flags|=8192,(a.mode&1)!==0&&(r===null||(Ve.current&1)!==0?Ze===0&&(Ze=3):Jl())),a.updateQueue!==null&&(a.flags|=4),ct(a),null);case 4:return Wi(),Dl(r,a),r===null&&Rs(a.stateNode.containerInfo),ct(a),null;case 10:return ul(a.type._context),ct(a),null;case 17:return wt(a.type)&&Or(),ct(a),null;case 19:if(He(Ve),E=a.memoizedState,E===null)return ct(a),null;if(m=(a.flags&128)!==0,S=E.rendering,S===null)if(m)Vs(E,!1);else{if(Ze!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(S=Qr(r),S!==null){for(a.flags|=128,Vs(E,!1),m=S.updateQueue,m!==null&&(a.updateQueue=m,a.flags|=4),a.subtreeFlags=0,m=c,c=a.child;c!==null;)E=c,r=m,E.flags&=14680066,S=E.alternate,S===null?(E.childLanes=0,E.lanes=r,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=S.childLanes,E.lanes=S.lanes,E.child=S.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=S.memoizedProps,E.memoizedState=S.memoizedState,E.updateQueue=S.updateQueue,E.type=S.type,r=S.dependencies,E.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),c=c.sibling;return Fe(Ve,Ve.current&1|2),a.child}r=r.sibling}E.tail!==null&&$e()>Xi&&(a.flags|=128,m=!0,Vs(E,!1),a.lanes=4194304)}else{if(!m)if(r=Qr(S),r!==null){if(a.flags|=128,m=!0,c=r.updateQueue,c!==null&&(a.updateQueue=c,a.flags|=4),Vs(E,!0),E.tail===null&&E.tailMode==="hidden"&&!S.alternate&&!Oe)return ct(a),null}else 2*$e()-E.renderingStartTime>Xi&&c!==1073741824&&(a.flags|=128,m=!0,Vs(E,!1),a.lanes=4194304);E.isBackwards?(S.sibling=a.child,a.child=S):(c=E.last,c!==null?c.sibling=S:a.child=S,E.last=S)}return E.tail!==null?(a=E.tail,E.rendering=a,E.tail=a.sibling,E.renderingStartTime=$e(),a.sibling=null,c=Ve.current,Fe(Ve,m?c&1|2:c&1),a):(ct(a),null);case 22:case 23:return Kl(),m=a.memoizedState!==null,r!==null&&r.memoizedState!==null!==m&&(a.flags|=8192),m&&(a.mode&1)!==0?(Dt&1073741824)!==0&&(ct(a),a.subtreeFlags&6&&(a.flags|=8192)):ct(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function Zv(r,a){switch(il(a),a.tag){case 1:return wt(a.type)&&Or(),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return Wi(),He(At),He(lt),ml(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 5:return pl(a),null;case 13:if(He(Ve),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(t(340));Gi()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return He(Ve),null;case 4:return Wi(),null;case 10:return ul(a.type._context),null;case 22:case 23:return Kl(),null;case 24:return null;default:return null}}var oo=!1,dt=!1,jv=typeof WeakSet=="function"?WeakSet:Set,ee=null;function Ki(r,a){var c=r.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(m){qe(r,a,m)}else c.current=null}function Fl(r,a,c){try{c()}catch(m){qe(r,a,m)}}var Hh=!1;function ey(r,a){if(Ka=xr,r=md(),Oa(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var _=m.anchorOffset,E=m.focusNode;m=m.focusOffset;try{c.nodeType,E.nodeType}catch{c=null;break e}var S=0,k=-1,R=-1,B=0,$=0,W=r,z=null;t:for(;;){for(var Z;W!==c||_!==0&&W.nodeType!==3||(k=S+_),W!==E||m!==0&&W.nodeType!==3||(R=S+m),W.nodeType===3&&(S+=W.nodeValue.length),(Z=W.firstChild)!==null;)z=W,W=Z;for(;;){if(W===r)break t;if(z===c&&++B===_&&(k=S),z===E&&++$===m&&(R=S),(Z=W.nextSibling)!==null)break;W=z,z=W.parentNode}W=Z}c=k===-1||R===-1?null:{start:k,end:R}}else c=null}c=c||{start:0,end:0}}else c=null;for(Ja={focusedElem:r,selectionRange:c},xr=!1,ee=a;ee!==null;)if(a=ee,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,ee=r;else for(;ee!==null;){a=ee;try{var te=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(te!==null){var ie=te.memoizedProps,We=te.memoizedState,L=a.stateNode,b=L.getSnapshotBeforeUpdate(a.elementType===a.type?ie:Qt(a.type,ie),We);L.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var D=a.stateNode.containerInfo;D.nodeType===1?D.textContent="":D.nodeType===9&&D.documentElement&&D.removeChild(D.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Y){qe(a,a.return,Y)}if(r=a.sibling,r!==null){r.return=a.return,ee=r;break}ee=a.return}return te=Hh,Hh=!1,te}function Gs(r,a,c){var m=a.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var _=m=m.next;do{if((_.tag&r)===r){var E=_.destroy;_.destroy=void 0,E!==void 0&&Fl(a,c,E)}_=_.next}while(_!==m)}}function ao(r,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var c=a=a.next;do{if((c.tag&r)===r){var m=c.create;c.destroy=m()}c=c.next}while(c!==a)}}function Ul(r){var a=r.ref;if(a!==null){var c=r.stateNode;switch(r.tag){case 5:r=c;break;default:r=c}typeof a=="function"?a(r):a.current=r}}function Bh(r){var a=r.alternate;a!==null&&(r.alternate=null,Bh(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&(delete a[ln],delete a[Ps],delete a[ja],delete a[Fv],delete a[Uv])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Oh(r){return r.tag===5||r.tag===3||r.tag===4}function Vh(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Oh(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Hl(r,a,c){var m=r.tag;if(m===5||m===6)r=r.stateNode,a?c.nodeType===8?c.parentNode.insertBefore(r,a):c.insertBefore(r,a):(c.nodeType===8?(a=c.parentNode,a.insertBefore(r,c)):(a=c,a.appendChild(r)),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Hr));else if(m!==4&&(r=r.child,r!==null))for(Hl(r,a,c),r=r.sibling;r!==null;)Hl(r,a,c),r=r.sibling}function Bl(r,a,c){var m=r.tag;if(m===5||m===6)r=r.stateNode,a?c.insertBefore(r,a):c.appendChild(r);else if(m!==4&&(r=r.child,r!==null))for(Bl(r,a,c),r=r.sibling;r!==null;)Bl(r,a,c),r=r.sibling}var rt=null,Zt=!1;function qn(r,a,c){for(c=c.child;c!==null;)Gh(r,a,c),c=c.sibling}function Gh(r,a,c){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Er,c)}catch{}switch(c.tag){case 5:dt||Ki(c,a);case 6:var m=rt,_=Zt;rt=null,qn(r,a,c),rt=m,Zt=_,rt!==null&&(Zt?(r=rt,c=c.stateNode,r.nodeType===8?r.parentNode.removeChild(c):r.removeChild(c)):rt.removeChild(c.stateNode));break;case 18:rt!==null&&(Zt?(r=rt,c=c.stateNode,r.nodeType===8?Za(r.parentNode,c):r.nodeType===1&&Za(r,c),Es(r)):Za(rt,c.stateNode));break;case 4:m=rt,_=Zt,rt=c.stateNode.containerInfo,Zt=!0,qn(r,a,c),rt=m,Zt=_;break;case 0:case 11:case 14:case 15:if(!dt&&(m=c.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){_=m=m.next;do{var E=_,S=E.destroy;E=E.tag,S!==void 0&&((E&2)!==0||(E&4)!==0)&&Fl(c,a,S),_=_.next}while(_!==m)}qn(r,a,c);break;case 1:if(!dt&&(Ki(c,a),m=c.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=c.memoizedProps,m.state=c.memoizedState,m.componentWillUnmount()}catch(k){qe(c,a,k)}qn(r,a,c);break;case 21:qn(r,a,c);break;case 22:c.mode&1?(dt=(m=dt)||c.memoizedState!==null,qn(r,a,c),dt=m):qn(r,a,c);break;default:qn(r,a,c)}}function zh(r){var a=r.updateQueue;if(a!==null){r.updateQueue=null;var c=r.stateNode;c===null&&(c=r.stateNode=new jv),a.forEach(function(m){var _=uy.bind(null,r,m);c.has(m)||(c.add(m),m.then(_,_))})}}function jt(r,a){var c=a.deletions;if(c!==null)for(var m=0;m<c.length;m++){var _=c[m];try{var E=r,S=a,k=S;e:for(;k!==null;){switch(k.tag){case 5:rt=k.stateNode,Zt=!1;break e;case 3:rt=k.stateNode.containerInfo,Zt=!0;break e;case 4:rt=k.stateNode.containerInfo,Zt=!0;break e}k=k.return}if(rt===null)throw Error(t(160));Gh(E,S,_),rt=null,Zt=!1;var R=_.alternate;R!==null&&(R.return=null),_.return=null}catch(B){qe(_,a,B)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)qh(a,r),a=a.sibling}function qh(r,a){var c=r.alternate,m=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(jt(a,r),dn(r),m&4){try{Gs(3,r,r.return),ao(3,r)}catch(ie){qe(r,r.return,ie)}try{Gs(5,r,r.return)}catch(ie){qe(r,r.return,ie)}}break;case 1:jt(a,r),dn(r),m&512&&c!==null&&Ki(c,c.return);break;case 5:if(jt(a,r),dn(r),m&512&&c!==null&&Ki(c,c.return),r.flags&32){var _=r.stateNode;try{us(_,"")}catch(ie){qe(r,r.return,ie)}}if(m&4&&(_=r.stateNode,_!=null)){var E=r.memoizedProps,S=c!==null?c.memoizedProps:E,k=r.type,R=r.updateQueue;if(r.updateQueue=null,R!==null)try{k==="input"&&E.type==="radio"&&E.name!=null&&yc(_,E),ma(k,S);var B=ma(k,E);for(S=0;S<R.length;S+=2){var $=R[S],W=R[S+1];$==="style"?xc(_,W):$==="dangerouslySetInnerHTML"?Cc(_,W):$==="children"?us(_,W):P(_,$,W,B)}switch(k){case"input":da(_,E);break;case"textarea":Ac(_,E);break;case"select":var z=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!E.multiple;var Z=E.value;Z!=null?ki(_,!!E.multiple,Z,!1):z!==!!E.multiple&&(E.defaultValue!=null?ki(_,!!E.multiple,E.defaultValue,!0):ki(_,!!E.multiple,E.multiple?[]:"",!1))}_[Ps]=E}catch(ie){qe(r,r.return,ie)}}break;case 6:if(jt(a,r),dn(r),m&4){if(r.stateNode===null)throw Error(t(162));_=r.stateNode,E=r.memoizedProps;try{_.nodeValue=E}catch(ie){qe(r,r.return,ie)}}break;case 3:if(jt(a,r),dn(r),m&4&&c!==null&&c.memoizedState.isDehydrated)try{Es(a.containerInfo)}catch(ie){qe(r,r.return,ie)}break;case 4:jt(a,r),dn(r);break;case 13:jt(a,r),dn(r),_=r.child,_.flags&8192&&(E=_.memoizedState!==null,_.stateNode.isHidden=E,!E||_.alternate!==null&&_.alternate.memoizedState!==null||(Gl=$e())),m&4&&zh(r);break;case 22:if($=c!==null&&c.memoizedState!==null,r.mode&1?(dt=(B=dt)||$,jt(a,r),dt=B):jt(a,r),dn(r),m&8192){if(B=r.memoizedState!==null,(r.stateNode.isHidden=B)&&!$&&(r.mode&1)!==0)for(ee=r,$=r.child;$!==null;){for(W=ee=$;ee!==null;){switch(z=ee,Z=z.child,z.tag){case 0:case 11:case 14:case 15:Gs(4,z,z.return);break;case 1:Ki(z,z.return);var te=z.stateNode;if(typeof te.componentWillUnmount=="function"){m=z,c=z.return;try{a=m,te.props=a.memoizedProps,te.state=a.memoizedState,te.componentWillUnmount()}catch(ie){qe(m,c,ie)}}break;case 5:Ki(z,z.return);break;case 22:if(z.memoizedState!==null){Yh(W);continue}}Z!==null?(Z.return=z,ee=Z):Yh(W)}$=$.sibling}e:for($=null,W=r;;){if(W.tag===5){if($===null){$=W;try{_=W.stateNode,B?(E=_.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(k=W.stateNode,R=W.memoizedProps.style,S=R!=null&&R.hasOwnProperty("display")?R.display:null,k.style.display=Tc("display",S))}catch(ie){qe(r,r.return,ie)}}}else if(W.tag===6){if($===null)try{W.stateNode.nodeValue=B?"":W.memoizedProps}catch(ie){qe(r,r.return,ie)}}else if((W.tag!==22&&W.tag!==23||W.memoizedState===null||W===r)&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===r)break e;for(;W.sibling===null;){if(W.return===null||W.return===r)break e;$===W&&($=null),W=W.return}$===W&&($=null),W.sibling.return=W.return,W=W.sibling}}break;case 19:jt(a,r),dn(r),m&4&&zh(r);break;case 21:break;default:jt(a,r),dn(r)}}function dn(r){var a=r.flags;if(a&2){try{e:{for(var c=r.return;c!==null;){if(Oh(c)){var m=c;break e}c=c.return}throw Error(t(160))}switch(m.tag){case 5:var _=m.stateNode;m.flags&32&&(us(_,""),m.flags&=-33);var E=Vh(r);Bl(r,E,_);break;case 3:case 4:var S=m.stateNode.containerInfo,k=Vh(r);Hl(r,k,S);break;default:throw Error(t(161))}}catch(R){qe(r,r.return,R)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function ty(r,a,c){ee=r,$h(r)}function $h(r,a,c){for(var m=(r.mode&1)!==0;ee!==null;){var _=ee,E=_.child;if(_.tag===22&&m){var S=_.memoizedState!==null||oo;if(!S){var k=_.alternate,R=k!==null&&k.memoizedState!==null||dt;k=oo;var B=dt;if(oo=S,(dt=R)&&!B)for(ee=_;ee!==null;)S=ee,R=S.child,S.tag===22&&S.memoizedState!==null?Kh(_):R!==null?(R.return=S,ee=R):Kh(_);for(;E!==null;)ee=E,$h(E),E=E.sibling;ee=_,oo=k,dt=B}Wh(r)}else(_.subtreeFlags&8772)!==0&&E!==null?(E.return=_,ee=E):Wh(r)}}function Wh(r){for(;ee!==null;){var a=ee;if((a.flags&8772)!==0){var c=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:dt||ao(5,a);break;case 1:var m=a.stateNode;if(a.flags&4&&!dt)if(c===null)m.componentDidMount();else{var _=a.elementType===a.type?c.memoizedProps:Qt(a.type,c.memoizedProps);m.componentDidUpdate(_,c.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var E=a.updateQueue;E!==null&&Yd(a,E,m);break;case 3:var S=a.updateQueue;if(S!==null){if(c=null,a.child!==null)switch(a.child.tag){case 5:c=a.child.stateNode;break;case 1:c=a.child.stateNode}Yd(a,S,c)}break;case 5:var k=a.stateNode;if(c===null&&a.flags&4){c=k;var R=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&c.focus();break;case"img":R.src&&(c.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var B=a.alternate;if(B!==null){var $=B.memoizedState;if($!==null){var W=$.dehydrated;W!==null&&Es(W)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}dt||a.flags&512&&Ul(a)}catch(z){qe(a,a.return,z)}}if(a===r){ee=null;break}if(c=a.sibling,c!==null){c.return=a.return,ee=c;break}ee=a.return}}function Yh(r){for(;ee!==null;){var a=ee;if(a===r){ee=null;break}var c=a.sibling;if(c!==null){c.return=a.return,ee=c;break}ee=a.return}}function Kh(r){for(;ee!==null;){var a=ee;try{switch(a.tag){case 0:case 11:case 15:var c=a.return;try{ao(4,a)}catch(R){qe(a,c,R)}break;case 1:var m=a.stateNode;if(typeof m.componentDidMount=="function"){var _=a.return;try{m.componentDidMount()}catch(R){qe(a,_,R)}}var E=a.return;try{Ul(a)}catch(R){qe(a,E,R)}break;case 5:var S=a.return;try{Ul(a)}catch(R){qe(a,S,R)}}}catch(R){qe(a,a.return,R)}if(a===r){ee=null;break}var k=a.sibling;if(k!==null){k.return=a.return,ee=k;break}ee=a.return}}var ny=Math.ceil,lo=M.ReactCurrentDispatcher,Ol=M.ReactCurrentOwner,zt=M.ReactCurrentBatchConfig,ke=0,it=null,Ke=null,ot=0,Dt=0,Ji=Bn(0),Ze=0,zs=null,ci=0,uo=0,Vl=0,qs=null,Ct=null,Gl=0,Xi=1/0,Cn=null,co=!1,zl=null,$n=null,ho=!1,Wn=null,fo=0,$s=0,ql=null,po=-1,go=0;function yt(){return(ke&6)!==0?$e():po!==-1?po:po=$e()}function Yn(r){return(r.mode&1)===0?1:(ke&2)!==0&&ot!==0?ot&-ot:Bv.transition!==null?(go===0&&(go=Vc()),go):(r=Me,r!==0||(r=window.event,r=r===void 0?16:Xc(r.type)),r)}function en(r,a,c,m){if(50<$s)throw $s=0,ql=null,Error(t(185));gs(r,c,m),((ke&2)===0||r!==it)&&(r===it&&((ke&2)===0&&(uo|=c),Ze===4&&Kn(r,ot)),Tt(r,m),c===1&&ke===0&&(a.mode&1)===0&&(Xi=$e()+500,Gr&&Vn()))}function Tt(r,a){var c=r.callbackNode;Bm(r,a);var m=Sr(r,r===it?ot:0);if(m===0)c!==null&&Hc(c),r.callbackNode=null,r.callbackPriority=0;else if(a=m&-m,r.callbackPriority!==a){if(c!=null&&Hc(c),a===1)r.tag===0?Hv(Xh.bind(null,r)):Dd(Xh.bind(null,r)),Lv(function(){(ke&6)===0&&Vn()}),c=null;else{switch(Gc(m)){case 1:c=Sa;break;case 4:c=Bc;break;case 16:c=_r;break;case 536870912:c=Oc;break;default:c=_r}c=rf(c,Jh.bind(null,r))}r.callbackPriority=a,r.callbackNode=c}}function Jh(r,a){if(po=-1,go=0,(ke&6)!==0)throw Error(t(327));var c=r.callbackNode;if(Qi()&&r.callbackNode!==c)return null;var m=Sr(r,r===it?ot:0);if(m===0)return null;if((m&30)!==0||(m&r.expiredLanes)!==0||a)a=mo(r,m);else{a=m;var _=ke;ke|=2;var E=Zh();(it!==r||ot!==a)&&(Cn=null,Xi=$e()+500,hi(r,a));do try{ry();break}catch(k){Qh(r,k)}while(!0);ll(),lo.current=E,ke=_,Ke!==null?a=0:(it=null,ot=0,a=Ze)}if(a!==0){if(a===2&&(_=Ca(r),_!==0&&(m=_,a=$l(r,_))),a===1)throw c=zs,hi(r,0),Kn(r,m),Tt(r,$e()),c;if(a===6)Kn(r,m);else{if(_=r.current.alternate,(m&30)===0&&!iy(_)&&(a=mo(r,m),a===2&&(E=Ca(r),E!==0&&(m=E,a=$l(r,E))),a===1))throw c=zs,hi(r,0),Kn(r,m),Tt(r,$e()),c;switch(r.finishedWork=_,r.finishedLanes=m,a){case 0:case 1:throw Error(t(345));case 2:fi(r,Ct,Cn);break;case 3:if(Kn(r,m),(m&130023424)===m&&(a=Gl+500-$e(),10<a)){if(Sr(r,0)!==0)break;if(_=r.suspendedLanes,(_&m)!==m){yt(),r.pingedLanes|=r.suspendedLanes&_;break}r.timeoutHandle=Qa(fi.bind(null,r,Ct,Cn),a);break}fi(r,Ct,Cn);break;case 4:if(Kn(r,m),(m&4194240)===m)break;for(a=r.eventTimes,_=-1;0<m;){var S=31-Kt(m);E=1<<S,S=a[S],S>_&&(_=S),m&=~E}if(m=_,m=$e()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*ny(m/1960))-m,10<m){r.timeoutHandle=Qa(fi.bind(null,r,Ct,Cn),m);break}fi(r,Ct,Cn);break;case 5:fi(r,Ct,Cn);break;default:throw Error(t(329))}}}return Tt(r,$e()),r.callbackNode===c?Jh.bind(null,r):null}function $l(r,a){var c=qs;return r.current.memoizedState.isDehydrated&&(hi(r,a).flags|=256),r=mo(r,a),r!==2&&(a=Ct,Ct=c,a!==null&&Wl(a)),r}function Wl(r){Ct===null?Ct=r:Ct.push.apply(Ct,r)}function iy(r){for(var a=r;;){if(a.flags&16384){var c=a.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var m=0;m<c.length;m++){var _=c[m],E=_.getSnapshot;_=_.value;try{if(!Jt(E(),_))return!1}catch{return!1}}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Kn(r,a){for(a&=~Vl,a&=~uo,r.suspendedLanes|=a,r.pingedLanes&=~a,r=r.expirationTimes;0<a;){var c=31-Kt(a),m=1<<c;r[c]=-1,a&=~m}}function Xh(r){if((ke&6)!==0)throw Error(t(327));Qi();var a=Sr(r,0);if((a&1)===0)return Tt(r,$e()),null;var c=mo(r,a);if(r.tag!==0&&c===2){var m=Ca(r);m!==0&&(a=m,c=$l(r,m))}if(c===1)throw c=zs,hi(r,0),Kn(r,a),Tt(r,$e()),c;if(c===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=a,fi(r,Ct,Cn),Tt(r,$e()),null}function Yl(r,a){var c=ke;ke|=1;try{return r(a)}finally{ke=c,ke===0&&(Xi=$e()+500,Gr&&Vn())}}function di(r){Wn!==null&&Wn.tag===0&&(ke&6)===0&&Qi();var a=ke;ke|=1;var c=zt.transition,m=Me;try{if(zt.transition=null,Me=1,r)return r()}finally{Me=m,zt.transition=c,ke=a,(ke&6)===0&&Vn()}}function Kl(){Dt=Ji.current,He(Ji)}function hi(r,a){r.finishedWork=null,r.finishedLanes=0;var c=r.timeoutHandle;if(c!==-1&&(r.timeoutHandle=-1,Nv(c)),Ke!==null)for(c=Ke.return;c!==null;){var m=c;switch(il(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Or();break;case 3:Wi(),He(At),He(lt),ml();break;case 5:pl(m);break;case 4:Wi();break;case 13:He(Ve);break;case 19:He(Ve);break;case 10:ul(m.type._context);break;case 22:case 23:Kl()}c=c.return}if(it=r,Ke=r=Jn(r.current,null),ot=Dt=a,Ze=0,zs=null,Vl=uo=ci=0,Ct=qs=null,ai!==null){for(a=0;a<ai.length;a++)if(c=ai[a],m=c.interleaved,m!==null){c.interleaved=null;var _=m.next,E=c.pending;if(E!==null){var S=E.next;E.next=_,m.next=S}c.pending=m}ai=null}return r}function Qh(r,a){do{var c=Ke;try{if(ll(),Zr.current=no,jr){for(var m=Ge.memoizedState;m!==null;){var _=m.queue;_!==null&&(_.pending=null),m=m.next}jr=!1}if(ui=0,nt=Qe=Ge=null,Us=!1,Hs=0,Ol.current=null,c===null||c.return===null){Ze=1,zs=a,Ke=null;break}e:{var E=r,S=c.return,k=c,R=a;if(a=ot,k.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var B=R,$=k,W=$.tag;if(($.mode&1)===0&&(W===0||W===11||W===15)){var z=$.alternate;z?($.updateQueue=z.updateQueue,$.memoizedState=z.memoizedState,$.lanes=z.lanes):($.updateQueue=null,$.memoizedState=null)}var Z=wh(S);if(Z!==null){Z.flags&=-257,Sh(Z,S,k,E,a),Z.mode&1&&Ah(E,B,a),a=Z,R=B;var te=a.updateQueue;if(te===null){var ie=new Set;ie.add(R),a.updateQueue=ie}else te.add(R);break e}else{if((a&1)===0){Ah(E,B,a),Jl();break e}R=Error(t(426))}}else if(Oe&&k.mode&1){var We=wh(S);if(We!==null){(We.flags&65536)===0&&(We.flags|=256),Sh(We,S,k,E,a),ol(Yi(R,k));break e}}E=R=Yi(R,k),Ze!==4&&(Ze=2),qs===null?qs=[E]:qs.push(E),E=S;do{switch(E.tag){case 3:E.flags|=65536,a&=-a,E.lanes|=a;var L=_h(E,R,a);Wd(E,L);break e;case 1:k=R;var b=E.type,D=E.stateNode;if((E.flags&128)===0&&(typeof b.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&($n===null||!$n.has(D)))){E.flags|=65536,a&=-a,E.lanes|=a;var Y=Eh(E,k,a);Wd(E,Y);break e}}E=E.return}while(E!==null)}ef(c)}catch(se){a=se,Ke===c&&c!==null&&(Ke=c=c.return);continue}break}while(!0)}function Zh(){var r=lo.current;return lo.current=no,r===null?no:r}function Jl(){(Ze===0||Ze===3||Ze===2)&&(Ze=4),it===null||(ci&268435455)===0&&(uo&268435455)===0||Kn(it,ot)}function mo(r,a){var c=ke;ke|=2;var m=Zh();(it!==r||ot!==a)&&(Cn=null,hi(r,a));do try{sy();break}catch(_){Qh(r,_)}while(!0);if(ll(),ke=c,lo.current=m,Ke!==null)throw Error(t(261));return it=null,ot=0,Ze}function sy(){for(;Ke!==null;)jh(Ke)}function ry(){for(;Ke!==null&&!bm();)jh(Ke)}function jh(r){var a=sf(r.alternate,r,Dt);r.memoizedProps=r.pendingProps,a===null?ef(r):Ke=a,Ol.current=null}function ef(r){var a=r;do{var c=a.alternate;if(r=a.return,(a.flags&32768)===0){if(c=Qv(c,a,Dt),c!==null){Ke=c;return}}else{if(c=Zv(c,a),c!==null){c.flags&=32767,Ke=c;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Ze=6,Ke=null;return}}if(a=a.sibling,a!==null){Ke=a;return}Ke=a=r}while(a!==null);Ze===0&&(Ze=5)}function fi(r,a,c){var m=Me,_=zt.transition;try{zt.transition=null,Me=1,oy(r,a,c,m)}finally{zt.transition=_,Me=m}return null}function oy(r,a,c,m){do Qi();while(Wn!==null);if((ke&6)!==0)throw Error(t(327));c=r.finishedWork;var _=r.finishedLanes;if(c===null)return null;if(r.finishedWork=null,r.finishedLanes=0,c===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var E=c.lanes|c.childLanes;if(Om(r,E),r===it&&(Ke=it=null,ot=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||ho||(ho=!0,rf(_r,function(){return Qi(),null})),E=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||E){E=zt.transition,zt.transition=null;var S=Me;Me=1;var k=ke;ke|=4,Ol.current=null,ey(r,c),qh(c,r),xv(Ja),xr=!!Ka,Ja=Ka=null,r.current=c,ty(c),Pm(),ke=k,Me=S,zt.transition=E}else r.current=c;if(ho&&(ho=!1,Wn=r,fo=_),E=r.pendingLanes,E===0&&($n=null),Lm(c.stateNode),Tt(r,$e()),a!==null)for(m=r.onRecoverableError,c=0;c<a.length;c++)_=a[c],m(_.value,{componentStack:_.stack,digest:_.digest});if(co)throw co=!1,r=zl,zl=null,r;return(fo&1)!==0&&r.tag!==0&&Qi(),E=r.pendingLanes,(E&1)!==0?r===ql?$s++:($s=0,ql=r):$s=0,Vn(),null}function Qi(){if(Wn!==null){var r=Gc(fo),a=zt.transition,c=Me;try{if(zt.transition=null,Me=16>r?16:r,Wn===null)var m=!1;else{if(r=Wn,Wn=null,fo=0,(ke&6)!==0)throw Error(t(331));var _=ke;for(ke|=4,ee=r.current;ee!==null;){var E=ee,S=E.child;if((ee.flags&16)!==0){var k=E.deletions;if(k!==null){for(var R=0;R<k.length;R++){var B=k[R];for(ee=B;ee!==null;){var $=ee;switch($.tag){case 0:case 11:case 15:Gs(8,$,E)}var W=$.child;if(W!==null)W.return=$,ee=W;else for(;ee!==null;){$=ee;var z=$.sibling,Z=$.return;if(Bh($),$===B){ee=null;break}if(z!==null){z.return=Z,ee=z;break}ee=Z}}}var te=E.alternate;if(te!==null){var ie=te.child;if(ie!==null){te.child=null;do{var We=ie.sibling;ie.sibling=null,ie=We}while(ie!==null)}}ee=E}}if((E.subtreeFlags&2064)!==0&&S!==null)S.return=E,ee=S;else e:for(;ee!==null;){if(E=ee,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:Gs(9,E,E.return)}var L=E.sibling;if(L!==null){L.return=E.return,ee=L;break e}ee=E.return}}var b=r.current;for(ee=b;ee!==null;){S=ee;var D=S.child;if((S.subtreeFlags&2064)!==0&&D!==null)D.return=S,ee=D;else e:for(S=b;ee!==null;){if(k=ee,(k.flags&2048)!==0)try{switch(k.tag){case 0:case 11:case 15:ao(9,k)}}catch(se){qe(k,k.return,se)}if(k===S){ee=null;break e}var Y=k.sibling;if(Y!==null){Y.return=k.return,ee=Y;break e}ee=k.return}}if(ke=_,Vn(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Er,r)}catch{}m=!0}return m}finally{Me=c,zt.transition=a}}return!1}function tf(r,a,c){a=Yi(c,a),a=_h(r,a,1),r=zn(r,a,1),a=yt(),r!==null&&(gs(r,1,a),Tt(r,a))}function qe(r,a,c){if(r.tag===3)tf(r,r,c);else for(;a!==null;){if(a.tag===3){tf(a,r,c);break}else if(a.tag===1){var m=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&($n===null||!$n.has(m))){r=Yi(c,r),r=Eh(a,r,1),a=zn(a,r,1),r=yt(),a!==null&&(gs(a,1,r),Tt(a,r));break}}a=a.return}}function ay(r,a,c){var m=r.pingCache;m!==null&&m.delete(a),a=yt(),r.pingedLanes|=r.suspendedLanes&c,it===r&&(ot&c)===c&&(Ze===4||Ze===3&&(ot&130023424)===ot&&500>$e()-Gl?hi(r,0):Vl|=c),Tt(r,a)}function nf(r,a){a===0&&((r.mode&1)===0?a=1:(a=wr,wr<<=1,(wr&130023424)===0&&(wr=4194304)));var c=yt();r=An(r,a),r!==null&&(gs(r,a,c),Tt(r,c))}function ly(r){var a=r.memoizedState,c=0;a!==null&&(c=a.retryLane),nf(r,c)}function uy(r,a){var c=0;switch(r.tag){case 13:var m=r.stateNode,_=r.memoizedState;_!==null&&(c=_.retryLane);break;case 19:m=r.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(a),nf(r,c)}var sf;sf=function(r,a,c){if(r!==null)if(r.memoizedProps!==a.pendingProps||At.current)St=!0;else{if((r.lanes&c)===0&&(a.flags&128)===0)return St=!1,Xv(r,a,c);St=(r.flags&131072)!==0}else St=!1,Oe&&(a.flags&1048576)!==0&&Fd(a,qr,a.index);switch(a.lanes=0,a.tag){case 2:var m=a.type;ro(r,a),r=a.pendingProps;var _=Bi(a,lt.current);$i(a,c),_=_l(null,a,m,r,_,c);var E=El();return a.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,wt(m)?(E=!0,Vr(a)):E=!1,a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,hl(a),_.updater=io,a.stateNode=_,_._reactInternals=a,xl(a,m,r,c),a=bl(null,a,m,!0,E,c)):(a.tag=0,Oe&&E&&nl(a),vt(null,a,_,c),a=a.child),a;case 16:m=a.elementType;e:{switch(ro(r,a),r=a.pendingProps,_=m._init,m=_(m._payload),a.type=m,_=a.tag=dy(m),r=Qt(m,r),_){case 0:a=Rl(null,a,m,r,c);break e;case 1:a=Rh(null,a,m,r,c);break e;case 11:a=Ch(null,a,m,r,c);break e;case 14:a=Th(null,a,m,Qt(m.type,r),c);break e}throw Error(t(306,m,""))}return a;case 0:return m=a.type,_=a.pendingProps,_=a.elementType===m?_:Qt(m,_),Rl(r,a,m,_,c);case 1:return m=a.type,_=a.pendingProps,_=a.elementType===m?_:Qt(m,_),Rh(r,a,m,_,c);case 3:e:{if(bh(a),r===null)throw Error(t(387));m=a.pendingProps,E=a.memoizedState,_=E.element,$d(r,a),Xr(a,m,null,c);var S=a.memoizedState;if(m=S.element,E.isDehydrated)if(E={element:m,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},a.updateQueue.baseState=E,a.memoizedState=E,a.flags&256){_=Yi(Error(t(423)),a),a=Ph(r,a,m,c,_);break e}else if(m!==_){_=Yi(Error(t(424)),a),a=Ph(r,a,m,c,_);break e}else for(Lt=Hn(a.stateNode.containerInfo.firstChild),Nt=a,Oe=!0,Xt=null,c=zd(a,null,m,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Gi(),m===_){a=Sn(r,a,c);break e}vt(r,a,m,c)}a=a.child}return a;case 5:return Kd(a),r===null&&rl(a),m=a.type,_=a.pendingProps,E=r!==null?r.memoizedProps:null,S=_.children,Xa(m,_)?S=null:E!==null&&Xa(m,E)&&(a.flags|=32),Ih(r,a),vt(r,a,S,c),a.child;case 6:return r===null&&rl(a),null;case 13:return Mh(r,a,c);case 4:return fl(a,a.stateNode.containerInfo),m=a.pendingProps,r===null?a.child=zi(a,null,m,c):vt(r,a,m,c),a.child;case 11:return m=a.type,_=a.pendingProps,_=a.elementType===m?_:Qt(m,_),Ch(r,a,m,_,c);case 7:return vt(r,a,a.pendingProps,c),a.child;case 8:return vt(r,a,a.pendingProps.children,c),a.child;case 12:return vt(r,a,a.pendingProps.children,c),a.child;case 10:e:{if(m=a.type._context,_=a.pendingProps,E=a.memoizedProps,S=_.value,Fe(Yr,m._currentValue),m._currentValue=S,E!==null)if(Jt(E.value,S)){if(E.children===_.children&&!At.current){a=Sn(r,a,c);break e}}else for(E=a.child,E!==null&&(E.return=a);E!==null;){var k=E.dependencies;if(k!==null){S=E.child;for(var R=k.firstContext;R!==null;){if(R.context===m){if(E.tag===1){R=wn(-1,c&-c),R.tag=2;var B=E.updateQueue;if(B!==null){B=B.shared;var $=B.pending;$===null?R.next=R:(R.next=$.next,$.next=R),B.pending=R}}E.lanes|=c,R=E.alternate,R!==null&&(R.lanes|=c),cl(E.return,c,a),k.lanes|=c;break}R=R.next}}else if(E.tag===10)S=E.type===a.type?null:E.child;else if(E.tag===18){if(S=E.return,S===null)throw Error(t(341));S.lanes|=c,k=S.alternate,k!==null&&(k.lanes|=c),cl(S,c,a),S=E.sibling}else S=E.child;if(S!==null)S.return=E;else for(S=E;S!==null;){if(S===a){S=null;break}if(E=S.sibling,E!==null){E.return=S.return,S=E;break}S=S.return}E=S}vt(r,a,_.children,c),a=a.child}return a;case 9:return _=a.type,m=a.pendingProps.children,$i(a,c),_=Vt(_),m=m(_),a.flags|=1,vt(r,a,m,c),a.child;case 14:return m=a.type,_=Qt(m,a.pendingProps),_=Qt(m.type,_),Th(r,a,m,_,c);case 15:return xh(r,a,a.type,a.pendingProps,c);case 17:return m=a.type,_=a.pendingProps,_=a.elementType===m?_:Qt(m,_),ro(r,a),a.tag=1,wt(m)?(r=!0,Vr(a)):r=!1,$i(a,c),vh(a,m,_),xl(a,m,_,c),bl(null,a,m,!0,r,c);case 19:return Lh(r,a,c);case 22:return kh(r,a,c)}throw Error(t(156,a.tag))};function rf(r,a){return Uc(r,a)}function cy(r,a,c,m){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qt(r,a,c,m){return new cy(r,a,c,m)}function Xl(r){return r=r.prototype,!(!r||!r.isReactComponent)}function dy(r){if(typeof r=="function")return Xl(r)?1:0;if(r!=null){if(r=r.$$typeof,r===le)return 11;if(r===Te)return 14}return 2}function Jn(r,a){var c=r.alternate;return c===null?(c=qt(r.tag,a,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=a,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&14680064,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,a=r.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c}function vo(r,a,c,m,_,E){var S=2;if(m=r,typeof r=="function")Xl(r)&&(S=1);else if(typeof r=="string")S=5;else e:switch(r){case O:return pi(c.children,_,E,a);case K:S=8,_|=8;break;case q:return r=qt(12,c,a,_|2),r.elementType=q,r.lanes=E,r;case ge:return r=qt(13,c,a,_),r.elementType=ge,r.lanes=E,r;case Pe:return r=qt(19,c,a,_),r.elementType=Pe,r.lanes=E,r;case X:return yo(c,_,E,a);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case J:S=10;break e;case j:S=9;break e;case le:S=11;break e;case Te:S=14;break e;case ye:S=16,m=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return a=qt(S,c,a,_),a.elementType=r,a.type=m,a.lanes=E,a}function pi(r,a,c,m){return r=qt(7,r,m,a),r.lanes=c,r}function yo(r,a,c,m){return r=qt(22,r,m,a),r.elementType=X,r.lanes=c,r.stateNode={isHidden:!1},r}function Ql(r,a,c){return r=qt(6,r,null,a),r.lanes=c,r}function Zl(r,a,c){return a=qt(4,r.children!==null?r.children:[],r.key,a),a.lanes=c,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}function hy(r,a,c,m,_){this.tag=a,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ta(0),this.expirationTimes=Ta(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ta(0),this.identifierPrefix=m,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function jl(r,a,c,m,_,E,S,k,R){return r=new hy(r,a,c,k,R),a===1?(a=1,E===!0&&(a|=8)):a=0,E=qt(3,null,null,a),r.current=E,E.stateNode=r,E.memoizedState={element:m,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},hl(E),r}function fy(r,a,c){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:m==null?null:""+m,children:r,containerInfo:a,implementation:c}}function of(r){if(!r)return On;r=r._reactInternals;e:{if(ni(r)!==r||r.tag!==1)throw Error(t(170));var a=r;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(wt(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(r.tag===1){var c=r.type;if(wt(c))return Nd(r,c,a)}return a}function af(r,a,c,m,_,E,S,k,R){return r=jl(c,m,!0,r,_,E,S,k,R),r.context=of(null),c=r.current,m=yt(),_=Yn(c),E=wn(m,_),E.callback=a??null,zn(c,E,_),r.current.lanes=_,gs(r,_,m),Tt(r,m),r}function _o(r,a,c,m){var _=a.current,E=yt(),S=Yn(_);return c=of(c),a.context===null?a.context=c:a.pendingContext=c,a=wn(E,S),a.payload={element:r},m=m===void 0?null:m,m!==null&&(a.callback=m),r=zn(_,a,S),r!==null&&(en(r,_,S,E),Jr(r,_,S)),S}function Eo(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function lf(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<a?c:a}}function eu(r,a){lf(r,a),(r=r.alternate)&&lf(r,a)}function py(){return null}var uf=typeof reportError=="function"?reportError:function(r){console.error(r)};function tu(r){this._internalRoot=r}Ao.prototype.render=tu.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(t(409));_o(r,a,null,null)},Ao.prototype.unmount=tu.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;di(function(){_o(null,r,null,null)}),a[vn]=null}};function Ao(r){this._internalRoot=r}Ao.prototype.unstable_scheduleHydration=function(r){if(r){var a=$c();r={blockedOn:null,target:r,priority:a};for(var c=0;c<Dn.length&&a!==0&&a<Dn[c].priority;c++);Dn.splice(c,0,r),c===0&&Kc(r)}};function nu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function wo(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function cf(){}function gy(r,a,c,m,_){if(_){if(typeof m=="function"){var E=m;m=function(){var B=Eo(S);E.call(B)}}var S=af(a,m,r,0,null,!1,!1,"",cf);return r._reactRootContainer=S,r[vn]=S.current,Rs(r.nodeType===8?r.parentNode:r),di(),S}for(;_=r.lastChild;)r.removeChild(_);if(typeof m=="function"){var k=m;m=function(){var B=Eo(R);k.call(B)}}var R=jl(r,0,!1,null,null,!1,!1,"",cf);return r._reactRootContainer=R,r[vn]=R.current,Rs(r.nodeType===8?r.parentNode:r),di(function(){_o(a,R,c,m)}),R}function So(r,a,c,m,_){var E=c._reactRootContainer;if(E){var S=E;if(typeof _=="function"){var k=_;_=function(){var R=Eo(S);k.call(R)}}_o(a,S,r,_)}else S=gy(c,a,r,_,m);return Eo(S)}zc=function(r){switch(r.tag){case 3:var a=r.stateNode;if(a.current.memoizedState.isDehydrated){var c=ps(a.pendingLanes);c!==0&&(xa(a,c|1),Tt(a,$e()),(ke&6)===0&&(Xi=$e()+500,Vn()))}break;case 13:di(function(){var m=An(r,1);if(m!==null){var _=yt();en(m,r,1,_)}}),eu(r,1)}},ka=function(r){if(r.tag===13){var a=An(r,134217728);if(a!==null){var c=yt();en(a,r,134217728,c)}eu(r,134217728)}},qc=function(r){if(r.tag===13){var a=Yn(r),c=An(r,a);if(c!==null){var m=yt();en(c,r,a,m)}eu(r,a)}},$c=function(){return Me},Wc=function(r,a){var c=Me;try{return Me=r,a()}finally{Me=c}},_a=function(r,a,c){switch(a){case"input":if(da(r,c),a=c.name,c.type==="radio"&&a!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<c.length;a++){var m=c[a];if(m!==r&&m.form===r.form){var _=Br(m);if(!_)throw Error(t(90));mc(m),da(m,_)}}}break;case"textarea":Ac(r,c);break;case"select":a=c.value,a!=null&&ki(r,!!c.multiple,a,!1)}},bc=Yl,Pc=di;var my={usingClientEntryPoint:!1,Events:[Ms,Ui,Br,Ic,Rc,Yl]},Ws={findFiberByHostInstance:ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vy={bundleType:Ws.bundleType,version:Ws.version,rendererPackageName:Ws.rendererPackageName,rendererConfig:Ws.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Dc(r),r===null?null:r.stateNode},findFiberByHostInstance:Ws.findFiberByHostInstance||py,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Co=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Co.isDisabled&&Co.supportsFiber)try{Er=Co.inject(vy),an=Co}catch{}}return xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=my,xt.createPortal=function(r,a){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nu(a))throw Error(t(200));return fy(r,a,null,c)},xt.createRoot=function(r,a){if(!nu(r))throw Error(t(299));var c=!1,m="",_=uf;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onRecoverableError!==void 0&&(_=a.onRecoverableError)),a=jl(r,1,!1,null,null,c,!1,m,_),r[vn]=a.current,Rs(r.nodeType===8?r.parentNode:r),new tu(a)},xt.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Dc(a),r=r===null?null:r.stateNode,r},xt.flushSync=function(r){return di(r)},xt.hydrate=function(r,a,c){if(!wo(a))throw Error(t(200));return So(null,r,a,!0,c)},xt.hydrateRoot=function(r,a,c){if(!nu(r))throw Error(t(405));var m=c!=null&&c.hydratedSources||null,_=!1,E="",S=uf;if(c!=null&&(c.unstable_strictMode===!0&&(_=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onRecoverableError!==void 0&&(S=c.onRecoverableError)),a=af(a,null,r,1,c??null,_,!1,E,S),r[vn]=a.current,Rs(r),m)for(r=0;r<m.length;r++)c=m[r],_=c._getVersion,_=_(c._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[c,_]:a.mutableSourceEagerHydrationData.push(c,_);return new Ao(a)},xt.render=function(r,a,c){if(!wo(a))throw Error(t(200));return So(null,r,a,!1,c)},xt.unmountComponentAtNode=function(r){if(!wo(r))throw Error(t(40));return r._reactRootContainer?(di(function(){So(null,null,r,!1,function(){r._reactRootContainer=null,r[vn]=null})}),!0):!1},xt.unstable_batchedUpdates=Yl,xt.unstable_renderSubtreeIntoContainer=function(r,a,c,m){if(!wo(c))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return So(r,a,c,!1,m)},xt.version="18.3.1-next-f1338f8080-20240426",xt}var yf;function xy(){if(yf)return ru.exports;yf=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),ru.exports=Ty(),ru.exports}var _f;function ky(){if(_f)return To;_f=1;var i=xy();return To.createRoot=i.createRoot,To.hydrateRoot=i.hydrateRoot,To}var Iy=ky();const Ry=dg(Iy);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let by,Py;function My(){return{geminiUrl:by,vertexUrl:Py}}function Ny(i,e,t,n){var s,o;if(!i?.baseUrl){const l=My();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(o=l.geminiUrl)!==null&&o!==void 0?o:n}return i.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wi{}function ne(i,e){const t=/\{([^}]+)\}/g;return i.replace(t,(n,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const o=e[s];return o!=null?String(o):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function g(i,e,t){for(let o=0;o<e.length-1;o++){const l=e[o];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in i))if(Array.isArray(t))i[u]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(i[u])){const d=i[u];if(Array.isArray(t))for(let h=0;h<d.length;h++){const p=d[h];g(p,e.slice(o+1),t[h])}else for(const h of d)g(h,e.slice(o+1),t)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in i||(i[u]=[{}]);const d=i[u];g(d[0],e.slice(o+1),t);return}(!i[l]||typeof i[l]!="object")&&(i[l]={}),i=i[l]}const n=e[e.length-1],s=i[n];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(i,t):i[n]=t}function f(i,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return i;for(let n=0;n<e.length;n++){if(typeof i!="object"||i===null)return t;const s=e[n];if(s.endsWith("[]")){const o=s.slice(0,-2);if(o in i){const l=i[o];return Array.isArray(l)?l.map(u=>f(u,e.slice(n+1),t)):t}else return t}else i=i[s]}return i}catch(n){if(n instanceof TypeError)return t;throw n}}function Ly(i,e){for(const[t,n]of Object.entries(e)){const s=t.split("."),o=n.split("."),l=new Set;let u=-1;for(let d=0;d<s.length;d++)if(s[d]==="*"){u=d;break}if(u!==-1&&o.length>u)for(let d=u;d<o.length;d++){const h=o[d];h!=="*"&&!h.endsWith("[]")&&!h.endsWith("[0]")&&l.add(h)}mu(i,s,o,0,l)}}function mu(i,e,t,n,s){if(n>=e.length||typeof i!="object"||i===null)return;const o=e[n];if(o.endsWith("[]")){const l=o.slice(0,-2),u=i;if(l in u&&Array.isArray(u[l]))for(const d of u[l])mu(d,e,t,n+1,s)}else if(o==="*"){if(typeof i=="object"&&i!==null&&!Array.isArray(i)){const l=i,u=Object.keys(l).filter(h=>!h.startsWith("_")&&!s.has(h)),d={};for(const h of u)d[h]=l[h];for(const[h,p]of Object.entries(d)){const v=[];for(const y of t.slice(n))y==="*"?v.push(h):v.push(y);g(l,v,p)}for(const h of u)delete l[h]}}else{const l=i;o in l&&mu(l[o],e,t,n+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bu(i){if(typeof i!="string")throw new Error("fromImageBytes must be a string");return i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Dy(i){const e={},t=f(i,["operationName"]);t!=null&&g(e,["operationName"],t);const n=f(i,["resourceName"]);return n!=null&&g(e,["_url","resourceName"],n),e}function Fy(i){const e={},t=f(i,["name"]);t!=null&&g(e,["name"],t);const n=f(i,["metadata"]);n!=null&&g(e,["metadata"],n);const s=f(i,["done"]);s!=null&&g(e,["done"],s);const o=f(i,["error"]);o!=null&&g(e,["error"],o);const l=f(i,["response","generateVideoResponse"]);return l!=null&&g(e,["response"],Hy(l)),e}function Uy(i){const e={},t=f(i,["name"]);t!=null&&g(e,["name"],t);const n=f(i,["metadata"]);n!=null&&g(e,["metadata"],n);const s=f(i,["done"]);s!=null&&g(e,["done"],s);const o=f(i,["error"]);o!=null&&g(e,["error"],o);const l=f(i,["response"]);return l!=null&&g(e,["response"],By(l)),e}function Hy(i){const e={},t=f(i,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Oy(l))),g(e,["generatedVideos"],o)}const n=f(i,["raiMediaFilteredCount"]);n!=null&&g(e,["raiMediaFilteredCount"],n);const s=f(i,["raiMediaFilteredReasons"]);return s!=null&&g(e,["raiMediaFilteredReasons"],s),e}function By(i){const e={},t=f(i,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Vy(l))),g(e,["generatedVideos"],o)}const n=f(i,["raiMediaFilteredCount"]);n!=null&&g(e,["raiMediaFilteredCount"],n);const s=f(i,["raiMediaFilteredReasons"]);return s!=null&&g(e,["raiMediaFilteredReasons"],s),e}function Oy(i){const e={},t=f(i,["video"]);return t!=null&&g(e,["video"],qy(t)),e}function Vy(i){const e={},t=f(i,["_self"]);return t!=null&&g(e,["video"],$y(t)),e}function Gy(i){const e={},t=f(i,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function zy(i){const e={},t=f(i,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function qy(i){const e={},t=f(i,["uri"]);t!=null&&g(e,["uri"],t);const n=f(i,["encodedVideo"]);n!=null&&g(e,["videoBytes"],Bu(n));const s=f(i,["encoding"]);return s!=null&&g(e,["mimeType"],s),e}function $y(i){const e={},t=f(i,["gcsUri"]);t!=null&&g(e,["uri"],t);const n=f(i,["bytesBase64Encoded"]);n!=null&&g(e,["videoBytes"],Bu(n));const s=f(i,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ef;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ef||(Ef={}));var Af;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(Af||(Af={}));var wf;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(wf||(wf={}));var rn;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(rn||(rn={}));var Sf;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(Sf||(Sf={}));var Cf;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(Cf||(Cf={}));var Tf;(function(i){i.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Tf||(Tf={}));var xf;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",i.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",i.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",i.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",i.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(xf||(xf={}));var kf;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(kf||(kf={}));var If;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(If||(If={}));var Rf;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",i.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",i.NO_IMAGE="NO_IMAGE"})(Rf||(Rf={}));var bf;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(bf||(bf={}));var Pf;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Pf||(Pf={}));var Mf;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",i.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",i.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Mf||(Mf={}));var Nf;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.IMAGE_SAFETY="IMAGE_SAFETY",i.MODEL_ARMOR="MODEL_ARMOR",i.JAILBREAK="JAILBREAK"})(Nf||(Nf={}));var Lf;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Lf||(Lf={}));var Fo;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(Fo||(Fo={}));var Df;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Df||(Df={}));var Ff;(function(i){i.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",i.TUNING_MODE_FULL="TUNING_MODE_FULL",i.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Ff||(Ff={}));var Uf;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Uf||(Uf={}));var vu;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(vu||(vu={}));var Hf;(function(i){i.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",i.TUNING_TASK_I2V="TUNING_TASK_I2V",i.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Hf||(Hf={}));var Bf;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(Bf||(Bf={}));var Of;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(Of||(Of={}));var Vf;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(Vf||(Vf={}));var Gf;(function(i){i.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",i.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Gf||(Gf={}));var zf;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE",i.VALIDATED="VALIDATED"})(zf||(zf={}));var qf;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(qf||(qf={}));var $f;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})($f||($f={}));var Wf;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi",i.zh="zh",i.pt="pt",i.es="es"})(Wf||(Wf={}));var Yf;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Yf||(Yf={}));var Kf;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Kf||(Kf={}));var Jf;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Jf||(Jf={}));var Xf;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Xf||(Xf={}));var Qf;(function(i){i.FOREGROUND="FOREGROUND",i.BACKGROUND="BACKGROUND",i.PROMPT="PROMPT",i.SEMANTIC="SEMANTIC",i.INTERACTIVE="INTERACTIVE"})(Qf||(Qf={}));var Zf;(function(i){i.ASSET="ASSET",i.STYLE="STYLE"})(Zf||(Zf={}));var jf;(function(i){i.INSERT="INSERT",i.REMOVE="REMOVE",i.REMOVE_STATIC="REMOVE_STATIC",i.OUTPAINT="OUTPAINT"})(jf||(jf={}));var ep;(function(i){i.OPTIMIZED="OPTIMIZED",i.LOSSLESS="LOSSLESS"})(ep||(ep={}));var tp;(function(i){i.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",i.PREFERENCE_TUNING="PREFERENCE_TUNING"})(tp||(tp={}));var np;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(np||(np={}));var ip;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED"})(ip||(ip={}));var sp;(function(i){i.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.RESPONSE_REJECTED="RESPONSE_REJECTED",i.NEED_MORE_INPUT="NEED_MORE_INPUT"})(sp||(sp={}));var rp;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(rp||(rp={}));var op;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(op||(op={}));var ap;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(ap||(ap={}));var lp;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(lp||(lp={}));var up;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(up||(up={}));var cp;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(cp||(cp={}));var dp;(function(i){i.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",i.QUALITY="QUALITY",i.DIVERSITY="DIVERSITY",i.VOCALIZATION="VOCALIZATION"})(dp||(dp={}));var Zi;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(Zi||(Zi={}));class yu{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ks{get text(){var e,t,n,s,o,l,u,d;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",p=!1;const v=[];for(const y of(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[A,w]of Object.entries(y))A!=="text"&&A!=="thought"&&(w!==null||w!==void 0)&&v.push(A);if(typeof y.text=="string"){if(typeof y.thought=="boolean"&&y.thought)continue;p=!0,h+=y.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?h:void 0}get data(){var e,t,n,s,o,l,u,d;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const p=[];for(const v of(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[y,A]of Object.entries(v))y!=="inlineData"&&(A!==null||A!==void 0)&&p.push(y);v.inlineData&&typeof v.inlineData.data=="string"&&(h+=atob(v.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var e,t,n,s,o,l,u,d;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if(h?.length!==0)return h}get executableCode(){var e,t,n,s,o,l,u,d,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if(p?.length!==0)return(h=p?.[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var e,t,n,s,o,l,u,d,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if(p?.length!==0)return(h=p?.[0])===null||h===void 0?void 0:h.output}}class hp{}class fp{}class Wy{}class Yy{}class Ky{}class Jy{}class pp{}class gp{}class mp{}class Xy{}class Uo{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const n=new Uo;let s;const o=e;return t?s=Uy(o):s=Fy(o),Object.assign(n,s),n}}class vp{}class yp{}class _p{}class Qy{}class Zy{}class jy{}class Ep{}class e0{get text(){var e,t,n;let s="",o=!1;const l=[];for(const u of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[d,h]of Object.entries(u))d!=="text"&&d!=="thought"&&h!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;o=!0,s+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?s:void 0}get data(){var e,t,n;let s="";const o=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&o.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class t0{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Re(i,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(i.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function hg(i,e){const t=Re(i,e);return t?t.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:t.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${t}`:t:""}function fg(i){return Array.isArray(i)?i.map(e=>Ho(e)):[Ho(i)]}function Ho(i){if(typeof i=="object"&&i!==null)return i;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof i}`)}function pg(i){const e=Ho(i);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function gg(i){const e=Ho(i);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Ap(i){if(i==null)throw new Error("PartUnion is required");if(typeof i=="object")return i;if(typeof i=="string")return{text:i};throw new Error(`Unsupported part type: ${typeof i}`)}function mg(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("PartListUnion is required");return Array.isArray(i)?i.map(e=>Ap(e)):[Ap(i)]}function _u(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function wp(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function Sp(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function gt(i){if(i==null)throw new Error("ContentUnion is required");return _u(i)?i:{role:"user",parts:mg(i)}}function Ou(i,e){if(!e)return[];if(i.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=gt(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const t=gt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>gt(t)):[gt(e)]}function Yt(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("contents are required");if(!Array.isArray(i)){if(wp(i)||Sp(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[gt(i)]}const e=[],t=[],n=_u(i[0]);for(const s of i){const o=_u(s);if(o!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(s);else{if(wp(s)||Sp(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return n||e.push({role:"user",parts:mg(t)}),e}function n0(i,e){i.includes("null")&&(e.nullable=!0);const t=i.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(rn).includes(t[0].toUpperCase())?t[0].toUpperCase():rn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(rn).includes(n.toUpperCase())?n.toUpperCase():rn.TYPE_UNSPECIFIED})}}function es(i){const e={},t=["items"],n=["anyOf"],s=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=i.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,i=o[1]):o[1].type==="null"&&(e.nullable=!0,i=o[0])),i.type instanceof Array&&n0(i.type,e);for(const[l,u]of Object.entries(i))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(rn).includes(u.toUpperCase())?u.toUpperCase():rn.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=es(u);else if(n.includes(l)){const d=[];for(const h of u){if(h.type=="null"){e.nullable=!0;continue}d.push(es(h))}e[l]=d}else if(s.includes(l)){const d={};for(const[h,p]of Object.entries(u))d[h]=es(p);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=u}return e}function Vu(i){return es(i)}function Gu(i){if(typeof i=="object")return i;if(typeof i=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}};throw new Error(`Unsupported speechConfig type: ${typeof i}`)}function zu(i){if("multiSpeakerVoiceConfig"in i)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return i}function rs(i){if(i.functionDeclarations)for(const e of i.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=es(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=es(e.response));return i}function os(i){if(i==null)throw new Error("tools is required");if(!Array.isArray(i))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of i)e.push(t);return e}function i0(i,e,t,n=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===n;return i.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${i.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:s?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Pn(i,e){if(typeof e!="string")throw new Error("name must be a string");return i0(i,e,"cachedContents")}function vg(i){switch(i){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return i}}function ei(i){return Bu(i)}function s0(i){return i!=null&&typeof i=="object"&&"name"in i}function r0(i){return i!=null&&typeof i=="object"&&"video"in i}function o0(i){return i!=null&&typeof i=="object"&&"uri"in i}function yg(i){var e;let t;if(s0(i)&&(t=i.name),!(o0(i)&&(t=i.uri,t===void 0))&&!(r0(i)&&(t=(e=i.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof i=="string"&&(t=i),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function _g(i,e){let t;return i.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Eg(i){for(const e of["models","tunedModels","publisherModels"])if(a0(i,e))return i[e];return[]}function a0(i,e){return i!==null&&typeof i=="object"&&e in i}function l0(i,e={}){const t=i,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(n.responseJsonSchema=t.outputSchema),e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function u0(i,e={}){const t=[],n=new Set;for(const s of i){const o=s.name;if(n.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);n.add(o);const l=l0(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function Ag(i,e){let t;if(typeof e=="string")if(i.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(i.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const n=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(i.isVertexAI()){if(s>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function c0(i){if(typeof i!="string")return i;const e=i;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function wg(i){if(typeof i!="object"||i===null)return{};const e=i,t=e.inlinedResponses;if(typeof t!="object"||t===null)return i;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return i;let o=!1;for(const l of s){if(typeof l!="object"||l===null)continue;const d=l.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),i}function as(i,e){const t=e;if(!i.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Sg(i){const e=i;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function d0(i){const e={},t=f(i,["responsesFile"]);t!=null&&g(e,["fileName"],t);const n=f(i,["inlinedResponses","inlinedResponses"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>G0(l))),g(e,["inlinedResponses"],o)}const s=f(i,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["inlinedEmbedContentResponses"],o)}return e}function h0(i){const e={},t=f(i,["predictionsFormat"]);t!=null&&g(e,["format"],t);const n=f(i,["gcsDestination","outputUriPrefix"]);n!=null&&g(e,["gcsUri"],n);const s=f(i,["bigqueryDestination","outputUri"]);return s!=null&&g(e,["bigqueryUri"],s),e}function f0(i){const e={},t=f(i,["format"]);t!=null&&g(e,["predictionsFormat"],t);const n=f(i,["gcsUri"]);n!=null&&g(e,["gcsDestination","outputUriPrefix"],n);const s=f(i,["bigqueryUri"]);if(s!=null&&g(e,["bigqueryDestination","outputUri"],s),f(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(i,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(i,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function No(i){const e={},t=f(i,["name"]);t!=null&&g(e,["name"],t);const n=f(i,["metadata","displayName"]);n!=null&&g(e,["displayName"],n);const s=f(i,["metadata","state"]);s!=null&&g(e,["state"],Sg(s));const o=f(i,["metadata","createTime"]);o!=null&&g(e,["createTime"],o);const l=f(i,["metadata","endTime"]);l!=null&&g(e,["endTime"],l);const u=f(i,["metadata","updateTime"]);u!=null&&g(e,["updateTime"],u);const d=f(i,["metadata","model"]);d!=null&&g(e,["model"],d);const h=f(i,["metadata","output"]);return h!=null&&g(e,["dest"],d0(wg(h))),e}function Eu(i){const e={},t=f(i,["name"]);t!=null&&g(e,["name"],t);const n=f(i,["displayName"]);n!=null&&g(e,["displayName"],n);const s=f(i,["state"]);s!=null&&g(e,["state"],Sg(s));const o=f(i,["error"]);o!=null&&g(e,["error"],o);const l=f(i,["createTime"]);l!=null&&g(e,["createTime"],l);const u=f(i,["startTime"]);u!=null&&g(e,["startTime"],u);const d=f(i,["endTime"]);d!=null&&g(e,["endTime"],d);const h=f(i,["updateTime"]);h!=null&&g(e,["updateTime"],h);const p=f(i,["model"]);p!=null&&g(e,["model"],p);const v=f(i,["inputConfig"]);v!=null&&g(e,["src"],p0(v));const y=f(i,["outputConfig"]);return y!=null&&g(e,["dest"],h0(wg(y))),e}function p0(i){const e={},t=f(i,["instancesFormat"]);t!=null&&g(e,["format"],t);const n=f(i,["gcsSource","uris"]);n!=null&&g(e,["gcsUri"],n);const s=f(i,["bigquerySource","inputUri"]);return s!=null&&g(e,["bigqueryUri"],s),e}function g0(i,e){const t={};if(f(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=f(e,["fileName"]);n!=null&&g(t,["fileName"],n);const s=f(e,["inlinedRequests"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>V0(i,l))),g(t,["requests","requests"],o)}return t}function m0(i){const e={},t=f(i,["format"]);t!=null&&g(e,["instancesFormat"],t);const n=f(i,["gcsUri"]);n!=null&&g(e,["gcsSource","uris"],n);const s=f(i,["bigqueryUri"]);if(s!=null&&g(e,["bigquerySource","inputUri"],s),f(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(i,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function v0(i){const e={},t=f(i,["data"]);if(t!=null&&g(e,["data"],t),f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function y0(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],as(i,n)),t}function _0(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],as(i,n)),t}function E0(i){const e={},t=f(i,["content"]);t!=null&&g(e,["content"],t);const n=f(i,["citationMetadata"]);n!=null&&g(e,["citationMetadata"],A0(n));const s=f(i,["tokenCount"]);s!=null&&g(e,["tokenCount"],s);const o=f(i,["finishReason"]);o!=null&&g(e,["finishReason"],o);const l=f(i,["avgLogprobs"]);l!=null&&g(e,["avgLogprobs"],l);const u=f(i,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);const d=f(i,["index"]);d!=null&&g(e,["index"],d);const h=f(i,["logprobsResult"]);h!=null&&g(e,["logprobsResult"],h);const p=f(i,["safetyRatings"]);if(p!=null){let y=p;Array.isArray(y)&&(y=y.map(A=>A)),g(e,["safetyRatings"],y)}const v=f(i,["urlContextMetadata"]);return v!=null&&g(e,["urlContextMetadata"],v),e}function A0(i){const e={},t=f(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),g(e,["citations"],n)}return e}function Cg(i){const e={},t=f(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>J0(o))),g(e,["parts"],s)}const n=f(i,["role"]);return n!=null&&g(e,["role"],n),e}function w0(i,e){const t={},n=f(i,["displayName"]);if(e!==void 0&&n!=null&&g(e,["batch","displayName"],n),f(i,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function S0(i,e){const t={},n=f(i,["displayName"]);e!==void 0&&n!=null&&g(e,["displayName"],n);const s=f(i,["dest"]);return e!==void 0&&s!=null&&g(e,["outputConfig"],f0(c0(s))),t}function Cp(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["src"]);s!=null&&g(t,["batch","inputConfig"],g0(i,Ag(i,s)));const o=f(e,["config"]);return o!=null&&w0(o,t),t}function C0(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["model"],Re(i,n));const s=f(e,["src"]);s!=null&&g(t,["inputConfig"],m0(Ag(i,s)));const o=f(e,["config"]);return o!=null&&S0(o,t),t}function T0(i,e){const t={},n=f(i,["displayName"]);return e!==void 0&&n!=null&&g(e,["batch","displayName"],n),t}function x0(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["src"]);s!=null&&g(t,["batch","inputConfig"],N0(i,s));const o=f(e,["config"]);return o!=null&&T0(o,t),t}function k0(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],as(i,n)),t}function I0(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],as(i,n)),t}function R0(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["name"]);n!=null&&g(e,["name"],n);const s=f(i,["done"]);s!=null&&g(e,["done"],s);const o=f(i,["error"]);return o!=null&&g(e,["error"],o),e}function b0(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["name"]);n!=null&&g(e,["name"],n);const s=f(i,["done"]);s!=null&&g(e,["done"],s);const o=f(i,["error"]);return o!=null&&g(e,["error"],o),e}function P0(i,e){const t={},n=f(e,["contents"]);if(n!=null){let o=Ou(i,n);Array.isArray(o)&&(o=o.map(l=>l)),g(t,["requests[]","request","content"],o)}const s=f(e,["config"]);return s!=null&&(g(t,["_self"],M0(s,t)),Ly(t,{"requests[].*":"requests[].request.*"})),t}function M0(i,e){const t={},n=f(i,["taskType"]);e!==void 0&&n!=null&&g(e,["requests[]","taskType"],n);const s=f(i,["title"]);e!==void 0&&s!=null&&g(e,["requests[]","title"],s);const o=f(i,["outputDimensionality"]);if(e!==void 0&&o!=null&&g(e,["requests[]","outputDimensionality"],o),f(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function N0(i,e){const t={},n=f(e,["fileName"]);n!=null&&g(t,["file_name"],n);const s=f(e,["inlinedRequests"]);return s!=null&&g(t,["requests"],P0(i,s)),t}function L0(i){const e={};if(f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(i,["fileUri"]);t!=null&&g(e,["fileUri"],t);const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function D0(i,e,t){const n={},s=f(e,["systemInstruction"]);t!==void 0&&s!=null&&g(t,["systemInstruction"],Cg(gt(s)));const o=f(e,["temperature"]);o!=null&&g(n,["temperature"],o);const l=f(e,["topP"]);l!=null&&g(n,["topP"],l);const u=f(e,["topK"]);u!=null&&g(n,["topK"],u);const d=f(e,["candidateCount"]);d!=null&&g(n,["candidateCount"],d);const h=f(e,["maxOutputTokens"]);h!=null&&g(n,["maxOutputTokens"],h);const p=f(e,["stopSequences"]);p!=null&&g(n,["stopSequences"],p);const v=f(e,["responseLogprobs"]);v!=null&&g(n,["responseLogprobs"],v);const y=f(e,["logprobs"]);y!=null&&g(n,["logprobs"],y);const A=f(e,["presencePenalty"]);A!=null&&g(n,["presencePenalty"],A);const w=f(e,["frequencyPenalty"]);w!=null&&g(n,["frequencyPenalty"],w);const C=f(e,["seed"]);C!=null&&g(n,["seed"],C);const T=f(e,["responseMimeType"]);T!=null&&g(n,["responseMimeType"],T);const x=f(e,["responseSchema"]);x!=null&&g(n,["responseSchema"],Vu(x));const I=f(e,["responseJsonSchema"]);if(I!=null&&g(n,["responseJsonSchema"],I),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=f(e,["safetySettings"]);if(t!==void 0&&P!=null){let le=P;Array.isArray(le)&&(le=le.map(ge=>X0(ge))),g(t,["safetySettings"],le)}const M=f(e,["tools"]);if(t!==void 0&&M!=null){let le=os(M);Array.isArray(le)&&(le=le.map(ge=>Q0(rs(ge)))),g(t,["tools"],le)}const F=f(e,["toolConfig"]);if(t!==void 0&&F!=null&&g(t,["toolConfig"],F),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=f(e,["cachedContent"]);t!==void 0&&H!=null&&g(t,["cachedContent"],Pn(i,H));const O=f(e,["responseModalities"]);O!=null&&g(n,["responseModalities"],O);const K=f(e,["mediaResolution"]);K!=null&&g(n,["mediaResolution"],K);const q=f(e,["speechConfig"]);if(q!=null&&g(n,["speechConfig"],Gu(q)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const J=f(e,["thinkingConfig"]);J!=null&&g(n,["thinkingConfig"],J);const j=f(e,["imageConfig"]);return j!=null&&g(n,["imageConfig"],j),n}function F0(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>E0(h))),g(e,["candidates"],d)}const s=f(i,["modelVersion"]);s!=null&&g(e,["modelVersion"],s);const o=f(i,["promptFeedback"]);o!=null&&g(e,["promptFeedback"],o);const l=f(i,["responseId"]);l!=null&&g(e,["responseId"],l);const u=f(i,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function U0(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],as(i,n)),t}function H0(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],as(i,n)),t}function B0(i){const e={};if(f(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(i,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function O0(i){const e={};if(f(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const t=f(i,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function V0(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["request","model"],Re(i,n));const s=f(e,["contents"]);if(s!=null){let u=Yt(s);Array.isArray(u)&&(u=u.map(d=>Cg(d))),g(t,["request","contents"],u)}const o=f(e,["metadata"]);o!=null&&g(t,["metadata"],o);const l=f(e,["config"]);return l!=null&&g(t,["request","generationConfig"],D0(i,l,f(t,["request"],{}))),t}function G0(i){const e={},t=f(i,["response"]);t!=null&&g(e,["response"],F0(t));const n=f(i,["error"]);return n!=null&&g(e,["error"],n),e}function z0(i,e){const t={},n=f(i,["pageSize"]);e!==void 0&&n!=null&&g(e,["_query","pageSize"],n);const s=f(i,["pageToken"]);if(e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),f(i,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function q0(i,e){const t={},n=f(i,["pageSize"]);e!==void 0&&n!=null&&g(e,["_query","pageSize"],n);const s=f(i,["pageToken"]);e!==void 0&&s!=null&&g(e,["_query","pageToken"],s);const o=f(i,["filter"]);return e!==void 0&&o!=null&&g(e,["_query","filter"],o),t}function $0(i){const e={},t=f(i,["config"]);return t!=null&&z0(t,e),e}function W0(i){const e={},t=f(i,["config"]);return t!=null&&q0(t,e),e}function Y0(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["nextPageToken"]);n!=null&&g(e,["nextPageToken"],n);const s=f(i,["operations"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>No(l))),g(e,["batchJobs"],o)}return e}function K0(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["nextPageToken"]);n!=null&&g(e,["nextPageToken"],n);const s=f(i,["batchPredictionJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>Eu(l))),g(e,["batchJobs"],o)}return e}function J0(i){const e={},t=f(i,["functionCall"]);t!=null&&g(e,["functionCall"],t);const n=f(i,["codeExecutionResult"]);n!=null&&g(e,["codeExecutionResult"],n);const s=f(i,["executableCode"]);s!=null&&g(e,["executableCode"],s);const o=f(i,["fileData"]);o!=null&&g(e,["fileData"],L0(o));const l=f(i,["functionResponse"]);l!=null&&g(e,["functionResponse"],l);const u=f(i,["inlineData"]);u!=null&&g(e,["inlineData"],v0(u));const d=f(i,["text"]);d!=null&&g(e,["text"],d);const h=f(i,["thought"]);h!=null&&g(e,["thought"],h);const p=f(i,["thoughtSignature"]);p!=null&&g(e,["thoughtSignature"],p);const v=f(i,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function X0(i){const e={},t=f(i,["category"]);if(t!=null&&g(e,["category"],t),f(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(i,["threshold"]);return n!=null&&g(e,["threshold"],n),e}function Q0(i){const e={},t=f(i,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),g(e,["functionDeclarations"],h)}if(f(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=f(i,["googleSearchRetrieval"]);n!=null&&g(e,["googleSearchRetrieval"],n);const s=f(i,["googleMaps"]);s!=null&&g(e,["googleMaps"],B0(s));const o=f(i,["computerUse"]);o!=null&&g(e,["computerUse"],o);const l=f(i,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),f(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=f(i,["googleSearch"]);u!=null&&g(e,["googleSearch"],O0(u));const d=f(i,["urlContext"]);return d!=null&&g(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var yi;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents",i.PAGED_ITEM_RAG_STORES="ragStores",i.PAGED_ITEM_DOCUMENTS="documents"})(yi||(yi={}));class lr{constructor(e,t,n,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,s)}init(e,t,n){var s,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Z0 extends wi{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new lr(yi.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=Cp(this.apiClient,e),n=t._url,s=ne("{model}:batchGenerateContent",n),u=t.batch.inputConfig.requests,d=u.requests,h=[];for(const p of d){const v=Object.assign({},p);if(v.systemInstruction){const y=v.systemInstruction;delete v.systemInstruction;const A=v.request;A.systemInstruction=y,v.request=A}h.push(v)}return u.requests=h,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},s=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${s}`),n.dest===void 0){const o=this.getGcsUri(e),l=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?n.dest=`${o.slice(0,-6)}/dest`:n.dest=`${o}_dest_${s}`;else if(l)n.dest=`${l}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=C0(this.apiClient,e);return u=ne("batchPredictionJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Eu(p))}else{const h=Cp(this.apiClient,e);return u=ne("{model}:batchGenerateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>No(p))}}async createEmbeddingsInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=x0(this.apiClient,e);return o=ne("{model}:asyncBatchEmbedContent",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>No(d))}}async get(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=H0(this.apiClient,e);return u=ne("batchPredictionJobs/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Eu(p))}else{const h=U0(this.apiClient,e);return u=ne("batches/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>No(p))}}async cancel(e){var t,n,s,o;let l="",u={};if(this.apiClient.isVertexAI()){const d=_0(this.apiClient,e);l=ne("batchPredictionJobs/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const d=y0(this.apiClient,e);l=ne("batches/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=W0(e);return u=ne("batchPredictionJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=K0(p),y=new Ep;return Object.assign(y,v),y})}else{const h=$0(e);return u=ne("batches",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=Y0(p),y=new Ep;return Object.assign(y,v),y})}}async delete(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=I0(this.apiClient,e);return u=ne("batchPredictionJobs/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>b0(p))}else{const h=k0(this.apiClient,e);return u=ne("batches/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>R0(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function j0(i){const e={},t=f(i,["data"]);if(t!=null&&g(e,["data"],t),f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function Tp(i){const e={},t=f(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>E_(o))),g(e,["parts"],s)}const n=f(i,["role"]);return n!=null&&g(e,["role"],n),e}function e_(i,e){const t={},n=f(i,["ttl"]);e!==void 0&&n!=null&&g(e,["ttl"],n);const s=f(i,["expireTime"]);e!==void 0&&s!=null&&g(e,["expireTime"],s);const o=f(i,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);const l=f(i,["contents"]);if(e!==void 0&&l!=null){let p=Yt(l);Array.isArray(p)&&(p=p.map(v=>Tp(v))),g(e,["contents"],p)}const u=f(i,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],Tp(gt(u)));const d=f(i,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(v=>A_(v))),g(e,["tools"],p)}const h=f(i,["toolConfig"]);if(e!==void 0&&h!=null&&g(e,["toolConfig"],h),f(i,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function t_(i,e){const t={},n=f(i,["ttl"]);e!==void 0&&n!=null&&g(e,["ttl"],n);const s=f(i,["expireTime"]);e!==void 0&&s!=null&&g(e,["expireTime"],s);const o=f(i,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);const l=f(i,["contents"]);if(e!==void 0&&l!=null){let v=Yt(l);Array.isArray(v)&&(v=v.map(y=>y)),g(e,["contents"],v)}const u=f(i,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],gt(u));const d=f(i,["tools"]);if(e!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(y=>w_(y))),g(e,["tools"],v)}const h=f(i,["toolConfig"]);e!==void 0&&h!=null&&g(e,["toolConfig"],h);const p=f(i,["kmsKeyName"]);return e!==void 0&&p!=null&&g(e,["encryption_spec","kmsKeyName"],p),t}function n_(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["model"],hg(i,n));const s=f(e,["config"]);return s!=null&&e_(s,t),t}function i_(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["model"],hg(i,n));const s=f(e,["config"]);return s!=null&&t_(s,t),t}function s_(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],Pn(i,n)),t}function r_(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],Pn(i,n)),t}function o_(i){const e={},t=f(i,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function a_(i){const e={},t=f(i,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function l_(i){const e={};if(f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(i,["fileUri"]);t!=null&&g(e,["fileUri"],t);const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function u_(i){const e={};if(f(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(i,["description"]);t!=null&&g(e,["description"],t);const n=f(i,["name"]);n!=null&&g(e,["name"],n);const s=f(i,["parameters"]);s!=null&&g(e,["parameters"],s);const o=f(i,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);const l=f(i,["response"]);l!=null&&g(e,["response"],l);const u=f(i,["responseJsonSchema"]);return u!=null&&g(e,["responseJsonSchema"],u),e}function c_(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],Pn(i,n)),t}function d_(i,e){const t={},n=f(e,["name"]);return n!=null&&g(t,["_url","name"],Pn(i,n)),t}function h_(i){const e={};if(f(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(i,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function f_(i){const e={};if(f(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const t=f(i,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function p_(i,e){const t={},n=f(i,["pageSize"]);e!==void 0&&n!=null&&g(e,["_query","pageSize"],n);const s=f(i,["pageToken"]);return e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),t}function g_(i,e){const t={},n=f(i,["pageSize"]);e!==void 0&&n!=null&&g(e,["_query","pageSize"],n);const s=f(i,["pageToken"]);return e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),t}function m_(i){const e={},t=f(i,["config"]);return t!=null&&p_(t,e),e}function v_(i){const e={},t=f(i,["config"]);return t!=null&&g_(t,e),e}function y_(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["nextPageToken"]);n!=null&&g(e,["nextPageToken"],n);const s=f(i,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["cachedContents"],o)}return e}function __(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["nextPageToken"]);n!=null&&g(e,["nextPageToken"],n);const s=f(i,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["cachedContents"],o)}return e}function E_(i){const e={},t=f(i,["functionCall"]);t!=null&&g(e,["functionCall"],t);const n=f(i,["codeExecutionResult"]);n!=null&&g(e,["codeExecutionResult"],n);const s=f(i,["executableCode"]);s!=null&&g(e,["executableCode"],s);const o=f(i,["fileData"]);o!=null&&g(e,["fileData"],l_(o));const l=f(i,["functionResponse"]);l!=null&&g(e,["functionResponse"],l);const u=f(i,["inlineData"]);u!=null&&g(e,["inlineData"],j0(u));const d=f(i,["text"]);d!=null&&g(e,["text"],d);const h=f(i,["thought"]);h!=null&&g(e,["thought"],h);const p=f(i,["thoughtSignature"]);p!=null&&g(e,["thoughtSignature"],p);const v=f(i,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function A_(i){const e={},t=f(i,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),g(e,["functionDeclarations"],h)}if(f(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=f(i,["googleSearchRetrieval"]);n!=null&&g(e,["googleSearchRetrieval"],n);const s=f(i,["googleMaps"]);s!=null&&g(e,["googleMaps"],h_(s));const o=f(i,["computerUse"]);o!=null&&g(e,["computerUse"],o);const l=f(i,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),f(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=f(i,["googleSearch"]);u!=null&&g(e,["googleSearch"],f_(u));const d=f(i,["urlContext"]);return d!=null&&g(e,["urlContext"],d),e}function w_(i){const e={},t=f(i,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(y=>u_(y))),g(e,["functionDeclarations"],v)}const n=f(i,["retrieval"]);n!=null&&g(e,["retrieval"],n);const s=f(i,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const o=f(i,["googleMaps"]);o!=null&&g(e,["googleMaps"],o);const l=f(i,["computerUse"]);l!=null&&g(e,["computerUse"],l);const u=f(i,["codeExecution"]);u!=null&&g(e,["codeExecution"],u);const d=f(i,["enterpriseWebSearch"]);d!=null&&g(e,["enterpriseWebSearch"],d);const h=f(i,["googleSearch"]);h!=null&&g(e,["googleSearch"],h);const p=f(i,["urlContext"]);return p!=null&&g(e,["urlContext"],p),e}function S_(i,e){const t={},n=f(i,["ttl"]);e!==void 0&&n!=null&&g(e,["ttl"],n);const s=f(i,["expireTime"]);return e!==void 0&&s!=null&&g(e,["expireTime"],s),t}function C_(i,e){const t={},n=f(i,["ttl"]);e!==void 0&&n!=null&&g(e,["ttl"],n);const s=f(i,["expireTime"]);return e!==void 0&&s!=null&&g(e,["expireTime"],s),t}function T_(i,e){const t={},n=f(e,["name"]);n!=null&&g(t,["_url","name"],Pn(i,n));const s=f(e,["config"]);return s!=null&&S_(s,t),t}function x_(i,e){const t={},n=f(e,["name"]);n!=null&&g(t,["_url","name"],Pn(i,n));const s=f(e,["config"]);return s!=null&&C_(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k_ extends wi{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new lr(yi.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=i_(this.apiClient,e);return u=ne("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=n_(this.apiClient,e);return u=ne("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async get(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=d_(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=c_(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async delete(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=r_(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=a_(p),y=new yp;return Object.assign(y,v),y})}else{const h=s_(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=o_(p),y=new yp;return Object.assign(y,v),y})}}async update(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=x_(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=T_(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async listInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=v_(e);return u=ne("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=__(p),y=new _p;return Object.assign(y,v),y})}else{const h=m_(e);return u=ne("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=y_(p),y=new _p;return Object.assign(y,v),y})}}}function xp(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Be(i){return this instanceof Be?(this.v=i,this):new Be(i)}function ts(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(A){return function(w){return Promise.resolve(w).then(A,v)}}function u(A,w){n[A]&&(s[A]=function(C){return new Promise(function(T,x){o.push([A,C,T,x])>1||d(A,C)})},w&&(s[A]=w(s[A])))}function d(A,w){try{h(n[A](w))}catch(C){y(o[0][3],C)}}function h(A){A.value instanceof Be?Promise.resolve(A.value.v).then(p,v):y(o[0][2],A)}function p(A){d("next",A)}function v(A){d("throw",A)}function y(A,w){A(w),o.shift(),o.length&&d(o[0][0],o[0][1])}}function ir(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof xp=="function"?xp(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=i[o]&&function(l){return new Promise(function(u,d){l=i[o](l),s(u,d,l.done,l.value)})}}function s(o,l,u,d){Promise.resolve(d).then(function(h){o({value:h,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I_(i){var e;if(i.candidates==null||i.candidates.length===0)return!1;const t=(e=i.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:Tg(t)}function Tg(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const e of i.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function R_(i){if(i.length!==0){for(const e of i)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function kp(i){if(i===void 0||i.length===0)return[];const e=[],t=i.length;let n=0;for(;n<t;)if(i[n].role==="user")e.push(i[n]),n++;else{const s=[];let o=!0;for(;n<t&&i[n].role==="model";)s.push(i[n]),o&&!Tg(i[n])&&(o=!1),n++;o?e.push(...s):e.pop()}return e}class b_{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new P_(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class P_{constructor(e,t,n,s={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=s,this.history=o,this.sendPromise=Promise.resolve(),R_(o)}async sendMessage(e){var t;await this.sendPromise;const n=gt(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l,u;const d=await s,h=(l=(o=d.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,p=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let y=[];p!=null&&(y=(u=p.slice(v))!==null&&u!==void 0?u:[]);const A=h?[h]:[];this.recordHistory(n,A,y)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const n=gt(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const o=await s;return this.processStreamResponse(o,n)}getHistory(e=!1){const t=e?kp(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var n,s;return ts(this,arguments,function*(){var l,u,d,h;const p=[];try{for(var v=!0,y=ir(e),A;A=yield Be(y.next()),l=A.done,!l;v=!0){h=A.value,v=!1;const w=h;if(I_(w)){const C=(s=(n=w.candidates)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.content;C!==void 0&&p.push(C)}yield yield Be(w)}}catch(w){u={error:w}}finally{try{!v&&!l&&(d=y.return)&&(yield Be(d.call(y)))}finally{if(u)throw u.error}}this.recordHistory(t,p)})}recordHistory(e,t,n){let s=[];t.length>0&&t.every(o=>o.role!==void 0)?s=t:s.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...kp(n)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $o extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,$o.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function M_(i){const e={},t=f(i,["file"]);return t!=null&&g(e,["file"],t),e}function N_(i){const e={},t=f(i,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function L_(i){const e={},t=f(i,["name"]);return t!=null&&g(e,["_url","file"],yg(t)),e}function D_(i){const e={},t=f(i,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function F_(i){const e={},t=f(i,["name"]);return t!=null&&g(e,["_url","file"],yg(t)),e}function U_(i,e){const t={},n=f(i,["pageSize"]);e!==void 0&&n!=null&&g(e,["_query","pageSize"],n);const s=f(i,["pageToken"]);return e!==void 0&&s!=null&&g(e,["_query","pageToken"],s),t}function H_(i){const e={},t=f(i,["config"]);return t!=null&&U_(t,e),e}function B_(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["nextPageToken"]);n!=null&&g(e,["nextPageToken"],n);const s=f(i,["files"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class O_ extends wi{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new lr(yi.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=H_(e);return o=ne("files",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=B_(d),p=new Qy;return Object.assign(p,h),p})}}async createInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=M_(e);return o=ne("upload/v1beta/files",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=N_(d),p=new Zy;return Object.assign(p,h),p})}}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=F_(e);return o=ne("files/{file}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>d)}}async delete(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=L_(e);return o=ne("files/{file}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=D_(d),p=new jy;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lo(i){const e={},t=f(i,["data"]);if(t!=null&&g(e,["data"],t),f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function V_(i){const e={},t=f(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>nE(o))),g(e,["parts"],s)}const n=f(i,["role"]);return n!=null&&g(e,["role"],n),e}function G_(i){const e={};if(f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(i,["fileUri"]);t!=null&&g(e,["fileUri"],t);const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function z_(i){const e={};if(f(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(i,["description"]);t!=null&&g(e,["description"],t);const n=f(i,["name"]);n!=null&&g(e,["name"],n);const s=f(i,["parameters"]);s!=null&&g(e,["parameters"],s);const o=f(i,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);const l=f(i,["response"]);l!=null&&g(e,["response"],l);const u=f(i,["responseJsonSchema"]);return u!=null&&g(e,["responseJsonSchema"],u),e}function q_(i){const e={},t=f(i,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const n=f(i,["audioTimestamp"]);n!=null&&g(e,["audioTimestamp"],n);const s=f(i,["candidateCount"]);s!=null&&g(e,["candidateCount"],s);const o=f(i,["enableAffectiveDialog"]);o!=null&&g(e,["enableAffectiveDialog"],o);const l=f(i,["frequencyPenalty"]);l!=null&&g(e,["frequencyPenalty"],l);const u=f(i,["logprobs"]);u!=null&&g(e,["logprobs"],u);const d=f(i,["maxOutputTokens"]);d!=null&&g(e,["maxOutputTokens"],d);const h=f(i,["mediaResolution"]);h!=null&&g(e,["mediaResolution"],h);const p=f(i,["presencePenalty"]);p!=null&&g(e,["presencePenalty"],p);const v=f(i,["responseJsonSchema"]);v!=null&&g(e,["responseJsonSchema"],v);const y=f(i,["responseLogprobs"]);y!=null&&g(e,["responseLogprobs"],y);const A=f(i,["responseMimeType"]);A!=null&&g(e,["responseMimeType"],A);const w=f(i,["responseModalities"]);w!=null&&g(e,["responseModalities"],w);const C=f(i,["responseSchema"]);C!=null&&g(e,["responseSchema"],C);const T=f(i,["routingConfig"]);T!=null&&g(e,["routingConfig"],T);const x=f(i,["seed"]);x!=null&&g(e,["seed"],x);const I=f(i,["speechConfig"]);I!=null&&g(e,["speechConfig"],xg(I));const P=f(i,["stopSequences"]);P!=null&&g(e,["stopSequences"],P);const M=f(i,["temperature"]);M!=null&&g(e,["temperature"],M);const F=f(i,["thinkingConfig"]);F!=null&&g(e,["thinkingConfig"],F);const H=f(i,["topK"]);H!=null&&g(e,["topK"],H);const O=f(i,["topP"]);if(O!=null&&g(e,["topP"],O),f(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function $_(i){const e={};if(f(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(i,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function W_(i){const e={};if(f(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const t=f(i,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function Y_(i,e){const t={},n=f(i,["generationConfig"]);e!==void 0&&n!=null&&g(e,["setup","generationConfig"],n);const s=f(i,["responseModalities"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig","responseModalities"],s);const o=f(i,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);const l=f(i,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const u=f(i,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);const d=f(i,["maxOutputTokens"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","maxOutputTokens"],d);const h=f(i,["mediaResolution"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","mediaResolution"],h);const p=f(i,["seed"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","seed"],p);const v=f(i,["speechConfig"]);e!==void 0&&v!=null&&g(e,["setup","generationConfig","speechConfig"],zu(v));const y=f(i,["thinkingConfig"]);e!==void 0&&y!=null&&g(e,["setup","generationConfig","thinkingConfig"],y);const A=f(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=f(i,["systemInstruction"]);e!==void 0&&w!=null&&g(e,["setup","systemInstruction"],V_(gt(w)));const C=f(i,["tools"]);if(e!==void 0&&C!=null){let H=os(C);Array.isArray(H)&&(H=H.map(O=>sE(rs(O)))),g(e,["setup","tools"],H)}const T=f(i,["sessionResumption"]);e!==void 0&&T!=null&&g(e,["setup","sessionResumption"],iE(T));const x=f(i,["inputAudioTranscription"]);e!==void 0&&x!=null&&g(e,["setup","inputAudioTranscription"],x);const I=f(i,["outputAudioTranscription"]);e!==void 0&&I!=null&&g(e,["setup","outputAudioTranscription"],I);const P=f(i,["realtimeInputConfig"]);e!==void 0&&P!=null&&g(e,["setup","realtimeInputConfig"],P);const M=f(i,["contextWindowCompression"]);e!==void 0&&M!=null&&g(e,["setup","contextWindowCompression"],M);const F=f(i,["proactivity"]);return e!==void 0&&F!=null&&g(e,["setup","proactivity"],F),t}function K_(i,e){const t={},n=f(i,["generationConfig"]);e!==void 0&&n!=null&&g(e,["setup","generationConfig"],q_(n));const s=f(i,["responseModalities"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig","responseModalities"],s);const o=f(i,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);const l=f(i,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const u=f(i,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);const d=f(i,["maxOutputTokens"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","maxOutputTokens"],d);const h=f(i,["mediaResolution"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","mediaResolution"],h);const p=f(i,["seed"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","seed"],p);const v=f(i,["speechConfig"]);e!==void 0&&v!=null&&g(e,["setup","generationConfig","speechConfig"],xg(zu(v)));const y=f(i,["thinkingConfig"]);e!==void 0&&y!=null&&g(e,["setup","generationConfig","thinkingConfig"],y);const A=f(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=f(i,["systemInstruction"]);e!==void 0&&w!=null&&g(e,["setup","systemInstruction"],gt(w));const C=f(i,["tools"]);if(e!==void 0&&C!=null){let H=os(C);Array.isArray(H)&&(H=H.map(O=>rE(rs(O)))),g(e,["setup","tools"],H)}const T=f(i,["sessionResumption"]);e!==void 0&&T!=null&&g(e,["setup","sessionResumption"],T);const x=f(i,["inputAudioTranscription"]);e!==void 0&&x!=null&&g(e,["setup","inputAudioTranscription"],x);const I=f(i,["outputAudioTranscription"]);e!==void 0&&I!=null&&g(e,["setup","outputAudioTranscription"],I);const P=f(i,["realtimeInputConfig"]);e!==void 0&&P!=null&&g(e,["setup","realtimeInputConfig"],P);const M=f(i,["contextWindowCompression"]);e!==void 0&&M!=null&&g(e,["setup","contextWindowCompression"],M);const F=f(i,["proactivity"]);return e!==void 0&&F!=null&&g(e,["setup","proactivity"],F),t}function J_(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["setup","model"],Re(i,n));const s=f(e,["config"]);return s!=null&&g(t,["config"],Y_(s,t)),t}function X_(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["setup","model"],Re(i,n));const s=f(e,["config"]);return s!=null&&g(t,["config"],K_(s,t)),t}function Q_(i){const e={},t=f(i,["musicGenerationConfig"]);return t!=null&&g(e,["musicGenerationConfig"],t),e}function Z_(i){const e={},t=f(i,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),g(e,["weightedPrompts"],n)}return e}function j_(i){const e={},t=f(i,["media"]);if(t!=null){let h=fg(t);Array.isArray(h)&&(h=h.map(p=>Lo(p))),g(e,["mediaChunks"],h)}const n=f(i,["audio"]);n!=null&&g(e,["audio"],Lo(gg(n)));const s=f(i,["audioStreamEnd"]);s!=null&&g(e,["audioStreamEnd"],s);const o=f(i,["video"]);o!=null&&g(e,["video"],Lo(pg(o)));const l=f(i,["text"]);l!=null&&g(e,["text"],l);const u=f(i,["activityStart"]);u!=null&&g(e,["activityStart"],u);const d=f(i,["activityEnd"]);return d!=null&&g(e,["activityEnd"],d),e}function eE(i){const e={},t=f(i,["media"]);if(t!=null){let h=fg(t);Array.isArray(h)&&(h=h.map(p=>p)),g(e,["mediaChunks"],h)}const n=f(i,["audio"]);n!=null&&g(e,["audio"],gg(n));const s=f(i,["audioStreamEnd"]);s!=null&&g(e,["audioStreamEnd"],s);const o=f(i,["video"]);o!=null&&g(e,["video"],pg(o));const l=f(i,["text"]);l!=null&&g(e,["text"],l);const u=f(i,["activityStart"]);u!=null&&g(e,["activityStart"],u);const d=f(i,["activityEnd"]);return d!=null&&g(e,["activityEnd"],d),e}function tE(i){const e={},t=f(i,["setupComplete"]);t!=null&&g(e,["setupComplete"],t);const n=f(i,["serverContent"]);n!=null&&g(e,["serverContent"],n);const s=f(i,["toolCall"]);s!=null&&g(e,["toolCall"],s);const o=f(i,["toolCallCancellation"]);o!=null&&g(e,["toolCallCancellation"],o);const l=f(i,["usageMetadata"]);l!=null&&g(e,["usageMetadata"],oE(l));const u=f(i,["goAway"]);u!=null&&g(e,["goAway"],u);const d=f(i,["sessionResumptionUpdate"]);return d!=null&&g(e,["sessionResumptionUpdate"],d),e}function nE(i){const e={},t=f(i,["functionCall"]);t!=null&&g(e,["functionCall"],t);const n=f(i,["codeExecutionResult"]);n!=null&&g(e,["codeExecutionResult"],n);const s=f(i,["executableCode"]);s!=null&&g(e,["executableCode"],s);const o=f(i,["fileData"]);o!=null&&g(e,["fileData"],G_(o));const l=f(i,["functionResponse"]);l!=null&&g(e,["functionResponse"],l);const u=f(i,["inlineData"]);u!=null&&g(e,["inlineData"],Lo(u));const d=f(i,["text"]);d!=null&&g(e,["text"],d);const h=f(i,["thought"]);h!=null&&g(e,["thought"],h);const p=f(i,["thoughtSignature"]);p!=null&&g(e,["thoughtSignature"],p);const v=f(i,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function iE(i){const e={},t=f(i,["handle"]);if(t!=null&&g(e,["handle"],t),f(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function xg(i){const e={},t=f(i,["languageCode"]);t!=null&&g(e,["languageCode"],t);const n=f(i,["voiceConfig"]);if(n!=null&&g(e,["voiceConfig"],n),f(i,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function sE(i){const e={},t=f(i,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),g(e,["functionDeclarations"],h)}if(f(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=f(i,["googleSearchRetrieval"]);n!=null&&g(e,["googleSearchRetrieval"],n);const s=f(i,["googleMaps"]);s!=null&&g(e,["googleMaps"],$_(s));const o=f(i,["computerUse"]);o!=null&&g(e,["computerUse"],o);const l=f(i,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),f(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=f(i,["googleSearch"]);u!=null&&g(e,["googleSearch"],W_(u));const d=f(i,["urlContext"]);return d!=null&&g(e,["urlContext"],d),e}function rE(i){const e={},t=f(i,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(y=>z_(y))),g(e,["functionDeclarations"],v)}const n=f(i,["retrieval"]);n!=null&&g(e,["retrieval"],n);const s=f(i,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const o=f(i,["googleMaps"]);o!=null&&g(e,["googleMaps"],o);const l=f(i,["computerUse"]);l!=null&&g(e,["computerUse"],l);const u=f(i,["codeExecution"]);u!=null&&g(e,["codeExecution"],u);const d=f(i,["enterpriseWebSearch"]);d!=null&&g(e,["enterpriseWebSearch"],d);const h=f(i,["googleSearch"]);h!=null&&g(e,["googleSearch"],h);const p=f(i,["urlContext"]);return p!=null&&g(e,["urlContext"],p),e}function oE(i){const e={},t=f(i,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);const n=f(i,["cachedContentTokenCount"]);n!=null&&g(e,["cachedContentTokenCount"],n);const s=f(i,["candidatesTokenCount"]);s!=null&&g(e,["responseTokenCount"],s);const o=f(i,["toolUsePromptTokenCount"]);o!=null&&g(e,["toolUsePromptTokenCount"],o);const l=f(i,["thoughtsTokenCount"]);l!=null&&g(e,["thoughtsTokenCount"],l);const u=f(i,["totalTokenCount"]);u!=null&&g(e,["totalTokenCount"],u);const d=f(i,["promptTokensDetails"]);if(d!=null){let A=d;Array.isArray(A)&&(A=A.map(w=>w)),g(e,["promptTokensDetails"],A)}const h=f(i,["cacheTokensDetails"]);if(h!=null){let A=h;Array.isArray(A)&&(A=A.map(w=>w)),g(e,["cacheTokensDetails"],A)}const p=f(i,["candidatesTokensDetails"]);if(p!=null){let A=p;Array.isArray(A)&&(A=A.map(w=>w)),g(e,["responseTokensDetails"],A)}const v=f(i,["toolUsePromptTokensDetails"]);if(v!=null){let A=v;Array.isArray(A)&&(A=A.map(w=>w)),g(e,["toolUsePromptTokensDetails"],A)}const y=f(i,["trafficType"]);return y!=null&&g(e,["trafficType"],y),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aE(i){const e={},t=f(i,["data"]);if(t!=null&&g(e,["data"],t),f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function lE(i){const e={},t=f(i,["content"]);t!=null&&g(e,["content"],t);const n=f(i,["citationMetadata"]);n!=null&&g(e,["citationMetadata"],uE(n));const s=f(i,["tokenCount"]);s!=null&&g(e,["tokenCount"],s);const o=f(i,["finishReason"]);o!=null&&g(e,["finishReason"],o);const l=f(i,["avgLogprobs"]);l!=null&&g(e,["avgLogprobs"],l);const u=f(i,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);const d=f(i,["index"]);d!=null&&g(e,["index"],d);const h=f(i,["logprobsResult"]);h!=null&&g(e,["logprobsResult"],h);const p=f(i,["safetyRatings"]);if(p!=null){let y=p;Array.isArray(y)&&(y=y.map(A=>A)),g(e,["safetyRatings"],y)}const v=f(i,["urlContextMetadata"]);return v!=null&&g(e,["urlContextMetadata"],v),e}function uE(i){const e={},t=f(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),g(e,["citations"],n)}return e}function cE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["contents"]);if(s!=null){let o=Yt(s);Array.isArray(o)&&(o=o.map(l=>l)),g(t,["contents"],o)}return t}function dE(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["tokensInfo"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),g(e,["tokensInfo"],s)}return e}function hE(i){const e={},t=f(i,["values"]);t!=null&&g(e,["values"],t);const n=f(i,["statistics"]);return n!=null&&g(e,["statistics"],fE(n)),e}function fE(i){const e={},t=f(i,["truncated"]);t!=null&&g(e,["truncated"],t);const n=f(i,["token_count"]);return n!=null&&g(e,["tokenCount"],n),e}function Wo(i){const e={},t=f(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>yA(o))),g(e,["parts"],s)}const n=f(i,["role"]);return n!=null&&g(e,["role"],n),e}function pE(i){const e={},t=f(i,["controlType"]);t!=null&&g(e,["controlType"],t);const n=f(i,["enableControlImageComputation"]);return n!=null&&g(e,["computeControl"],n),e}function gE(i){const e={};if(f(i,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(i,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(i,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function mE(i,e){const t={},n=f(i,["systemInstruction"]);e!==void 0&&n!=null&&g(e,["systemInstruction"],gt(n));const s=f(i,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>Pg(u))),g(e,["tools"],l)}const o=f(i,["generationConfig"]);return e!==void 0&&o!=null&&g(e,["generationConfig"],rA(o)),t}function vE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["contents"]);if(s!=null){let l=Yt(s);Array.isArray(l)&&(l=l.map(u=>Wo(u))),g(t,["contents"],l)}const o=f(e,["config"]);return o!=null&&gE(o),t}function yE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["contents"]);if(s!=null){let l=Yt(s);Array.isArray(l)&&(l=l.map(u=>u)),g(t,["contents"],l)}const o=f(e,["config"]);return o!=null&&mE(o,t),t}function _E(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["totalTokens"]);n!=null&&g(e,["totalTokens"],n);const s=f(i,["cachedContentTokenCount"]);return s!=null&&g(e,["cachedContentTokenCount"],s),e}function EE(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["totalTokens"]);return n!=null&&g(e,["totalTokens"],n),e}function AE(i,e){const t={},n=f(e,["model"]);return n!=null&&g(t,["_url","name"],Re(i,n)),t}function wE(i,e){const t={},n=f(e,["model"]);return n!=null&&g(t,["_url","name"],Re(i,n)),t}function SE(i){const e={},t=f(i,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function CE(i){const e={},t=f(i,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function TE(i,e){const t={},n=f(i,["outputGcsUri"]);e!==void 0&&n!=null&&g(e,["parameters","storageUri"],n);const s=f(i,["negativePrompt"]);e!==void 0&&s!=null&&g(e,["parameters","negativePrompt"],s);const o=f(i,["numberOfImages"]);e!==void 0&&o!=null&&g(e,["parameters","sampleCount"],o);const l=f(i,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const u=f(i,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);const d=f(i,["seed"]);e!==void 0&&d!=null&&g(e,["parameters","seed"],d);const h=f(i,["safetyFilterLevel"]);e!==void 0&&h!=null&&g(e,["parameters","safetySetting"],h);const p=f(i,["personGeneration"]);e!==void 0&&p!=null&&g(e,["parameters","personGeneration"],p);const v=f(i,["includeSafetyAttributes"]);e!==void 0&&v!=null&&g(e,["parameters","includeSafetyAttributes"],v);const y=f(i,["includeRaiReason"]);e!==void 0&&y!=null&&g(e,["parameters","includeRaiReason"],y);const A=f(i,["language"]);e!==void 0&&A!=null&&g(e,["parameters","language"],A);const w=f(i,["outputMimeType"]);e!==void 0&&w!=null&&g(e,["parameters","outputOptions","mimeType"],w);const C=f(i,["outputCompressionQuality"]);e!==void 0&&C!=null&&g(e,["parameters","outputOptions","compressionQuality"],C);const T=f(i,["addWatermark"]);e!==void 0&&T!=null&&g(e,["parameters","addWatermark"],T);const x=f(i,["labels"]);e!==void 0&&x!=null&&g(e,["labels"],x);const I=f(i,["editMode"]);e!==void 0&&I!=null&&g(e,["parameters","editMode"],I);const P=f(i,["baseSteps"]);return e!==void 0&&P!=null&&g(e,["parameters","editConfig","baseSteps"],P),t}function xE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const o=f(e,["referenceImages"]);if(o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>CA(d))),g(t,["instances[0]","referenceImages"],u)}const l=f(e,["config"]);return l!=null&&TE(l,t),t}function kE(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Yo(o))),g(e,["generatedImages"],s)}return e}function IE(i,e){const t={},n=f(i,["taskType"]);e!==void 0&&n!=null&&g(e,["requests[]","taskType"],n);const s=f(i,["title"]);e!==void 0&&s!=null&&g(e,["requests[]","title"],s);const o=f(i,["outputDimensionality"]);if(e!==void 0&&o!=null&&g(e,["requests[]","outputDimensionality"],o),f(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function RE(i,e){const t={},n=f(i,["taskType"]);e!==void 0&&n!=null&&g(e,["instances[]","task_type"],n);const s=f(i,["title"]);e!==void 0&&s!=null&&g(e,["instances[]","title"],s);const o=f(i,["outputDimensionality"]);e!==void 0&&o!=null&&g(e,["parameters","outputDimensionality"],o);const l=f(i,["mimeType"]);e!==void 0&&l!=null&&g(e,["instances[]","mimeType"],l);const u=f(i,["autoTruncate"]);return e!==void 0&&u!=null&&g(e,["parameters","autoTruncate"],u),t}function bE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["contents"]);if(s!=null){let u=Ou(i,s);Array.isArray(u)&&(u=u.map(d=>d)),g(t,["requests[]","content"],u)}const o=f(e,["config"]);o!=null&&IE(o,t);const l=f(e,["model"]);return l!==void 0&&g(t,["requests[]","model"],Re(i,l)),t}function PE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["contents"]);if(s!=null){let l=Ou(i,s);Array.isArray(l)&&(l=l.map(u=>u)),g(t,["instances[]","content"],l)}const o=f(e,["config"]);return o!=null&&RE(o,t),t}function ME(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["embeddings"],o)}const s=f(i,["metadata"]);return s!=null&&g(e,["metadata"],s),e}function NE(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["predictions[]","embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>hE(l))),g(e,["embeddings"],o)}const s=f(i,["metadata"]);return s!=null&&g(e,["metadata"],s),e}function LE(i){const e={},t=f(i,["endpoint"]);t!=null&&g(e,["name"],t);const n=f(i,["deployedModelId"]);return n!=null&&g(e,["deployedModelId"],n),e}function DE(i){const e={};if(f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(i,["fileUri"]);t!=null&&g(e,["fileUri"],t);const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function FE(i){const e={};if(f(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(i,["description"]);t!=null&&g(e,["description"],t);const n=f(i,["name"]);n!=null&&g(e,["name"],n);const s=f(i,["parameters"]);s!=null&&g(e,["parameters"],s);const o=f(i,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);const l=f(i,["response"]);l!=null&&g(e,["response"],l);const u=f(i,["responseJsonSchema"]);return u!=null&&g(e,["responseJsonSchema"],u),e}function UE(i,e,t){const n={},s=f(e,["systemInstruction"]);t!==void 0&&s!=null&&g(t,["systemInstruction"],Wo(gt(s)));const o=f(e,["temperature"]);o!=null&&g(n,["temperature"],o);const l=f(e,["topP"]);l!=null&&g(n,["topP"],l);const u=f(e,["topK"]);u!=null&&g(n,["topK"],u);const d=f(e,["candidateCount"]);d!=null&&g(n,["candidateCount"],d);const h=f(e,["maxOutputTokens"]);h!=null&&g(n,["maxOutputTokens"],h);const p=f(e,["stopSequences"]);p!=null&&g(n,["stopSequences"],p);const v=f(e,["responseLogprobs"]);v!=null&&g(n,["responseLogprobs"],v);const y=f(e,["logprobs"]);y!=null&&g(n,["logprobs"],y);const A=f(e,["presencePenalty"]);A!=null&&g(n,["presencePenalty"],A);const w=f(e,["frequencyPenalty"]);w!=null&&g(n,["frequencyPenalty"],w);const C=f(e,["seed"]);C!=null&&g(n,["seed"],C);const T=f(e,["responseMimeType"]);T!=null&&g(n,["responseMimeType"],T);const x=f(e,["responseSchema"]);x!=null&&g(n,["responseSchema"],Vu(x));const I=f(e,["responseJsonSchema"]);if(I!=null&&g(n,["responseJsonSchema"],I),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=f(e,["safetySettings"]);if(t!==void 0&&P!=null){let le=P;Array.isArray(le)&&(le=le.map(ge=>TA(ge))),g(t,["safetySettings"],le)}const M=f(e,["tools"]);if(t!==void 0&&M!=null){let le=os(M);Array.isArray(le)&&(le=le.map(ge=>PA(rs(ge)))),g(t,["tools"],le)}const F=f(e,["toolConfig"]);if(t!==void 0&&F!=null&&g(t,["toolConfig"],F),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=f(e,["cachedContent"]);t!==void 0&&H!=null&&g(t,["cachedContent"],Pn(i,H));const O=f(e,["responseModalities"]);O!=null&&g(n,["responseModalities"],O);const K=f(e,["mediaResolution"]);K!=null&&g(n,["mediaResolution"],K);const q=f(e,["speechConfig"]);if(q!=null&&g(n,["speechConfig"],Gu(q)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const J=f(e,["thinkingConfig"]);J!=null&&g(n,["thinkingConfig"],J);const j=f(e,["imageConfig"]);return j!=null&&g(n,["imageConfig"],j),n}function HE(i,e,t){const n={},s=f(e,["systemInstruction"]);t!==void 0&&s!=null&&g(t,["systemInstruction"],gt(s));const o=f(e,["temperature"]);o!=null&&g(n,["temperature"],o);const l=f(e,["topP"]);l!=null&&g(n,["topP"],l);const u=f(e,["topK"]);u!=null&&g(n,["topK"],u);const d=f(e,["candidateCount"]);d!=null&&g(n,["candidateCount"],d);const h=f(e,["maxOutputTokens"]);h!=null&&g(n,["maxOutputTokens"],h);const p=f(e,["stopSequences"]);p!=null&&g(n,["stopSequences"],p);const v=f(e,["responseLogprobs"]);v!=null&&g(n,["responseLogprobs"],v);const y=f(e,["logprobs"]);y!=null&&g(n,["logprobs"],y);const A=f(e,["presencePenalty"]);A!=null&&g(n,["presencePenalty"],A);const w=f(e,["frequencyPenalty"]);w!=null&&g(n,["frequencyPenalty"],w);const C=f(e,["seed"]);C!=null&&g(n,["seed"],C);const T=f(e,["responseMimeType"]);T!=null&&g(n,["responseMimeType"],T);const x=f(e,["responseSchema"]);x!=null&&g(n,["responseSchema"],Vu(x));const I=f(e,["responseJsonSchema"]);I!=null&&g(n,["responseJsonSchema"],I);const P=f(e,["routingConfig"]);P!=null&&g(n,["routingConfig"],P);const M=f(e,["modelSelectionConfig"]);M!=null&&g(n,["modelConfig"],M);const F=f(e,["safetySettings"]);if(t!==void 0&&F!=null){let ye=F;Array.isArray(ye)&&(ye=ye.map(X=>X)),g(t,["safetySettings"],ye)}const H=f(e,["tools"]);if(t!==void 0&&H!=null){let ye=os(H);Array.isArray(ye)&&(ye=ye.map(X=>Pg(rs(X)))),g(t,["tools"],ye)}const O=f(e,["toolConfig"]);t!==void 0&&O!=null&&g(t,["toolConfig"],O);const K=f(e,["labels"]);t!==void 0&&K!=null&&g(t,["labels"],K);const q=f(e,["cachedContent"]);t!==void 0&&q!=null&&g(t,["cachedContent"],Pn(i,q));const J=f(e,["responseModalities"]);J!=null&&g(n,["responseModalities"],J);const j=f(e,["mediaResolution"]);j!=null&&g(n,["mediaResolution"],j);const le=f(e,["speechConfig"]);le!=null&&g(n,["speechConfig"],bg(Gu(le)));const ge=f(e,["audioTimestamp"]);ge!=null&&g(n,["audioTimestamp"],ge);const Pe=f(e,["thinkingConfig"]);Pe!=null&&g(n,["thinkingConfig"],Pe);const Te=f(e,["imageConfig"]);return Te!=null&&g(n,["imageConfig"],Te),n}function Ip(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["contents"]);if(s!=null){let l=Yt(s);Array.isArray(l)&&(l=l.map(u=>Wo(u))),g(t,["contents"],l)}const o=f(e,["config"]);return o!=null&&g(t,["generationConfig"],UE(i,o,t)),t}function Rp(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["contents"]);if(s!=null){let l=Yt(s);Array.isArray(l)&&(l=l.map(u=>u)),g(t,["contents"],l)}const o=f(e,["config"]);return o!=null&&g(t,["generationConfig"],HE(i,o,t)),t}function bp(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>lE(h))),g(e,["candidates"],d)}const s=f(i,["modelVersion"]);s!=null&&g(e,["modelVersion"],s);const o=f(i,["promptFeedback"]);o!=null&&g(e,["promptFeedback"],o);const l=f(i,["responseId"]);l!=null&&g(e,["responseId"],l);const u=f(i,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function Pp(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>p)),g(e,["candidates"],h)}const s=f(i,["createTime"]);s!=null&&g(e,["createTime"],s);const o=f(i,["modelVersion"]);o!=null&&g(e,["modelVersion"],o);const l=f(i,["promptFeedback"]);l!=null&&g(e,["promptFeedback"],l);const u=f(i,["responseId"]);u!=null&&g(e,["responseId"],u);const d=f(i,["usageMetadata"]);return d!=null&&g(e,["usageMetadata"],d),e}function BE(i,e){const t={};if(f(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(i,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=f(i,["numberOfImages"]);e!==void 0&&n!=null&&g(e,["parameters","sampleCount"],n);const s=f(i,["aspectRatio"]);e!==void 0&&s!=null&&g(e,["parameters","aspectRatio"],s);const o=f(i,["guidanceScale"]);if(e!==void 0&&o!=null&&g(e,["parameters","guidanceScale"],o),f(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=f(i,["safetyFilterLevel"]);e!==void 0&&l!=null&&g(e,["parameters","safetySetting"],l);const u=f(i,["personGeneration"]);e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u);const d=f(i,["includeSafetyAttributes"]);e!==void 0&&d!=null&&g(e,["parameters","includeSafetyAttributes"],d);const h=f(i,["includeRaiReason"]);e!==void 0&&h!=null&&g(e,["parameters","includeRaiReason"],h);const p=f(i,["language"]);e!==void 0&&p!=null&&g(e,["parameters","language"],p);const v=f(i,["outputMimeType"]);e!==void 0&&v!=null&&g(e,["parameters","outputOptions","mimeType"],v);const y=f(i,["outputCompressionQuality"]);if(e!==void 0&&y!=null&&g(e,["parameters","outputOptions","compressionQuality"],y),f(i,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=f(i,["imageSize"]);if(e!==void 0&&A!=null&&g(e,["parameters","sampleImageSize"],A),f(i,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function OE(i,e){const t={},n=f(i,["outputGcsUri"]);e!==void 0&&n!=null&&g(e,["parameters","storageUri"],n);const s=f(i,["negativePrompt"]);e!==void 0&&s!=null&&g(e,["parameters","negativePrompt"],s);const o=f(i,["numberOfImages"]);e!==void 0&&o!=null&&g(e,["parameters","sampleCount"],o);const l=f(i,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const u=f(i,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);const d=f(i,["seed"]);e!==void 0&&d!=null&&g(e,["parameters","seed"],d);const h=f(i,["safetyFilterLevel"]);e!==void 0&&h!=null&&g(e,["parameters","safetySetting"],h);const p=f(i,["personGeneration"]);e!==void 0&&p!=null&&g(e,["parameters","personGeneration"],p);const v=f(i,["includeSafetyAttributes"]);e!==void 0&&v!=null&&g(e,["parameters","includeSafetyAttributes"],v);const y=f(i,["includeRaiReason"]);e!==void 0&&y!=null&&g(e,["parameters","includeRaiReason"],y);const A=f(i,["language"]);e!==void 0&&A!=null&&g(e,["parameters","language"],A);const w=f(i,["outputMimeType"]);e!==void 0&&w!=null&&g(e,["parameters","outputOptions","mimeType"],w);const C=f(i,["outputCompressionQuality"]);e!==void 0&&C!=null&&g(e,["parameters","outputOptions","compressionQuality"],C);const T=f(i,["addWatermark"]);e!==void 0&&T!=null&&g(e,["parameters","addWatermark"],T);const x=f(i,["labels"]);e!==void 0&&x!=null&&g(e,["labels"],x);const I=f(i,["imageSize"]);e!==void 0&&I!=null&&g(e,["parameters","sampleImageSize"],I);const P=f(i,["enhancePrompt"]);return e!==void 0&&P!=null&&g(e,["parameters","enhancePrompt"],P),t}function VE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const o=f(e,["config"]);return o!=null&&BE(o,t),t}function GE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const o=f(e,["config"]);return o!=null&&OE(o,t),t}function zE(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>tA(l))),g(e,["generatedImages"],o)}const s=f(i,["positivePromptSafetyAttributes"]);return s!=null&&g(e,["positivePromptSafetyAttributes"],Ig(s)),e}function qE(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>Yo(l))),g(e,["generatedImages"],o)}const s=f(i,["positivePromptSafetyAttributes"]);return s!=null&&g(e,["positivePromptSafetyAttributes"],Rg(s)),e}function $E(i,e){const t={},n=f(i,["numberOfVideos"]);if(e!==void 0&&n!=null&&g(e,["parameters","sampleCount"],n),f(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(i,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=f(i,["durationSeconds"]);if(e!==void 0&&s!=null&&g(e,["parameters","durationSeconds"],s),f(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=f(i,["aspectRatio"]);e!==void 0&&o!=null&&g(e,["parameters","aspectRatio"],o);const l=f(i,["resolution"]);e!==void 0&&l!=null&&g(e,["parameters","resolution"],l);const u=f(i,["personGeneration"]);if(e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u),f(i,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=f(i,["negativePrompt"]);e!==void 0&&d!=null&&g(e,["parameters","negativePrompt"],d);const h=f(i,["enhancePrompt"]);if(e!==void 0&&h!=null&&g(e,["parameters","enhancePrompt"],h),f(i,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=f(i,["lastFrame"]);e!==void 0&&p!=null&&g(e,["instances[0]","lastFrame"],Ko(p));const v=f(i,["referenceImages"]);if(e!==void 0&&v!=null){let y=v;Array.isArray(y)&&(y=y.map(A=>qA(A))),g(e,["instances[0]","referenceImages"],y)}if(f(i,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(i,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function WE(i,e){const t={},n=f(i,["numberOfVideos"]);e!==void 0&&n!=null&&g(e,["parameters","sampleCount"],n);const s=f(i,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const o=f(i,["fps"]);e!==void 0&&o!=null&&g(e,["parameters","fps"],o);const l=f(i,["durationSeconds"]);e!==void 0&&l!=null&&g(e,["parameters","durationSeconds"],l);const u=f(i,["seed"]);e!==void 0&&u!=null&&g(e,["parameters","seed"],u);const d=f(i,["aspectRatio"]);e!==void 0&&d!=null&&g(e,["parameters","aspectRatio"],d);const h=f(i,["resolution"]);e!==void 0&&h!=null&&g(e,["parameters","resolution"],h);const p=f(i,["personGeneration"]);e!==void 0&&p!=null&&g(e,["parameters","personGeneration"],p);const v=f(i,["pubsubTopic"]);e!==void 0&&v!=null&&g(e,["parameters","pubsubTopic"],v);const y=f(i,["negativePrompt"]);e!==void 0&&y!=null&&g(e,["parameters","negativePrompt"],y);const A=f(i,["enhancePrompt"]);e!==void 0&&A!=null&&g(e,["parameters","enhancePrompt"],A);const w=f(i,["generateAudio"]);e!==void 0&&w!=null&&g(e,["parameters","generateAudio"],w);const C=f(i,["lastFrame"]);e!==void 0&&C!=null&&g(e,["instances[0]","lastFrame"],on(C));const T=f(i,["referenceImages"]);if(e!==void 0&&T!=null){let P=T;Array.isArray(P)&&(P=P.map(M=>$A(M))),g(e,["instances[0]","referenceImages"],P)}const x=f(i,["mask"]);e!==void 0&&x!=null&&g(e,["instances[0]","mask"],zA(x));const I=f(i,["compressionQuality"]);return e!==void 0&&I!=null&&g(e,["parameters","compressionQuality"],I),t}function YE(i){const e={},t=f(i,["name"]);t!=null&&g(e,["name"],t);const n=f(i,["metadata"]);n!=null&&g(e,["metadata"],n);const s=f(i,["done"]);s!=null&&g(e,["done"],s);const o=f(i,["error"]);o!=null&&g(e,["error"],o);const l=f(i,["response","generateVideoResponse"]);return l!=null&&g(e,["response"],QE(l)),e}function KE(i){const e={},t=f(i,["name"]);t!=null&&g(e,["name"],t);const n=f(i,["metadata"]);n!=null&&g(e,["metadata"],n);const s=f(i,["done"]);s!=null&&g(e,["done"],s);const o=f(i,["error"]);o!=null&&g(e,["error"],o);const l=f(i,["response"]);return l!=null&&g(e,["response"],ZE(l)),e}function JE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const o=f(e,["image"]);o!=null&&g(t,["instances[0]","image"],Ko(o));const l=f(e,["video"]);l!=null&&g(t,["instances[0]","video"],Mg(l));const u=f(e,["source"]);u!=null&&jE(u,t);const d=f(e,["config"]);return d!=null&&$E(d,t),t}function XE(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["prompt"]);s!=null&&g(t,["instances[0]","prompt"],s);const o=f(e,["image"]);o!=null&&g(t,["instances[0]","image"],on(o));const l=f(e,["video"]);l!=null&&g(t,["instances[0]","video"],Ng(l));const u=f(e,["source"]);u!=null&&eA(u,t);const d=f(e,["config"]);return d!=null&&WE(d,t),t}function QE(i){const e={},t=f(i,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>iA(l))),g(e,["generatedVideos"],o)}const n=f(i,["raiMediaFilteredCount"]);n!=null&&g(e,["raiMediaFilteredCount"],n);const s=f(i,["raiMediaFilteredReasons"]);return s!=null&&g(e,["raiMediaFilteredReasons"],s),e}function ZE(i){const e={},t=f(i,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>sA(l))),g(e,["generatedVideos"],o)}const n=f(i,["raiMediaFilteredCount"]);n!=null&&g(e,["raiMediaFilteredCount"],n);const s=f(i,["raiMediaFilteredReasons"]);return s!=null&&g(e,["raiMediaFilteredReasons"],s),e}function jE(i,e){const t={},n=f(i,["prompt"]);e!==void 0&&n!=null&&g(e,["instances[0]","prompt"],n);const s=f(i,["image"]);e!==void 0&&s!=null&&g(e,["instances[0]","image"],Ko(s));const o=f(i,["video"]);return e!==void 0&&o!=null&&g(e,["instances[0]","video"],Mg(o)),t}function eA(i,e){const t={},n=f(i,["prompt"]);e!==void 0&&n!=null&&g(e,["instances[0]","prompt"],n);const s=f(i,["image"]);e!==void 0&&s!=null&&g(e,["instances[0]","image"],on(s));const o=f(i,["video"]);return e!==void 0&&o!=null&&g(e,["instances[0]","video"],Ng(o)),t}function tA(i){const e={},t=f(i,["_self"]);t!=null&&g(e,["image"],cA(t));const n=f(i,["raiFilteredReason"]);n!=null&&g(e,["raiFilteredReason"],n);const s=f(i,["_self"]);return s!=null&&g(e,["safetyAttributes"],Ig(s)),e}function Yo(i){const e={},t=f(i,["_self"]);t!=null&&g(e,["image"],kg(t));const n=f(i,["raiFilteredReason"]);n!=null&&g(e,["raiFilteredReason"],n);const s=f(i,["_self"]);s!=null&&g(e,["safetyAttributes"],Rg(s));const o=f(i,["prompt"]);return o!=null&&g(e,["enhancedPrompt"],o),e}function nA(i){const e={},t=f(i,["_self"]);t!=null&&g(e,["mask"],kg(t));const n=f(i,["labels"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),g(e,["labels"],s)}return e}function iA(i){const e={},t=f(i,["video"]);return t!=null&&g(e,["video"],VA(t)),e}function sA(i){const e={},t=f(i,["_self"]);return t!=null&&g(e,["video"],GA(t)),e}function rA(i){const e={},t=f(i,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const n=f(i,["audioTimestamp"]);n!=null&&g(e,["audioTimestamp"],n);const s=f(i,["candidateCount"]);s!=null&&g(e,["candidateCount"],s);const o=f(i,["enableAffectiveDialog"]);o!=null&&g(e,["enableAffectiveDialog"],o);const l=f(i,["frequencyPenalty"]);l!=null&&g(e,["frequencyPenalty"],l);const u=f(i,["logprobs"]);u!=null&&g(e,["logprobs"],u);const d=f(i,["maxOutputTokens"]);d!=null&&g(e,["maxOutputTokens"],d);const h=f(i,["mediaResolution"]);h!=null&&g(e,["mediaResolution"],h);const p=f(i,["presencePenalty"]);p!=null&&g(e,["presencePenalty"],p);const v=f(i,["responseJsonSchema"]);v!=null&&g(e,["responseJsonSchema"],v);const y=f(i,["responseLogprobs"]);y!=null&&g(e,["responseLogprobs"],y);const A=f(i,["responseMimeType"]);A!=null&&g(e,["responseMimeType"],A);const w=f(i,["responseModalities"]);w!=null&&g(e,["responseModalities"],w);const C=f(i,["responseSchema"]);C!=null&&g(e,["responseSchema"],C);const T=f(i,["routingConfig"]);T!=null&&g(e,["routingConfig"],T);const x=f(i,["seed"]);x!=null&&g(e,["seed"],x);const I=f(i,["speechConfig"]);I!=null&&g(e,["speechConfig"],bg(I));const P=f(i,["stopSequences"]);P!=null&&g(e,["stopSequences"],P);const M=f(i,["temperature"]);M!=null&&g(e,["temperature"],M);const F=f(i,["thinkingConfig"]);F!=null&&g(e,["thinkingConfig"],F);const H=f(i,["topK"]);H!=null&&g(e,["topK"],H);const O=f(i,["topP"]);if(O!=null&&g(e,["topP"],O),f(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function oA(i,e){const t={},n=f(e,["model"]);return n!=null&&g(t,["_url","name"],Re(i,n)),t}function aA(i,e){const t={},n=f(e,["model"]);return n!=null&&g(t,["_url","name"],Re(i,n)),t}function lA(i){const e={};if(f(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(i,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function uA(i){const e={};if(f(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const t=f(i,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function cA(i){const e={},t=f(i,["bytesBase64Encoded"]);t!=null&&g(e,["imageBytes"],ei(t));const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function kg(i){const e={},t=f(i,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const n=f(i,["bytesBase64Encoded"]);n!=null&&g(e,["imageBytes"],ei(n));const s=f(i,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function Ko(i){const e={};if(f(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=f(i,["imageBytes"]);t!=null&&g(e,["bytesBase64Encoded"],ei(t));const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function on(i){const e={},t=f(i,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const n=f(i,["imageBytes"]);n!=null&&g(e,["bytesBase64Encoded"],ei(n));const s=f(i,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function dA(i,e,t){const n={},s=f(e,["pageSize"]);t!==void 0&&s!=null&&g(t,["_query","pageSize"],s);const o=f(e,["pageToken"]);t!==void 0&&o!=null&&g(t,["_query","pageToken"],o);const l=f(e,["filter"]);t!==void 0&&l!=null&&g(t,["_query","filter"],l);const u=f(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],_g(i,u)),n}function hA(i,e,t){const n={},s=f(e,["pageSize"]);t!==void 0&&s!=null&&g(t,["_query","pageSize"],s);const o=f(e,["pageToken"]);t!==void 0&&o!=null&&g(t,["_query","pageToken"],o);const l=f(e,["filter"]);t!==void 0&&l!=null&&g(t,["_query","filter"],l);const u=f(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],_g(i,u)),n}function fA(i,e){const t={},n=f(e,["config"]);return n!=null&&dA(i,n,t),t}function pA(i,e){const t={},n=f(e,["config"]);return n!=null&&hA(i,n,t),t}function gA(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["nextPageToken"]);n!=null&&g(e,["nextPageToken"],n);const s=f(i,["_self"]);if(s!=null){let o=Eg(s);Array.isArray(o)&&(o=o.map(l=>Au(l))),g(e,["models"],o)}return e}function mA(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["nextPageToken"]);n!=null&&g(e,["nextPageToken"],n);const s=f(i,["_self"]);if(s!=null){let o=Eg(s);Array.isArray(o)&&(o=o.map(l=>wu(l))),g(e,["models"],o)}return e}function vA(i){const e={},t=f(i,["maskMode"]);t!=null&&g(e,["maskMode"],t);const n=f(i,["segmentationClasses"]);n!=null&&g(e,["maskClasses"],n);const s=f(i,["maskDilation"]);return s!=null&&g(e,["dilation"],s),e}function Au(i){const e={},t=f(i,["name"]);t!=null&&g(e,["name"],t);const n=f(i,["displayName"]);n!=null&&g(e,["displayName"],n);const s=f(i,["description"]);s!=null&&g(e,["description"],s);const o=f(i,["version"]);o!=null&&g(e,["version"],o);const l=f(i,["_self"]);l!=null&&g(e,["tunedModelInfo"],MA(l));const u=f(i,["inputTokenLimit"]);u!=null&&g(e,["inputTokenLimit"],u);const d=f(i,["outputTokenLimit"]);d!=null&&g(e,["outputTokenLimit"],d);const h=f(i,["supportedGenerationMethods"]);return h!=null&&g(e,["supportedActions"],h),e}function wu(i){const e={},t=f(i,["name"]);t!=null&&g(e,["name"],t);const n=f(i,["displayName"]);n!=null&&g(e,["displayName"],n);const s=f(i,["description"]);s!=null&&g(e,["description"],s);const o=f(i,["versionId"]);o!=null&&g(e,["version"],o);const l=f(i,["deployedModels"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(y=>LE(y))),g(e,["endpoints"],v)}const u=f(i,["labels"]);u!=null&&g(e,["labels"],u);const d=f(i,["_self"]);d!=null&&g(e,["tunedModelInfo"],NA(d));const h=f(i,["defaultCheckpointId"]);h!=null&&g(e,["defaultCheckpointId"],h);const p=f(i,["checkpoints"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(y=>y)),g(e,["checkpoints"],v)}return e}function yA(i){const e={},t=f(i,["functionCall"]);t!=null&&g(e,["functionCall"],t);const n=f(i,["codeExecutionResult"]);n!=null&&g(e,["codeExecutionResult"],n);const s=f(i,["executableCode"]);s!=null&&g(e,["executableCode"],s);const o=f(i,["fileData"]);o!=null&&g(e,["fileData"],DE(o));const l=f(i,["functionResponse"]);l!=null&&g(e,["functionResponse"],l);const u=f(i,["inlineData"]);u!=null&&g(e,["inlineData"],aE(u));const d=f(i,["text"]);d!=null&&g(e,["text"],d);const h=f(i,["thought"]);h!=null&&g(e,["thought"],h);const p=f(i,["thoughtSignature"]);p!=null&&g(e,["thoughtSignature"],p);const v=f(i,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function _A(i){const e={},t=f(i,["productImage"]);return t!=null&&g(e,["image"],on(t)),e}function EA(i,e){const t={},n=f(i,["numberOfImages"]);e!==void 0&&n!=null&&g(e,["parameters","sampleCount"],n);const s=f(i,["baseSteps"]);e!==void 0&&s!=null&&g(e,["parameters","editConfig","baseSteps"],s);const o=f(i,["outputGcsUri"]);e!==void 0&&o!=null&&g(e,["parameters","storageUri"],o);const l=f(i,["seed"]);e!==void 0&&l!=null&&g(e,["parameters","seed"],l);const u=f(i,["safetyFilterLevel"]);e!==void 0&&u!=null&&g(e,["parameters","safetySetting"],u);const d=f(i,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);const h=f(i,["addWatermark"]);e!==void 0&&h!=null&&g(e,["parameters","addWatermark"],h);const p=f(i,["outputMimeType"]);e!==void 0&&p!=null&&g(e,["parameters","outputOptions","mimeType"],p);const v=f(i,["outputCompressionQuality"]);e!==void 0&&v!=null&&g(e,["parameters","outputOptions","compressionQuality"],v);const y=f(i,["enhancePrompt"]);e!==void 0&&y!=null&&g(e,["parameters","enhancePrompt"],y);const A=f(i,["labels"]);return e!==void 0&&A!=null&&g(e,["labels"],A),t}function AA(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["source"]);s!=null&&SA(s,t);const o=f(e,["config"]);return o!=null&&EA(o,t),t}function wA(i){const e={},t=f(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>Yo(s))),g(e,["generatedImages"],n)}return e}function SA(i,e){const t={},n=f(i,["prompt"]);e!==void 0&&n!=null&&g(e,["instances[0]","prompt"],n);const s=f(i,["personImage"]);e!==void 0&&s!=null&&g(e,["instances[0]","personImage","image"],on(s));const o=f(i,["productImages"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>_A(u))),g(e,["instances[0]","productImages"],l)}return t}function CA(i){const e={},t=f(i,["referenceImage"]);t!=null&&g(e,["referenceImage"],on(t));const n=f(i,["referenceId"]);n!=null&&g(e,["referenceId"],n);const s=f(i,["referenceType"]);s!=null&&g(e,["referenceType"],s);const o=f(i,["maskImageConfig"]);o!=null&&g(e,["maskImageConfig"],vA(o));const l=f(i,["controlImageConfig"]);l!=null&&g(e,["controlImageConfig"],pE(l));const u=f(i,["styleImageConfig"]);u!=null&&g(e,["styleImageConfig"],u);const d=f(i,["subjectImageConfig"]);return d!=null&&g(e,["subjectImageConfig"],d),e}function Ig(i){const e={},t=f(i,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const n=f(i,["safetyAttributes","scores"]);n!=null&&g(e,["scores"],n);const s=f(i,["contentType"]);return s!=null&&g(e,["contentType"],s),e}function Rg(i){const e={},t=f(i,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const n=f(i,["safetyAttributes","scores"]);n!=null&&g(e,["scores"],n);const s=f(i,["contentType"]);return s!=null&&g(e,["contentType"],s),e}function TA(i){const e={},t=f(i,["category"]);if(t!=null&&g(e,["category"],t),f(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(i,["threshold"]);return n!=null&&g(e,["threshold"],n),e}function xA(i){const e={},t=f(i,["image"]);return t!=null&&g(e,["image"],on(t)),e}function kA(i,e){const t={},n=f(i,["mode"]);e!==void 0&&n!=null&&g(e,["parameters","mode"],n);const s=f(i,["maxPredictions"]);e!==void 0&&s!=null&&g(e,["parameters","maxPredictions"],s);const o=f(i,["confidenceThreshold"]);e!==void 0&&o!=null&&g(e,["parameters","confidenceThreshold"],o);const l=f(i,["maskDilation"]);e!==void 0&&l!=null&&g(e,["parameters","maskDilation"],l);const u=f(i,["binaryColorThreshold"]);e!==void 0&&u!=null&&g(e,["parameters","binaryColorThreshold"],u);const d=f(i,["labels"]);return e!==void 0&&d!=null&&g(e,["labels"],d),t}function IA(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["source"]);s!=null&&bA(s,t);const o=f(e,["config"]);return o!=null&&kA(o,t),t}function RA(i){const e={},t=f(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>nA(s))),g(e,["generatedMasks"],n)}return e}function bA(i,e){const t={},n=f(i,["prompt"]);e!==void 0&&n!=null&&g(e,["instances[0]","prompt"],n);const s=f(i,["image"]);e!==void 0&&s!=null&&g(e,["instances[0]","image"],on(s));const o=f(i,["scribbleImage"]);return e!==void 0&&o!=null&&g(e,["instances[0]","scribble"],xA(o)),t}function bg(i){const e={},t=f(i,["languageCode"]);t!=null&&g(e,["languageCode"],t);const n=f(i,["voiceConfig"]);if(n!=null&&g(e,["voiceConfig"],n),f(i,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function PA(i){const e={},t=f(i,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),g(e,["functionDeclarations"],h)}if(f(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=f(i,["googleSearchRetrieval"]);n!=null&&g(e,["googleSearchRetrieval"],n);const s=f(i,["googleMaps"]);s!=null&&g(e,["googleMaps"],lA(s));const o=f(i,["computerUse"]);o!=null&&g(e,["computerUse"],o);const l=f(i,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),f(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=f(i,["googleSearch"]);u!=null&&g(e,["googleSearch"],uA(u));const d=f(i,["urlContext"]);return d!=null&&g(e,["urlContext"],d),e}function Pg(i){const e={},t=f(i,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(y=>FE(y))),g(e,["functionDeclarations"],v)}const n=f(i,["retrieval"]);n!=null&&g(e,["retrieval"],n);const s=f(i,["googleSearchRetrieval"]);s!=null&&g(e,["googleSearchRetrieval"],s);const o=f(i,["googleMaps"]);o!=null&&g(e,["googleMaps"],o);const l=f(i,["computerUse"]);l!=null&&g(e,["computerUse"],l);const u=f(i,["codeExecution"]);u!=null&&g(e,["codeExecution"],u);const d=f(i,["enterpriseWebSearch"]);d!=null&&g(e,["enterpriseWebSearch"],d);const h=f(i,["googleSearch"]);h!=null&&g(e,["googleSearch"],h);const p=f(i,["urlContext"]);return p!=null&&g(e,["urlContext"],p),e}function MA(i){const e={},t=f(i,["baseModel"]);t!=null&&g(e,["baseModel"],t);const n=f(i,["createTime"]);n!=null&&g(e,["createTime"],n);const s=f(i,["updateTime"]);return s!=null&&g(e,["updateTime"],s),e}function NA(i){const e={},t=f(i,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&g(e,["baseModel"],t);const n=f(i,["createTime"]);n!=null&&g(e,["createTime"],n);const s=f(i,["updateTime"]);return s!=null&&g(e,["updateTime"],s),e}function LA(i,e){const t={},n=f(i,["displayName"]);e!==void 0&&n!=null&&g(e,["displayName"],n);const s=f(i,["description"]);e!==void 0&&s!=null&&g(e,["description"],s);const o=f(i,["defaultCheckpointId"]);return e!==void 0&&o!=null&&g(e,["defaultCheckpointId"],o),t}function DA(i,e){const t={},n=f(i,["displayName"]);e!==void 0&&n!=null&&g(e,["displayName"],n);const s=f(i,["description"]);e!==void 0&&s!=null&&g(e,["description"],s);const o=f(i,["defaultCheckpointId"]);return e!==void 0&&o!=null&&g(e,["defaultCheckpointId"],o),t}function FA(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","name"],Re(i,n));const s=f(e,["config"]);return s!=null&&LA(s,t),t}function UA(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["config"]);return s!=null&&DA(s,t),t}function HA(i,e){const t={},n=f(i,["outputGcsUri"]);e!==void 0&&n!=null&&g(e,["parameters","storageUri"],n);const s=f(i,["safetyFilterLevel"]);e!==void 0&&s!=null&&g(e,["parameters","safetySetting"],s);const o=f(i,["personGeneration"]);e!==void 0&&o!=null&&g(e,["parameters","personGeneration"],o);const l=f(i,["includeRaiReason"]);e!==void 0&&l!=null&&g(e,["parameters","includeRaiReason"],l);const u=f(i,["outputMimeType"]);e!==void 0&&u!=null&&g(e,["parameters","outputOptions","mimeType"],u);const d=f(i,["outputCompressionQuality"]);e!==void 0&&d!=null&&g(e,["parameters","outputOptions","compressionQuality"],d);const h=f(i,["enhanceInputImage"]);e!==void 0&&h!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],h);const p=f(i,["imagePreservationFactor"]);e!==void 0&&p!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const v=f(i,["labels"]);e!==void 0&&v!=null&&g(e,["labels"],v);const y=f(i,["numberOfImages"]);e!==void 0&&y!=null&&g(e,["parameters","sampleCount"],y);const A=f(i,["mode"]);return e!==void 0&&A!=null&&g(e,["parameters","mode"],A),t}function BA(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["_url","model"],Re(i,n));const s=f(e,["image"]);s!=null&&g(t,["instances[0]","image"],on(s));const o=f(e,["upscaleFactor"]);o!=null&&g(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=f(e,["config"]);return l!=null&&HA(l,t),t}function OA(i){const e={},t=f(i,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const n=f(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Yo(o))),g(e,["generatedImages"],s)}return e}function VA(i){const e={},t=f(i,["uri"]);t!=null&&g(e,["uri"],t);const n=f(i,["encodedVideo"]);n!=null&&g(e,["videoBytes"],ei(n));const s=f(i,["encoding"]);return s!=null&&g(e,["mimeType"],s),e}function GA(i){const e={},t=f(i,["gcsUri"]);t!=null&&g(e,["uri"],t);const n=f(i,["bytesBase64Encoded"]);n!=null&&g(e,["videoBytes"],ei(n));const s=f(i,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function zA(i){const e={},t=f(i,["image"]);t!=null&&g(e,["_self"],on(t));const n=f(i,["maskMode"]);return n!=null&&g(e,["maskMode"],n),e}function qA(i){const e={},t=f(i,["image"]);t!=null&&g(e,["image"],Ko(t));const n=f(i,["referenceType"]);return n!=null&&g(e,["referenceType"],n),e}function $A(i){const e={},t=f(i,["image"]);t!=null&&g(e,["image"],on(t));const n=f(i,["referenceType"]);return n!=null&&g(e,["referenceType"],n),e}function Mg(i){const e={},t=f(i,["uri"]);t!=null&&g(e,["uri"],t);const n=f(i,["videoBytes"]);n!=null&&g(e,["encodedVideo"],ei(n));const s=f(i,["mimeType"]);return s!=null&&g(e,["encoding"],s),e}function Ng(i){const e={},t=f(i,["uri"]);t!=null&&g(e,["gcsUri"],t);const n=f(i,["videoBytes"]);n!=null&&g(e,["bytesBase64Encoded"],ei(n));const s=f(i,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WA="Content-Type",YA="X-Server-Timeout",KA="User-Agent",Su="x-goog-api-client",JA="1.28.0",XA=`google-genai-sdk/${JA}`,QA="v1beta1",ZA="v1beta",Mp=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class jA{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:QA,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:ZA,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const s=[this.getRequestUrlInternal(t)];return n&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))s.searchParams.append(l,String(u));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.unaryApiCall(s,o,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[s,o]of Object.entries(t))typeof o=="object"?n[s]=Object.assign(Object.assign({},n[s]),o):o!==void 0&&(n[s]=o);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.streamApiCall(s,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,s){if(t&&t.timeout||s){const o=new AbortController,l=o.signal;if(t.timeout&&t?.timeout>0){const u=setTimeout(()=>o.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}s&&s.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&ew(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await Np(s),new yu(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await Np(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return ts(this,arguments,function*(){const s=(t=e?.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";for(;;){const{done:u,value:d}=yield Be(s.read());if(u){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=o.decode(d,{stream:!0});try{const v=JSON.parse(h);if("error"in v){const y=JSON.parse(JSON.stringify(v.error)),A=y.status,w=y.code,C=`got status: ${A}. ${JSON.stringify(v)}`;if(w>=400&&w<600)throw new $o({message:C,status:w})}}catch(v){if(v.name==="ApiError")throw v}l+=h;let p=l.match(Mp);for(;p;){const v=p[1];try{const y=new Response(v,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Be(new yu(y)),l=l.slice(p[0].length),p=l.match(Mp)}catch(y){throw new Error(`exception parsing stream chunk ${v}. ${y}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=XA+" "+this.clientOptions.userAgentExtra;return e[KA]=t,e[Su]=t,e[WA]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[s,o]of Object.entries(e.headers))n.append(s,o);e.timeout&&e.timeout>0&&n.append(YA,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}async uploadFile(e,t){var n,s;const o={};t!=null&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const l=this.clientOptions.uploader,u=await l.stat(e);o.sizeBytes=String(u.size);const d=(n=t?.mimeType)!==null&&n!==void 0?n:u.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=d;let h="";typeof e=="string"&&(h=e.replace(/[/\\]+$/,""),h=(s=h.split(/[/\\]/).pop())!==null&&s!==void 0?s:"");const p=await this.fetchUploadUrl(o,h,t);return l.upload(e,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,n){var s;let o={};n?.httpOptions?o=n.httpOptions:o={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`},t?{"X-Goog-Upload-File-Name":t}:{})};const l={file:e},u=await this.request({path:ne("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:o});if(!u||!u?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(s=u?.headers)===null||s===void 0?void 0:s["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function Np(i){var e;if(i===void 0)throw new Error("response is undefined");if(!i.ok){const t=i.status;let n;!((e=i.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await i.json():n={error:{message:await i.text(),code:i.status,status:i.statusText}};const s=JSON.stringify(n);throw t>=400&&t<600?new $o({message:s,status:t}):new Error(s)}}function ew(i,e){if(!e||Object.keys(e).length===0)return;if(i.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof i.body=="string"&&i.body.length>0)try{const o=JSON.parse(i.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(o,l){const u=Object.assign({},o);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const h=l[d],p=u[d];h&&typeof h=="object"&&!Array.isArray(h)&&p&&typeof p=="object"&&!Array.isArray(p)?u[d]=n(p,h):(p&&h&&typeof p!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof p}, New type: ${typeof h}. Overwriting.`),u[d]=h)}return u}const s=n(t,e);i.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tw="mcp_used/unknown";let nw=!1;function Lg(i){for(const e of i)if(iw(e)||typeof e=="object"&&"inputSchema"in e)return!0;return nw}function Dg(i){var e;const t=(e=i[Su])!==null&&e!==void 0?e:"";i[Su]=(t+` ${tw}`).trimStart()}function iw(i){return i!==null&&typeof i=="object"&&i instanceof qu}function sw(i,e=100){return ts(this,arguments,function*(){let n,s=0;for(;s<e;){const o=yield Be(i.listTools({cursor:n}));for(const l of o.tools)yield yield Be(l),s++;if(!o.nextCursor)break;n=o.nextCursor}})}class qu{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new qu(e,t)}async initialize(){var e,t,n,s;if(this.mcpTools.length>0)return;const o={},l=[];for(const p of this.mcpClients)try{for(var u=!0,d=(t=void 0,ir(sw(p))),h;h=await d.next(),e=h.done,!e;u=!0){s=h.value,u=!1;const v=s;l.push(v);const y=v.name;if(o[y])throw new Error(`Duplicate function name ${y} found in MCP tools. Please ensure function names are unique.`);o[y]=p}}catch(v){t={error:v}}finally{try{!u&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),u0(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[n.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const l=await s.callTool({name:n.name,arguments:n.args},void 0,o);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function rw(i,e,t){const n=new t0;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(n,s),e(n)}class ow{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),l=uw(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${s}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${u}`;let h=()=>{};const p=new Promise(P=>{h=P}),v=e.callbacks,y=function(){h({})},A=this.apiClient,w={onopen:y,onmessage:P=>{rw(A,v.onmessage,P)},onerror:(t=v?.onerror)!==null&&t!==void 0?t:function(P){},onclose:(n=v?.onclose)!==null&&n!==void 0?n:function(P){}},C=this.webSocketFactory.create(d,lw(l),w);C.connect(),await p;const I={setup:{model:Re(this.apiClient,e.model)}};return C.send(JSON.stringify(I)),new aw(C,this.apiClient)}}class aw{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=Z_(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=Q_(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Zi.PLAY)}pause(){this.sendPlaybackControl(Zi.PAUSE)}stop(){this.sendPlaybackControl(Zi.STOP)}resetContext(){this.sendPlaybackControl(Zi.RESET_CONTEXT)}close(){this.conn.close()}}function lw(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function uw(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cw="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function dw(i,e,t){const n=new e0;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const o=JSON.parse(s);if(i.isVertexAI()){const l=tE(o);Object.assign(n,l)}else Object.assign(n,o);e(n)}class hw{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new ow(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,s,o,l,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let p;const v=this.apiClient.getHeaders();e.config&&e.config.tools&&Lg(e.config.tools)&&Dg(v);const y=mw(v);if(this.apiClient.isVertexAI())p=`${d}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(y,p);else{const q=this.apiClient.getApiKey();let J="BidiGenerateContent",j="key";q?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),J="BidiGenerateContentConstrained",j="access_token"),p=`${d}/ws/google.ai.generativelanguage.${h}.GenerativeService.${J}?${j}=${q}`}let A=()=>{};const w=new Promise(q=>{A=q}),C=e.callbacks,T=function(){var q;(q=C?.onopen)===null||q===void 0||q.call(C),A({})},x=this.apiClient,I={onopen:T,onmessage:q=>{dw(x,C.onmessage,q)},onerror:(t=C?.onerror)!==null&&t!==void 0?t:function(q){},onclose:(n=C?.onclose)!==null&&n!==void 0?n:function(q){}},P=this.webSocketFactory.create(p,gw(y),I);P.connect(),await w;let M=Re(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const q=this.apiClient.getProject(),J=this.apiClient.getLocation();M=`projects/${q}/locations/${J}/`+M}let F={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Fo.AUDIO]}:e.config.responseModalities=[Fo.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],O=[];for(const q of H)if(this.isCallableTool(q)){const J=q;O.push(await J.tool())}else O.push(q);O.length>0&&(e.config.tools=O);const K={model:M,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?F=X_(this.apiClient,K):F=J_(this.apiClient,K),delete F.config,P.send(JSON.stringify(F)),new pw(P,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const fw={turnComplete:!0};class pw{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=Yt(t.turns),e.isVertexAI()||(n=n.map(s=>Wo(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const o of n){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(cw)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},fw),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:eE(e)}:t={realtimeInput:j_(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function gw(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function mw(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Lp=10;function Dp(i){var e,t,n;if(!((e=i?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=i?.tools)!==null&&t!==void 0?t:[])if(ns(l)){s=!0;break}if(!s)return!0;const o=(n=i?.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function ns(i){return"callTool"in i&&typeof i.callTool=="function"}function vw(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>ns(s)))!==null&&n!==void 0?n:!1}function yw(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>!ns(s)))!==null&&n!==void 0?n:!1}function Fp(i){var e;return!(!((e=i?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _w extends wi{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,s,o,l,u;const d=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!vw(t)||Dp(t.config))return await this.generateContentInternal(d);if(yw(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,p;const v=Yt(d.contents),y=(o=(s=(n=d.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&o!==void 0?o:Lp;let A=0;for(;A<y&&(h=await this.generateContentInternal(d),!(!h.functionCalls||h.functionCalls.length===0));){const w=h.candidates[0].content,C=[];for(const T of(u=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(ns(T)){const I=await T.callTool(h.functionCalls);C.push(...I)}A++,p={role:"user",parts:C},d.contents=Yt(d.contents),d.contents.push(w),d.contents.push(p),Fp(d.config)&&(v.push(w),v.push(p))}return Fp(d.config)&&(h.automaticFunctionCallingHistory=v),h},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),Dp(t.config)){const n=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(n)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var s;let o;const l=[];if(n?.generatedImages)for(const d of n.generatedImages)d&&d?.safetyAttributes&&((s=d?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?o=d?.safetyAttributes:l.push(d);let u;return o?u={generatedImages:l,positivePromptSafetyAttributes:o,sdkHttpResponse:n.sdkHttpResponse}:u={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},u}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new lr(yi.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var n,s,o,l,u,d;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=t.video)===null||n===void 0)&&n.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(o=t.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.uri&&(!((d=(u=t.source)===null||u===void 0?void 0:u.video)===null||d===void 0)&&d.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,s;const o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;const l=await Promise.all(o.map(async d=>ns(d)?await d.tool():d)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(u.config.tools=l,e.config&&e.config.tools&&Lg(e.config.tools)){const d=(s=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&s!==void 0?s:{};let h=Object.assign({},d);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),Dg(h),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:h})}return u}async initAfcToolsMap(e){var t,n,s;const o=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(ns(l)){const u=l,d=await u.tool();for(const h of(s=d.functionDeclarations)!==null&&s!==void 0?s:[]){if(!h.name)throw new Error("Function declaration name is required.");if(o.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);o.set(h.name,u)}}return o}async processAfcStream(e){var t,n,s;const o=(s=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&s!==void 0?s:Lp;let l=!1,u=0;const d=await this.initAfcToolsMap(e);return(function(h,p,v){var y,A;return ts(this,arguments,function*(){for(var w,C,T,x;u<o;){l&&(u++,l=!1);const F=yield Be(h.processParamsMaybeAddMcpUsage(v)),H=yield Be(h.generateContentStreamInternal(F)),O=[],K=[];try{for(var I=!0,P=(C=void 0,ir(H)),M;M=yield Be(P.next()),w=M.done,!w;I=!0){x=M.value,I=!1;const q=x;if(yield yield Be(q),q.candidates&&(!((y=q.candidates[0])===null||y===void 0)&&y.content)){K.push(q.candidates[0].content);for(const J of(A=q.candidates[0].content.parts)!==null&&A!==void 0?A:[])if(u<o&&J.functionCall){if(!J.functionCall.name)throw new Error("Function call name was not returned by the model.");if(p.has(J.functionCall.name)){const j=yield Be(p.get(J.functionCall.name).callTool([J.functionCall]));O.push(...j)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${J.functionCall.name}`)}}}}catch(q){C={error:q}}finally{try{!I&&!w&&(T=P.return)&&(yield Be(T.call(P)))}finally{if(C)throw C.error}}if(O.length>0){l=!0;const q=new Ks;q.candidates=[{content:{role:"user",parts:O}}],yield yield Be(q);const J=[];J.push(...K),J.push({role:"user",parts:O});const j=Yt(v.contents).concat(J);v.contents=j}else break}})})(this,d,e)}async generateContentInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=Rp(this.apiClient,e);return u=ne("{model}:generateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=Pp(p),y=new Ks;return Object.assign(y,v),y})}else{const h=Ip(this.apiClient,e);return u=ne("{model}:generateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=bp(p),y=new Ks;return Object.assign(y,v),y})}}async generateContentStreamInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=Rp(this.apiClient,e);return u=ne("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(v){return ts(this,arguments,function*(){var y,A,w,C;try{for(var T=!0,x=ir(v),I;I=yield Be(x.next()),y=I.done,!y;T=!0){C=I.value,T=!1;const P=C,M=Pp(yield Be(P.json()));M.sdkHttpResponse={headers:P.headers};const F=new Ks;Object.assign(F,M),yield yield Be(F)}}catch(P){A={error:P}}finally{try{!T&&!y&&(w=x.return)&&(yield Be(w.call(x)))}finally{if(A)throw A.error}}})})}else{const h=Ip(this.apiClient,e);return u=ne("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(v){return ts(this,arguments,function*(){var y,A,w,C;try{for(var T=!0,x=ir(v),I;I=yield Be(x.next()),y=I.done,!y;T=!0){C=I.value,T=!1;const P=C,M=bp(yield Be(P.json()));M.sdkHttpResponse={headers:P.headers};const F=new Ks;Object.assign(F,M),yield yield Be(F)}}catch(P){A={error:P}}finally{try{!T&&!y&&(w=x.return)&&(yield Be(w.call(x)))}finally{if(A)throw A.error}}})})}}async embedContent(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=PE(this.apiClient,e);return u=ne("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=NE(p),y=new hp;return Object.assign(y,v),y})}else{const h=bE(this.apiClient,e);return u=ne("{model}:batchEmbedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=ME(p),y=new hp;return Object.assign(y,v),y})}}async generateImagesInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=GE(this.apiClient,e);return u=ne("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=qE(p),y=new fp;return Object.assign(y,v),y})}else{const h=VE(this.apiClient,e);return u=ne("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=zE(p),y=new fp;return Object.assign(y,v),y})}}async editImageInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const u=xE(this.apiClient,e);return o=ne("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=kE(d),p=new Wy;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const u=BA(this.apiClient,e);return o=ne("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=OA(d),p=new Yy;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const u=AA(this.apiClient,e);return o=ne("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=wA(d),p=new Ky;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const u=IA(this.apiClient,e);return o=ne("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=RA(d),p=new Jy;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=aA(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>wu(p))}else{const h=oA(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Au(p))}}async listInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=pA(this.apiClient,e);return u=ne("{models_url}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=mA(p),y=new pp;return Object.assign(y,v),y})}else{const h=fA(this.apiClient,e);return u=ne("{models_url}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=gA(p),y=new pp;return Object.assign(y,v),y})}}async update(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=UA(this.apiClient,e);return u=ne("{model}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>wu(p))}else{const h=FA(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Au(p))}}async delete(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=wE(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=CE(p),y=new gp;return Object.assign(y,v),y})}else{const h=AE(this.apiClient,e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=SE(p),y=new gp;return Object.assign(y,v),y})}}async countTokens(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=yE(this.apiClient,e);return u=ne("{model}:countTokens",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=EE(p),y=new mp;return Object.assign(y,v),y})}else{const h=vE(this.apiClient,e);return u=ne("{model}:countTokens",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=_E(p),y=new mp;return Object.assign(y,v),y})}}async computeTokens(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const u=cE(this.apiClient,e);return o=ne("{model}:computeTokens",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=dE(d),p=new Xy;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=XE(this.apiClient,e);return u=ne("{model}:predictLongRunning",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const v=KE(p),y=new Uo;return Object.assign(y,v),y})}else{const h=JE(this.apiClient,e);return u=ne("{model}:predictLongRunning",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const v=YE(p),y=new Uo;return Object.assign(y,v),y})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ew extends wi{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=zy(e);return u=ne("{operationName}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l}else{const h=Gy(e);return u=ne("{operationName}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l}}async fetchPredictVideosOperationInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const u=Dy(e);return o=ne("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Aw(i){const e={},t=f(i,["data"]);if(t!=null&&g(e,["data"],t),f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function ww(i){const e={},t=f(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>bw(o))),g(e,["parts"],s)}const n=f(i,["role"]);return n!=null&&g(e,["role"],n),e}function Sw(i,e,t){const n={},s=f(e,["expireTime"]);t!==void 0&&s!=null&&g(t,["expireTime"],s);const o=f(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&g(t,["newSessionExpireTime"],o);const l=f(e,["uses"]);t!==void 0&&l!=null&&g(t,["uses"],l);const u=f(e,["liveConnectConstraints"]);t!==void 0&&u!=null&&g(t,["bidiGenerateContentSetup"],Rw(i,u));const d=f(e,["lockAdditionalFields"]);return t!==void 0&&d!=null&&g(t,["fieldMask"],d),n}function Cw(i,e){const t={},n=f(e,["config"]);return n!=null&&g(t,["config"],Sw(i,n,t)),t}function Tw(i){const e={};if(f(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(i,["fileUri"]);t!=null&&g(e,["fileUri"],t);const n=f(i,["mimeType"]);return n!=null&&g(e,["mimeType"],n),e}function xw(i){const e={};if(f(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(i,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function kw(i){const e={};if(f(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const t=f(i,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function Iw(i,e){const t={},n=f(i,["generationConfig"]);e!==void 0&&n!=null&&g(e,["setup","generationConfig"],n);const s=f(i,["responseModalities"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig","responseModalities"],s);const o=f(i,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);const l=f(i,["topP"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","topP"],l);const u=f(i,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);const d=f(i,["maxOutputTokens"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","maxOutputTokens"],d);const h=f(i,["mediaResolution"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","mediaResolution"],h);const p=f(i,["seed"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","seed"],p);const v=f(i,["speechConfig"]);e!==void 0&&v!=null&&g(e,["setup","generationConfig","speechConfig"],zu(v));const y=f(i,["thinkingConfig"]);e!==void 0&&y!=null&&g(e,["setup","generationConfig","thinkingConfig"],y);const A=f(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=f(i,["systemInstruction"]);e!==void 0&&w!=null&&g(e,["setup","systemInstruction"],ww(gt(w)));const C=f(i,["tools"]);if(e!==void 0&&C!=null){let H=os(C);Array.isArray(H)&&(H=H.map(O=>Mw(rs(O)))),g(e,["setup","tools"],H)}const T=f(i,["sessionResumption"]);e!==void 0&&T!=null&&g(e,["setup","sessionResumption"],Pw(T));const x=f(i,["inputAudioTranscription"]);e!==void 0&&x!=null&&g(e,["setup","inputAudioTranscription"],x);const I=f(i,["outputAudioTranscription"]);e!==void 0&&I!=null&&g(e,["setup","outputAudioTranscription"],I);const P=f(i,["realtimeInputConfig"]);e!==void 0&&P!=null&&g(e,["setup","realtimeInputConfig"],P);const M=f(i,["contextWindowCompression"]);e!==void 0&&M!=null&&g(e,["setup","contextWindowCompression"],M);const F=f(i,["proactivity"]);return e!==void 0&&F!=null&&g(e,["setup","proactivity"],F),t}function Rw(i,e){const t={},n=f(e,["model"]);n!=null&&g(t,["setup","model"],Re(i,n));const s=f(e,["config"]);return s!=null&&g(t,["config"],Iw(s,t)),t}function bw(i){const e={},t=f(i,["functionCall"]);t!=null&&g(e,["functionCall"],t);const n=f(i,["codeExecutionResult"]);n!=null&&g(e,["codeExecutionResult"],n);const s=f(i,["executableCode"]);s!=null&&g(e,["executableCode"],s);const o=f(i,["fileData"]);o!=null&&g(e,["fileData"],Tw(o));const l=f(i,["functionResponse"]);l!=null&&g(e,["functionResponse"],l);const u=f(i,["inlineData"]);u!=null&&g(e,["inlineData"],Aw(u));const d=f(i,["text"]);d!=null&&g(e,["text"],d);const h=f(i,["thought"]);h!=null&&g(e,["thought"],h);const p=f(i,["thoughtSignature"]);p!=null&&g(e,["thoughtSignature"],p);const v=f(i,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function Pw(i){const e={},t=f(i,["handle"]);if(t!=null&&g(e,["handle"],t),f(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Mw(i){const e={},t=f(i,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),g(e,["functionDeclarations"],h)}if(f(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=f(i,["googleSearchRetrieval"]);n!=null&&g(e,["googleSearchRetrieval"],n);const s=f(i,["googleMaps"]);s!=null&&g(e,["googleMaps"],xw(s));const o=f(i,["computerUse"]);o!=null&&g(e,["computerUse"],o);const l=f(i,["codeExecution"]);if(l!=null&&g(e,["codeExecution"],l),f(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=f(i,["googleSearch"]);u!=null&&g(e,["googleSearch"],kw(u));const d=f(i,["urlContext"]);return d!=null&&g(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nw(i){const e=[];for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const n=i[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const s=Object.keys(n).map(o=>`${t}.${o}`);e.push(...s)}else e.push(t)}return e.join(",")}function Lw(i,e){let t=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const o=n.setup;typeof o=="object"&&o!==null?(i.bidiGenerateContentSetup=o,t=o):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const s=i.fieldMask;if(t){const o=Nw(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)o?i.fieldMask=o:delete i.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];s.length>0&&(u=s.map(h=>l.includes(h)?`generationConfig.${h}`:h));const d=[];o&&d.push(o),u.length>0&&d.push(...u),d.length>0?i.fieldMask=d.join(","):delete i.fieldMask}else delete i.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?i.fieldMask=s.join(","):delete i.fieldMask;return i}class Dw extends wi{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=Cw(this.apiClient,e);o=ne("auth_tokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query;const d=Lw(u,e.config);return s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fw(i,e){const t={},n=f(i,["name"]);return n!=null&&g(t,["_url","name"],n),t}function Uw(i,e){const t={},n=f(i,["name"]);return n!=null&&g(t,["_url","name"],n),t}function Hw(i,e,t){const n={};if(f(i,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=f(i,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&g(e,["displayName"],s),f(i,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=f(i,["epochCount"]);e!==void 0&&o!=null&&g(e,["tuningTask","hyperparameters","epochCount"],o);const l=f(i,["learningRateMultiplier"]);if(l!=null&&g(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),f(i,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(i,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(i,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=f(i,["batchSize"]);e!==void 0&&u!=null&&g(e,["tuningTask","hyperparameters","batchSize"],u);const d=f(i,["learningRate"]);if(e!==void 0&&d!=null&&g(e,["tuningTask","hyperparameters","learningRate"],d),f(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(i,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function Bw(i,e,t){const n={};let s=f(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const A=f(i,["validationDataset"]);e!==void 0&&A!=null&&g(e,["supervisedTuningSpec"],Up(A))}else if(s==="PREFERENCE_TUNING"){const A=f(i,["validationDataset"]);e!==void 0&&A!=null&&g(e,["preferenceOptimizationSpec"],Up(A))}const o=f(i,["tunedModelDisplayName"]);e!==void 0&&o!=null&&g(e,["tunedModelDisplayName"],o);const l=f(i,["description"]);e!==void 0&&l!=null&&g(e,["description"],l);let u=f(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const A=f(i,["epochCount"]);e!==void 0&&A!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],A)}else if(u==="PREFERENCE_TUNING"){const A=f(i,["epochCount"]);e!==void 0&&A!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],A)}let d=f(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const A=f(i,["learningRateMultiplier"]);e!==void 0&&A!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],A)}else if(d==="PREFERENCE_TUNING"){const A=f(i,["learningRateMultiplier"]);e!==void 0&&A!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],A)}let h=f(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const A=f(i,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],A)}else if(h==="PREFERENCE_TUNING"){const A=f(i,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&g(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],A)}let p=f(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const A=f(i,["adapterSize"]);e!==void 0&&A!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],A)}else if(p==="PREFERENCE_TUNING"){const A=f(i,["adapterSize"]);e!==void 0&&A!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],A)}if(f(i,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(i,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const v=f(i,["labels"]);e!==void 0&&v!=null&&g(e,["labels"],v);const y=f(i,["beta"]);return e!==void 0&&y!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","beta"],y),n}function Ow(i,e){const t={},n=f(i,["baseModel"]);n!=null&&g(t,["baseModel"],n);const s=f(i,["preTunedModel"]);s!=null&&g(t,["preTunedModel"],s);const o=f(i,["trainingDataset"]);o!=null&&Qw(o);const l=f(i,["config"]);return l!=null&&Hw(l,t),t}function Vw(i,e){const t={},n=f(i,["baseModel"]);n!=null&&g(t,["baseModel"],n);const s=f(i,["preTunedModel"]);s!=null&&g(t,["preTunedModel"],s);const o=f(i,["trainingDataset"]);o!=null&&Zw(o,t,e);const l=f(i,["config"]);return l!=null&&Bw(l,t,e),t}function Gw(i,e){const t={},n=f(i,["name"]);return n!=null&&g(t,["_url","name"],n),t}function zw(i,e){const t={},n=f(i,["name"]);return n!=null&&g(t,["_url","name"],n),t}function qw(i,e,t){const n={},s=f(i,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const o=f(i,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);const l=f(i,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),n}function $w(i,e,t){const n={},s=f(i,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const o=f(i,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);const l=f(i,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),n}function Ww(i,e){const t={},n=f(i,["config"]);return n!=null&&qw(n,t),t}function Yw(i,e){const t={},n=f(i,["config"]);return n!=null&&$w(n,t),t}function Kw(i,e){const t={},n=f(i,["sdkHttpResponse"]);n!=null&&g(t,["sdkHttpResponse"],n);const s=f(i,["nextPageToken"]);s!=null&&g(t,["nextPageToken"],s);const o=f(i,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Fg(u))),g(t,["tuningJobs"],l)}return t}function Jw(i,e){const t={},n=f(i,["sdkHttpResponse"]);n!=null&&g(t,["sdkHttpResponse"],n);const s=f(i,["nextPageToken"]);s!=null&&g(t,["nextPageToken"],s);const o=f(i,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Cu(u))),g(t,["tuningJobs"],l)}return t}function Xw(i,e){const t={},n=f(i,["name"]);n!=null&&g(t,["model"],n);const s=f(i,["name"]);return s!=null&&g(t,["endpoint"],s),t}function Qw(i,e){const t={};if(f(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(i,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=f(i,["examples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),g(t,["examples","examples"],s)}return t}function Zw(i,e,t){const n={};let s=f(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=f(i,["gcsUri"]);e!==void 0&&l!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=f(i,["gcsUri"]);e!==void 0&&l!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let o=f(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const l=f(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(o==="PREFERENCE_TUNING"){const l=f(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(f(i,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Fg(i,e){const t={},n=f(i,["sdkHttpResponse"]);n!=null&&g(t,["sdkHttpResponse"],n);const s=f(i,["name"]);s!=null&&g(t,["name"],s);const o=f(i,["state"]);o!=null&&g(t,["state"],vg(o));const l=f(i,["createTime"]);l!=null&&g(t,["createTime"],l);const u=f(i,["tuningTask","startTime"]);u!=null&&g(t,["startTime"],u);const d=f(i,["tuningTask","completeTime"]);d!=null&&g(t,["endTime"],d);const h=f(i,["updateTime"]);h!=null&&g(t,["updateTime"],h);const p=f(i,["description"]);p!=null&&g(t,["description"],p);const v=f(i,["baseModel"]);v!=null&&g(t,["baseModel"],v);const y=f(i,["_self"]);return y!=null&&g(t,["tunedModel"],Xw(y)),t}function Cu(i,e){const t={},n=f(i,["sdkHttpResponse"]);n!=null&&g(t,["sdkHttpResponse"],n);const s=f(i,["name"]);s!=null&&g(t,["name"],s);const o=f(i,["state"]);o!=null&&g(t,["state"],vg(o));const l=f(i,["createTime"]);l!=null&&g(t,["createTime"],l);const u=f(i,["startTime"]);u!=null&&g(t,["startTime"],u);const d=f(i,["endTime"]);d!=null&&g(t,["endTime"],d);const h=f(i,["updateTime"]);h!=null&&g(t,["updateTime"],h);const p=f(i,["error"]);p!=null&&g(t,["error"],p);const v=f(i,["description"]);v!=null&&g(t,["description"],v);const y=f(i,["baseModel"]);y!=null&&g(t,["baseModel"],y);const A=f(i,["tunedModel"]);A!=null&&g(t,["tunedModel"],A);const w=f(i,["preTunedModel"]);w!=null&&g(t,["preTunedModel"],w);const C=f(i,["supervisedTuningSpec"]);C!=null&&g(t,["supervisedTuningSpec"],C);const T=f(i,["preferenceOptimizationSpec"]);T!=null&&g(t,["preferenceOptimizationSpec"],T);const x=f(i,["tuningDataStats"]);x!=null&&g(t,["tuningDataStats"],x);const I=f(i,["encryptionSpec"]);I!=null&&g(t,["encryptionSpec"],I);const P=f(i,["partnerModelTuningSpec"]);P!=null&&g(t,["partnerModelTuningSpec"],P);const M=f(i,["customBaseModel"]);M!=null&&g(t,["customBaseModel"],M);const F=f(i,["experiment"]);F!=null&&g(t,["experiment"],F);const H=f(i,["labels"]);H!=null&&g(t,["labels"],H);const O=f(i,["outputUri"]);O!=null&&g(t,["outputUri"],O);const K=f(i,["pipelineJob"]);K!=null&&g(t,["pipelineJob"],K);const q=f(i,["serviceAccount"]);q!=null&&g(t,["serviceAccount"],q);const J=f(i,["tunedModelDisplayName"]);J!=null&&g(t,["tunedModelDisplayName"],J);const j=f(i,["veoTuningSpec"]);return j!=null&&g(t,["veoTuningSpec"],j),t}function jw(i,e){const t={},n=f(i,["sdkHttpResponse"]);n!=null&&g(t,["sdkHttpResponse"],n);const s=f(i,["name"]);s!=null&&g(t,["name"],s);const o=f(i,["metadata"]);o!=null&&g(t,["metadata"],o);const l=f(i,["done"]);l!=null&&g(t,["done"],l);const u=f(i,["error"]);return u!=null&&g(t,["error"],u),t}function Up(i,e){const t={},n=f(i,["gcsUri"]);n!=null&&g(t,["validationDatasetUri"],n);const s=f(i,["vertexDatasetResource"]);return s!=null&&g(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eS extends wi{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new lr(yi.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.tune=async t=>{var n;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((n=t.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},t),{preTunedModel:s});return o.baseModel=void 0,await this.tuneInternal(o)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),o=await this.tuneMldevInternal(s);let l="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?l=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(l=o.name.split("/operations/")[0]),{name:l,state:vu.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=zw(e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>Cu(p))}else{const h=Gw(e);return u=ne("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>Fg(p))}}async listInternal(e){var t,n,s,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const h=Yw(e);return u=ne("tuningJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=Jw(p),y=new vp;return Object.assign(y,v),y})}else{const h=Ww(e);return u=ne("tunedModels",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:p.headers},y})),l.then(p=>{const v=Kw(p),y=new vp;return Object.assign(y,v),y})}}async cancel(e){var t,n,s,o;let l="",u={};if(this.apiClient.isVertexAI()){const d=Uw(e);l=ne("{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const d=Fw(e);l=ne("{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async tuneInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const u=Vw(e,e);return o=ne("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>Cu(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ow(e);return o=ne("tunedModels",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>jw(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tS{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const nS=1024*1024*8,iS=3,sS=1e3,rS=2,lu="x-goog-upload-status";async function oS(i,e,t){var n,s,o;let l=0,u=0,d=new yu(new Response),h="upload";for(l=i.size;u<l;){const v=Math.min(nS,l-u),y=i.slice(u,u+v);u+v>=l&&(h+=", finalize");let A=0,w=sS;for(;A<iS&&(d=await t.request({path:"",body:y,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(u),"Content-Length":String(v)}}}),!(!((n=d?.headers)===null||n===void 0)&&n[lu]));)A++,await lS(w),w=w*rS;if(u+=v,((s=d?.headers)===null||s===void 0?void 0:s[lu])!=="active")break;if(l<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const p=await d?.json();if(((o=d?.headers)===null||o===void 0?void 0:o[lu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return p.file}async function aS(i){return{size:i.size,type:i.type}}function lS(i){return new Promise(e=>setTimeout(e,i))}class uS{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await oS(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await aS(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cS{create(e,t,n){return new dS(e,t,n)}}class dS{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Hp="x-goog-api-key";class hS{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(Hp)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Hp,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fS="gl-node/";class uu{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=Ny(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;const s=new hS(this.apiKey);this.apiClient=new jA({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:fS+"web",uploader:new uS,downloader:new tS}),this.models=new _w(this.apiClient),this.live=new hw(this.apiClient,s,new cS),this.batches=new Z0(this.apiClient),this.chats=new b_(this.models,this.apiClient),this.caches=new k_(this.apiClient),this.files=new O_(this.apiClient),this.operations=new Ew(this.apiClient),this.authTokens=new Dw(this.apiClient),this.tunings=new eS(this.apiClient)}}const pS="modulepreload",gS=function(i){return"/"+i},Bp={},xo=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let h=function(p){return Promise.all(p.map(v=>Promise.resolve(v).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};var l=h;document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");s=h(t.map(p=>{if(p=gS(p),p in Bp)return;Bp[p]=!0;const v=p.endsWith(".css"),y=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${y}`))return;const A=document.createElement("link");if(A.rel=v?"stylesheet":pS,v||(A.as="script"),A.crossOrigin="",A.href=p,d&&A.setAttribute("nonce",d),document.head.appendChild(A),v)return new Promise((w,C)=>{A.addEventListener("load",w),A.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return s.then(u=>{for(const d of u||[])d.status==="rejected"&&o(d.reason);return e().catch(o)})};var sr={};sr.d=(i,e)=>{for(var t in e)sr.o(e,t)&&!sr.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})};sr.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var me=globalThis.pdfjsLib={};sr.d(me,{AbortException:()=>Ci,AnnotationEditorLayer:()=>In,AnnotationEditorParamsType:()=>pe,AnnotationEditorType:()=>Ce,AnnotationEditorUIManager:()=>jn,AnnotationLayer:()=>dT,AnnotationMode:()=>Zn,CMapCompressionType:()=>xu,ColorPicker:()=>gn,DOMSVGFactory:()=>Yu,DrawLayer:()=>ft,FeatureTest:()=>Rt,GlobalWorkerOptions:()=>or,ImageKind:()=>Do,InvalidPDFException:()=>Hg,MissingPDFException:()=>Si,OPS:()=>tn,PDFDataRangeTransport:()=>em,PDFDateString:()=>zg,PDFWorker:()=>Wt,PasswordResponses:()=>_S,PermissionFlag:()=>yS,PixelsPerInch:()=>ss,RenderingCancelledException:()=>Ku,TextLayer:()=>Ht,UnexpectedResponseException:()=>Zo,Util:()=>re,VerbosityLevel:()=>Jo,XfaLayer:()=>nm,build:()=>$C,createValidAbsoluteUrl:()=>SS,fetchData:()=>sa,getDocument:()=>FC,getFilenameFromUrl:()=>NS,getPdfFilenameFromUrl:()=>LS,getXfaPageViewport:()=>DS,isDataScheme:()=>ra,isPdfFile:()=>Ju,noContextMenu:()=>bt,normalizeUnicode:()=>RS,setLayerDimensions:()=>_i,shadow:()=>xe,version:()=>qC});const mt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Ug=[1,0,0,1,0,0],Tu=[.001,0,0,.001,0,0],mS=1e7,cu=1.35,Ut={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Zn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},vS="pdfjs_internal_editor_",Ce={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},pe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},yS={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},ht={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Do={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},je={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Js={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Jo={ERRORS:0,WARNINGS:1,INFOS:5},xu={NONE:0,BINARY:1},tn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},_S={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Xo=Jo.WARNINGS;function ES(i){Number.isInteger(i)&&(Xo=i)}function AS(){return Xo}function Qo(i){Xo>=Jo.INFOS&&console.log(`Info: ${i}`)}function Se(i){Xo>=Jo.WARNINGS&&console.log(`Warning: ${i}`)}function Le(i){throw new Error(i)}function tt(i,e){i||Le(e)}function wS(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function SS(i,e=null,t=null){if(!i)return null;try{if(t&&typeof i=="string"&&(t.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),t.tryConvertEncoding))try{i=IS(i)}catch{}const n=e?new URL(i,e):new URL(i);if(wS(n))return n}catch{}return null}function xe(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const ti=(function(){function e(t,n){this.constructor===e&&Le("Cannot initialize BaseException."),this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class ku extends ti{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Iu extends ti{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Hg extends ti{constructor(e){super(e,"InvalidPDFException")}}class Si extends ti{constructor(e){super(e,"MissingPDFException")}}class Zo extends ti{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class CS extends ti{constructor(e){super(e,"FormatError")}}class Ci extends ti{constructor(e){super(e,"AbortException")}}function Bg(i){(typeof i!="object"||i?.length===void 0)&&Le("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const n=[];for(let s=0;s<e;s+=t){const o=Math.min(s+t,e),l=i.subarray(s,o);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function jo(i){typeof i!="string"&&Le("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function TS(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function $u(i){const e=Object.create(null);for(const[t,n]of i)e[t]=n;return e}function xS(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function kS(){try{return new Function(""),!0}catch{return!1}}class Rt{static get isLittleEndian(){return xe(this,"isLittleEndian",xS())}static get isEvalSupported(){return xe(this,"isEvalSupported",kS())}static get isOffscreenCanvasSupported(){return xe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?xe(this,"platform",{isMac:navigator.platform.includes("Mac")}):xe(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){return xe(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const du=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));class re{static makeHexColor(e,t,n){return`#${du[e]}${du[t]}${du[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const n=e[0]*t[0]+e[1]*t[2]+t[4],s=e[0]*t[1]+e[1]*t[3]+t[5];return[n,s]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2],s=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,o=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[s,o]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),s=this.applyTransform(e.slice(2,4),t),o=this.applyTransform([e[0],e[3]],t),l=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],s[0],o[0],l[0]),Math.min(n[1],s[1],o[1],l[1]),Math.max(n[0],s[0],o[0],l[0]),Math.max(n[1],s[1],o[1],l[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],s=e[0]*t[1]+e[1]*t[3],o=e[2]*t[0]+e[3]*t[2],l=e[2]*t[1]+e[3]*t[3],u=(n+l)/2,d=Math.sqrt((n+l)**2-4*(n*l-o*s))/2,h=u+d||1,p=u-d||1;return[Math.sqrt(h),Math.sqrt(p)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>l?null:[n,o,s,l]}static#e(e,t,n,s,o,l,u,d,h,p){if(h<=0||h>=1)return;const v=1-h,y=h*h,A=y*h,w=v*(v*(v*e+3*h*t)+3*y*n)+A*s,C=v*(v*(v*o+3*h*l)+3*y*u)+A*d;p[0]=Math.min(p[0],w),p[1]=Math.min(p[1],C),p[2]=Math.max(p[2],w),p[3]=Math.max(p[3],C)}static#t(e,t,n,s,o,l,u,d,h,p,v,y){if(Math.abs(h)<1e-12){Math.abs(p)>=1e-12&&this.#e(e,t,n,s,o,l,u,d,-v/p,y);return}const A=p**2-4*v*h;if(A<0)return;const w=Math.sqrt(A),C=2*h;this.#e(e,t,n,s,o,l,u,d,(-p+w)/C,y),this.#e(e,t,n,s,o,l,u,d,(-p-w)/C,y)}static bezierBoundingBox(e,t,n,s,o,l,u,d,h){return h?(h[0]=Math.min(h[0],e,u),h[1]=Math.min(h[1],t,d),h[2]=Math.max(h[2],e,u),h[3]=Math.max(h[3],t,d)):h=[Math.min(e,u),Math.min(t,d),Math.max(e,u),Math.max(t,d)],this.#t(e,n,o,u,t,s,l,d,3*(-e+3*(n-o)+u),6*(e-2*n+o),3*(n-e),h),this.#t(e,n,o,u,t,s,l,d,3*(-t+3*(s-l)+d),6*(t-2*s+l),3*(s-t),h),h}}function IS(i){return decodeURIComponent(escape(i))}let hu=null,Op=null;function RS(i){return hu||(hu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Op=new Map([["ﬅ","ſt"]])),i.replaceAll(hu,(e,t,n)=>t?t.normalize("NFKC"):Op.get(n))}function bS(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(i);else for(let e=0;e<32;e++)i[e]=Math.floor(Math.random()*255);return Bg(i)}const Og="pdfjs_internal_id_",Tn={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};class ea{constructor(){this.constructor===ea&&Le("Cannot initialize BaseFilterFactory.")}addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,o){return"none"}destroy(e=!1){}}class ta{#e=!1;constructor({enableHWA:e=!1}={}){this.constructor===ta&&Le("Cannot initialize BaseCanvasFactory."),this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Le("Abstract method `_createCanvas` called.")}}class na{constructor({baseUrl:e=null,isCompressed:t=!0}){this.constructor===na&&Le("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":""),n=this.isCompressed?xu.BINARY:xu.NONE;return this._fetchData(t,n).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}_fetchData(e,t){Le("Abstract method `_fetchData` called.")}}class ia{constructor({baseUrl:e=null}){this.constructor===ia&&Le("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetchData(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}_fetchData(e){Le("Abstract method `_fetchData` called.")}}class Wu{constructor(){this.constructor===Wu&&Le("Cannot initialize BaseSVGFactory.")}create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Le("Abstract method `_createSVG` called.")}}const kn="http://www.w3.org/2000/svg";class ss{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}class PS extends ea{#e;#t;#n;#s;#r;#i;#o=0;constructor({docId:e,ownerDocument:t=globalThis.document}={}){super(),this.#s=e,this.#r=t}get#l(){return this.#t||=new Map}get#c(){return this.#i||=new Map}get#d(){if(!this.#n){const e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#r.createElementNS(kn,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#r.createElementNS(kn,"defs"),e.append(n),n.append(this.#n),this.#r.body.append(e)}return this.#n}#h(e){if(e.length===1){const d=e[0],h=new Array(256);for(let v=0;v<256;v++)h[v]=d[v]/255;const p=h.join(",");return[p,p,p]}const[t,n,s]=e,o=new Array(256),l=new Array(256),u=new Array(256);for(let d=0;d<256;d++)o[d]=t[d]/255,l[d]=n[d]/255,u[d]=s[d]/255;return[o.join(","),l.join(","),u.join(",")]}#u(e){if(this.#e===void 0){this.#e="";const t=this.#r.URL;t!==this.#r.baseURI&&(ra(t)?Se('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#l.get(e);if(t)return t;const[n,s,o]=this.#h(e),l=e.length===1?n:`${n}${s}${o}`;if(t=this.#l.get(l),t)return this.#l.set(e,t),t;const u=`g_${this.#s}_transfer_map_${this.#o++}`,d=this.#u(u);this.#l.set(e,d),this.#l.set(l,d);const h=this.#g(u);return this.#m(n,s,o,h),d}addHCMFilter(e,t){const n=`${e}-${t}`,s="base";let o=this.#c.get(s);if(o?.key===n||(o?(o.filter?.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},this.#c.set(s,o)),!e||!t))return o.url;const l=this.#_(e);e=re.makeHexColor(...l);const u=this.#_(t);if(t=re.makeHexColor(...u),this.#d.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return o.url;const d=new Array(256);for(let A=0;A<=255;A++){const w=A/255;d[A]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const h=d.join(","),p=`g_${this.#s}_hcm_filter`,v=o.filter=this.#g(p);this.#m(h,h,h,v),this.#p(v);const y=(A,w)=>{const C=l[A]/255,T=u[A]/255,x=new Array(w+1);for(let I=0;I<=w;I++)x[I]=C+I/w*(T-C);return x.join(",")};return this.#m(y(0,5),y(1,5),y(2,5),v),o.url=this.#u(p),o.url}addAlphaFilter(e){let t=this.#l.get(e);if(t)return t;const[n]=this.#h([e]),s=`alpha_${n}`;if(t=this.#l.get(s),t)return this.#l.set(e,t),t;const o=`g_${this.#s}_alpha_map_${this.#o++}`,l=this.#u(o);this.#l.set(e,l),this.#l.set(s,l);const u=this.#g(o);return this.#v(n,u),l}addLuminosityFilter(e){let t=this.#l.get(e||"luminosity");if(t)return t;let n,s;if(e?([n]=this.#h([e]),s=`luminosity_${n}`):s="luminosity",t=this.#l.get(s),t)return this.#l.set(e,t),t;const o=`g_${this.#s}_luminosity_map_${this.#o++}`,l=this.#u(o);this.#l.set(e,l),this.#l.set(s,l);const u=this.#g(o);return this.#a(u),e&&this.#v(n,u),l}addHighlightHCMFilter(e,t,n,s,o){const l=`${t}-${n}-${s}-${o}`;let u=this.#c.get(e);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#c.set(e,u)),!t||!n))return u.url;const[d,h]=[t,n].map(this.#_.bind(this));let p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),v=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[y,A]=[s,o].map(this.#_.bind(this));v<p&&([p,v,y,A]=[v,p,A,y]),this.#d.style.color="";const w=(x,I,P)=>{const M=new Array(256),F=(v-p)/P,H=x/255,O=(I-x)/(255*P);let K=0;for(let q=0;q<=P;q++){const J=Math.round(p+q*F),j=H+q*O;for(let le=K;le<=J;le++)M[le]=j;K=J+1}for(let q=K;q<256;q++)M[q]=M[K-1];return M.join(",")},C=`g_${this.#s}_hcm_${e}_filter`,T=u.filter=this.#g(C);return this.#p(T),this.#m(w(y[0],A[0],5),w(y[1],A[1],5),w(y[2],A[2],5),T),u.url=this.#u(C),u.url}destroy(e=!1){e&&this.#c.size!==0||(this.#n&&(this.#n.parentNode.parentNode.remove(),this.#n=null),this.#t&&(this.#t.clear(),this.#t=null),this.#o=0)}#a(e){const t=this.#r.createElementNS(kn,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#p(e){const t=this.#r.createElementNS(kn,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#g(e){const t=this.#r.createElementNS(kn,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#d.append(t),t}#f(e,t,n){const s=this.#r.createElementNS(kn,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)}#m(e,t,n,s){const o=this.#r.createElementNS(kn,"feComponentTransfer");s.append(o),this.#f(o,"feFuncR",e),this.#f(o,"feFuncG",t),this.#f(o,"feFuncB",n)}#v(e,t){const n=this.#r.createElementNS(kn,"feComponentTransfer");t.append(n),this.#f(n,"feFuncA",e)}#_(e){return this.#d.style.color=e,Xu(getComputedStyle(this.#d).getPropertyValue("color"))}}class MS extends ta{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}={}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}async function sa(i,e="text"){if(er(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class Vg extends na{_fetchData(e,t){return sa(e,this.isCompressed?"arraybuffer":"text").then(n=>({cMapData:n instanceof ArrayBuffer?new Uint8Array(n):jo(n),compressionType:t}))}}class Gg extends ia{_fetchData(e){return sa(e,"arraybuffer").then(t=>new Uint8Array(t))}}class Yu extends Wu{_createSVG(e){return document.createElementNS(kn,e)}}class ur{constructor({viewBox:e,scale:t,rotation:n,offsetX:s=0,offsetY:o=0,dontFlip:l=!1}){this.viewBox=e,this.scale=t,this.rotation=n,this.offsetX=s,this.offsetY=o;const u=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let h,p,v,y;switch(n%=360,n<0&&(n+=360),n){case 180:h=-1,p=0,v=0,y=1;break;case 90:h=0,p=1,v=1,y=0;break;case 270:h=0,p=-1,v=-1,y=0;break;case 0:h=1,p=0,v=0,y=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(v=-v,y=-y);let A,w,C,T;h===0?(A=Math.abs(d-e[1])*t+s,w=Math.abs(u-e[0])*t+o,C=(e[3]-e[1])*t,T=(e[2]-e[0])*t):(A=Math.abs(u-e[0])*t+s,w=Math.abs(d-e[1])*t+o,C=(e[2]-e[0])*t,T=(e[3]-e[1])*t),this.transform=[h*t,p*t,v*t,y*t,A-h*t*u-v*t*d,w-p*t*u-y*t*d],this.width=C,this.height=T}get rawDims(){const{viewBox:e}=this;return xe(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:o=!1}={}){return new ur({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}convertToViewportPoint(e,t){return re.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=re.applyTransform([e[0],e[1]],this.transform),n=re.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return re.applyInverseTransform([e,t],this.transform)}}class Ku extends ti{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function ra(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function Ju(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function NS(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function LS(i,e="document.pdf"){if(typeof i!="string")return e;if(ra(i))return Se('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=t.exec(i);let o=n.exec(s[1])||n.exec(s[2])||n.exec(s[3]);if(o&&(o=o[0],o.includes("%")))try{o=n.exec(decodeURIComponent(o))[0]}catch{}return o||e}class Vp{started=Object.create(null);times=[];time(e){e in this.started&&Se(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Se(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:o}of this.times)e.push(`${n.padEnd(t)} ${o-s}ms
`);return e.join("")}}function er(i,e){try{const{protocol:t}=e?new URL(i,e):new URL(i);return t==="http:"||t==="https:"}catch{return!1}}function bt(i){i.preventDefault()}let Gp;class zg{static toDateObject(e){if(!e||typeof e!="string")return null;Gp||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=Gp.exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(t[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(t[6],10);d=d>=0&&d<=59?d:0;const h=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let v=parseInt(t[9],10)||0;return v=v>=0&&v<=59?v:0,h==="-"?(l+=p,u+=v):h==="+"&&(l-=p,u-=v),new Date(Date.UTC(n,s,o,l,u,d))}}function DS(i,{scale:e=1,rotation:t=0}){const{width:n,height:s}=i.attributes.style,o=[0,0,parseInt(n),parseInt(s)];return new ur({viewBox:o,scale:e,rotation:t})}function Xu(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Se(`Not a valid color format: "${i}"`),[0,0,0])}function FS(i){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of i.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;i.set(t,Xu(n))}e.remove()}function ze(i){const{a:e,b:t,c:n,d:s,e:o,f:l}=i.getTransform();return[e,t,n,s,o,l]}function xn(i){const{a:e,b:t,c:n,d:s,e:o,f:l}=i.getTransform().invertSelf();return[e,t,n,s,o,l]}function _i(i,e,t=!1,n=!0){if(e instanceof ur){const{pageWidth:s,pageHeight:o}=e.rawDims,{style:l}=i,u=Rt.isCSSRoundSupported,d=`var(--scale-factor) * ${s}px`,h=`var(--scale-factor) * ${o}px`,p=u?`round(${d}, 1px)`:`calc(${d})`,v=u?`round(${h}, 1px)`:`calc(${h})`;!t||e.rotation%180===0?(l.width=p,l.height=v):(l.width=v,l.height=p)}n&&i.setAttribute("data-main-rotation",e.rotation)}class Qu{#e=null;#t=null;#n;#s=null;constructor(e){this.#n=e}render(){const e=this.#e=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;e.addEventListener("contextmenu",bt,{signal:t}),e.addEventListener("pointerdown",Qu.#r,{signal:t});const n=this.#s=document.createElement("div");n.className="buttons",e.append(n);const s=this.#n.toolbarPosition;if(s){const{style:o}=e,l=this.#n._uiManager.direction==="ltr"?1-s[0]:s[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return this.#c(),e}static#r(e){e.stopPropagation()}#i(e){this.#n._focusEventsAllowed=!1,e.preventDefault(),e.stopPropagation()}#o(e){this.#n._focusEventsAllowed=!0,e.preventDefault(),e.stopPropagation()}#l(e){const t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#i.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#o.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",bt,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden")}#c(){const e=document.createElement("button");e.className="delete",e.tabIndex=0,e.setAttribute("data-l10n-id",`pdfjs-editor-remove-${this.#n.editorType}-button`),this.#l(e),e.addEventListener("click",t=>{this.#n._uiManager.delete()},{signal:this.#n._uiManager._signal}),this.#s.append(e)}get#d(){const e=document.createElement("div");return e.className="divider",e}addAltTextButton(e){this.#l(e),this.#s.prepend(e,this.#d)}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#l(t),this.#s.prepend(t,this.#d)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class US{#e=null;#t=null;#n;constructor(e){this.#n=e}#s(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",bt,{signal:this.#n._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#i(),e}#r(e,t){let n=0,s=0;for(const o of e){const l=o.y+o.height;if(l<n)continue;const u=o.x+(t?o.width:0);if(l>n){s=u,n=l;continue}t?u>s&&(s=u):u<s&&(s=u)}return[t?1-s:s,n]}show(e,t,n){const[s,o]=this.#r(t,n),{style:l}=this.#t||=this.#s();e.append(this.#t),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#i(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=this.#n._signal;e.addEventListener("contextmenu",bt,{signal:n}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:n}),this.#e.append(e)}}function Bo(i,e,t){for(const n of t)e.addEventListener(n,i[n].bind(i))}function HS(i){return Math.round(Math.min(255,Math.max(1,255*i))).toString(16).padStart(2,"0")}class BS{#e=0;get id(){return`${vS}${this.#e++}`}}class Zu{#e=bS();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const o=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return xe(this,"_isSVGFittingCanvas",o)}async#s(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(n.url=t,s=await sa(t,"blob")):s=n.file=t,s.type==="image/svg+xml"){const o=Zu._isSVGFittingCanvas,l=new FileReader,u=new Image,d=new Promise((h,p)=>{u.onload=()=>{n.bitmap=u,n.isSvg=!0,h()},l.onload=async()=>{const v=n.svgUrl=l.result;u.src=await o?`${v}#svgView(preserveAspectRatio(none))`:v},u.onerror=l.onerror=p});l.readAsDataURL(s),await d}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){console.error(s),n=null}return this.#n.set(e,n),n&&this.#n.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:s,type:o}=e;return this.#s(`${t}_${n}_${s}_${o}`,e)}async getFromUrl(e){return this.#s(e,e)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);return t?t.bitmap?(t.refCounter+=1,t):t.file?this.getFromFile(t.file):this.getFromUrl(t.url):null}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);t&&(t.refCounter-=1,t.refCounter===0&&(t.bitmap=null))}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class OS{#e=[];#t=!1;#n;#s=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:n,mustExec:s,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(s&&e(),this.#t)return;const d={cmd:e,undo:t,post:n,type:o};if(this.#s===-1){this.#e.length>0&&(this.#e.length=0),this.#s=0,this.#e.push(d);return}if(l&&this.#e[this.#s].type===o){u&&(d.undo=this.#e[this.#s].undo),this.#e[this.#s]=d;return}const h=this.#s+1;h===this.#n?this.#e.splice(0,1):(this.#s=h,h<this.#e.length&&this.#e.splice(h)),this.#e.push(d)}undo(){if(this.#s===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#s];e(),t?.(),this.#t=!1,this.#s-=1}redo(){if(this.#s<this.#e.length-1){this.#s+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#s];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#e.length-1}destroy(){this.#e=null}}class cr{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Rt.platform;for(const[n,s,o={}]of e)for(const l of n){const u=l.startsWith("mac+");t&&u?(this.callbacks.set(l.slice(4),{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1))):!t&&!u&&(this.callbacks.set(l,{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:s,options:{bubbles:o=!1,args:l=[],checker:u=null}}=n;u&&!u(e,t)||(s.bind(e,...l,t)(),o||(t.stopPropagation(),t.preventDefault()))}}class ju{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return FS(e),xe(this,"_colors",e)}convert(e){const t=Xu(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((o,l)=>o===t[l]))return ju._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?re.makeHexColor(...t):e}}class jn{#e=new AbortController;#t=null;#n=new Map;#s=new Map;#r=null;#i=null;#o=null;#l=new OS;#c=0;#d=new Set;#h=null;#u=null;#a=new Set;#p=!1;#g=!1;#f=null;#m=null;#v=null;#_=!1;#E=null;#w=new BS;#S=!1;#b=!1;#k=null;#I=null;#C=null;#A=Ce.NONE;#y=new Set;#T=null;#x=null;#M=null;#P=this.blur.bind(this);#D=this.focus.bind(this);#N=this.copy.bind(this);#F=this.cut.bind(this);#L=this.paste.bind(this);#q=this.keydown.bind(this);#$=this.keyup.bind(this);#G=this.onEditingAction.bind(this);#O=this.onPageChanging.bind(this);#U=this.onScaleChanging.bind(this);#J=this.onRotationChanging.bind(this);#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#H=null;#V=null;#Q=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=jn.prototype,t=l=>l.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return xe(this,"_keyboardManager",new cr([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#V.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:t}]]))}constructor(e,t,n,s,o,l,u,d,h,p){this._signal=this.#e.signal,this.#V=e,this.#Q=t,this.#r=n,this._eventBus=s,this._eventBus._on("editingaction",this.#G),this._eventBus._on("pagechanging",this.#O),this._eventBus._on("scalechanging",this.#U),this._eventBus._on("rotationchanging",this.#J),this.#oe(),this.#ce(),this.#j(),this.#i=o.annotationStorage,this.#f=o.filterFactory,this.#x=l,this.#v=u||null,this.#p=d,this.#g=h,this.#C=p||null,this.viewParameters={realScale:ss.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#e?.abort(),this.#e=null,this._signal=null,this._eventBus._off("editingaction",this.#G),this._eventBus._off("pagechanging",this.#O),this._eventBus._off("scalechanging",this.#U),this._eventBus._off("rotationchanging",this.#J);for(const e of this.#s.values())e.destroy();this.#s.clear(),this.#n.clear(),this.#a.clear(),this.#t=null,this.#y.clear(),this.#l.destroy(),this.#r?.destroy(),this.#E?.hide(),this.#E=null,this.#m&&(clearTimeout(this.#m),this.#m=null),this.#H&&(clearTimeout(this.#H),this.#H=null)}async mlGuess(e){return this.#C?.guess(e)||null}async isMLEnabledFor(e){return!!await this.#C?.isEnabledFor(e)}get useNewAltTextFlow(){return this.#g}get hcmFilter(){return xe(this,"hcmFilter",this.#x?this.#f.addHCMFilter(this.#x.foreground,this.#x.background):"none")}get direction(){return xe(this,"direction",getComputedStyle(this.#V).direction)}get highlightColors(){return xe(this,"highlightColors",this.#v?new Map(this.#v.split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return xe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setMainHighlightColorPicker(e){this.#I=e}editAltText(e){this.#r?.editAltText(this,e)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onPageChanging({pageNumber:e}){this.#c=e-1}focusMainContainer(){this.#V.focus()}findParent(e,t){for(const n of this.#s.values()){const{x:s,y:o,width:l,height:u}=n.div.getBoundingClientRect();if(e>=s&&e<=s+l&&t>=o&&t<=o+u)return n}return null}disableUserSelect(e=!1){this.#Q.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#a.add(e)}removeShouldRescale(e){this.#a.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*ss.PDF_TO_CSS_UNITS;for(const t of this.#a)t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Y({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#Z(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#s.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:s,focusNode:o,focusOffset:l}=t,u=t.toString(),h=this.#Y(t).closest(".textLayer"),p=this.getSelectionBoxes(h);if(!p)return;t.empty();const v=this.#Z(h),y=this.#A===Ce.NONE,A=()=>{v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:p,anchorNode:n,anchorOffset:s,focusNode:o,focusOffset:l,text:u}),y&&this.showAllEditors("highlight",!0,!0)};if(y){this.switchToMode(Ce.HIGHLIGHT,A);return}A()}#se(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#Y(e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#E||=new US(this),this.#E.show(n,s,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#i&&!this.#i.has(e.id)&&this.#i.setValue(e.id,e)}#re(){const e=document.getSelection();if(!e||e.isCollapsed){this.#T&&(this.#E?.hide(),this.#T=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#T)return;const s=this.#Y(e).closest(".textLayer");if(!s){this.#T&&(this.#E?.hide(),this.#T=null,this.#R({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#T=t,this.#R({hasSelectedText:!0}),!(this.#A!==Ce.HIGHLIGHT&&this.#A!==Ce.NONE)&&(this.#A===Ce.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#_=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#A===Ce.HIGHLIGHT?this.#Z(s):null;o?.toggleDrawing();const l=this._signal,u=d=>{d.type==="pointerup"&&d.button!==0||(o?.toggleDrawing(!0),window.removeEventListener("pointerup",u),window.removeEventListener("blur",u),d.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",u,{signal:l}),window.addEventListener("blur",u,{signal:l})}}#K(e=""){this.#A===Ce.HIGHLIGHT?this.highlightSelection(e):this.#p&&this.#se()}#oe(){document.addEventListener("selectionchange",this.#re.bind(this),{signal:this._signal})}#ae(){const e=this._signal;window.addEventListener("focus",this.#D,{signal:e}),window.addEventListener("blur",this.#P,{signal:e})}#le(){window.removeEventListener("focus",this.#D),window.removeEventListener("blur",this.#P)}blur(){if(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#y)if(t.div.contains(e)){this.#k=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#k)return;const[e,t]=this.#k;this.#k=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#j(){const e=this._signal;window.addEventListener("keydown",this.#q,{signal:e}),window.addEventListener("keyup",this.#$,{signal:e})}#ue(){window.removeEventListener("keydown",this.#q),window.removeEventListener("keyup",this.#$)}#ee(){const e=this._signal;document.addEventListener("copy",this.#N,{signal:e}),document.addEventListener("cut",this.#F,{signal:e}),document.addEventListener("paste",this.#L,{signal:e})}#te(){document.removeEventListener("copy",this.#N),document.removeEventListener("cut",this.#F),document.removeEventListener("paste",this.#L)}#ce(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#j(),this.#ee()}removeEditListeners(){this.#ue(),this.#te()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#y){const s=n.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:t}=e;for(const o of t.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){Se(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const o=[];for(const d of n){const h=s.deserialize(d);if(!h)return;o.push(h)}const l=()=>{for(const d of o)this.#ne(d);this.#ie(o)},u=()=>{for(const d of o)d.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(o){Se(`paste: "${o.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==Ce.NONE&&!this.isEditorHandlingKeyboard&&jn._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#K("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#R(e){Object.entries(e).some(([n,s])=>this.#X[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,e)}),this.#A===Ce.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#B([[pe.HIGHLIGHT_FREE,!0]]))}#B(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ae(),this.#ee(),this.#R({isEditing:this.#A!==Ce.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#te(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#u){this.#u=e;for(const t of this.#u)this.#B(t.defaultPropertiesToUpdate)}}getId(){return this.#w.id}get currentLayer(){return this.#s.get(this.#c)}getLayer(e){return this.#s.get(e)}get currentPageIndex(){return this.#c}addLayer(e){this.#s.set(e.pageIndex,e),this.#S?e.enable():e.disable()}removeLayer(e){this.#s.delete(e.pageIndex)}updateMode(e,t=null,n=!1){if(this.#A!==e){if(this.#A=e,e===Ce.NONE){this.setEditingState(!1),this.#he();return}this.setEditingState(!0),this.#de(),this.unselectAll();for(const s of this.#s.values())s.updateMode(e);if(!t&&n){this.addNewEditorFromKeyboard();return}if(t){for(const s of this.#n.values())if(s.annotationElementId===t){this.setSelected(s),s.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#u){switch(e){case pe.CREATE:this.currentLayer.addNewEditor();return;case pe.HIGHLIGHT_DEFAULT_COLOR:this.#I?.updateColor(t);break;case pe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#M||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const n of this.#y)n.updateParams(e,t);for(const n of this.#u)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const o of this.#n.values())o.editorType===e&&o.show(t);(this.#M?.get(pe.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#B([[pe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#b!==e){this.#b=e;for(const t of this.#s.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}#de(){if(!this.#S){this.#S=!0;for(const e of this.#s.values())e.enable();for(const e of this.#n.values())e.enable()}}#he(){if(this.unselectAll(),this.#S){this.#S=!1;for(const e of this.#s.values())e.disable();for(const e of this.#n.values())e.disable()}}getEditors(e){const t=[];for(const n of this.#n.values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#m&&clearTimeout(this.#m),this.#m=setTimeout(()=>{this.focusMainContainer(),this.#m=null},0)),this.#n.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#d.has(e.annotationElementId))&&this.#i?.remove(e.id)}addDeletedAnnotationElement(e){this.#d.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#d.has(e)}removeDeletedAnnotationElement(e){this.#d.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ne(e){const t=this.#s.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#B(e.propertiesToUpdate))}get#fe(){let e=null;for(e of this.#y);return e}updateUI(e){this.#fe===e&&this.#B(e.propertiesToUpdate)}toggleSelected(e){if(this.#y.has(e)){this.#y.delete(e),e.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#y.add(e),e.select(),this.#B(e.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(e){for(const t of this.#y)t!==e&&t.unselect();this.#y.clear(),this.#y.add(e),e.select(),this.#B(e.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(e){return this.#y.has(e)}get firstSelectedEditor(){return this.#y.values().next().value}unselect(e){e.unselect(),this.#y.delete(e),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#y.size!==0}get isEnterHandled(){return this.#y.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#R({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()})}redo(){this.#l.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(e){this.#l.add(e),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}#W(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...this.#y],t=()=>{for(const s of e)s.remove()},n=()=>{for(const s of e)this.#ne(s)};this.addCommands({cmd:t,undo:n,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ie(e){for(const t of this.#y)t.unselect();this.#y.clear();for(const t of e)t.isEmpty()||(this.#y.add(t),t.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#y)e.commit();this.#ie(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#A!==Ce.NONE))&&this.hasSelection){for(const e of this.#y)e.unselect();this.#y.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=e,this.#z[1]+=t;const[s,o]=this.#z,l=[...this.#y],u=1e3;this.#H&&clearTimeout(this.#H),this.#H=setTimeout(()=>{this.#H=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const d of l)this.#n.has(d.id)&&d.translateInPage(s,o)},undo:()=>{for(const d of l)this.#n.has(d.id)&&d.translateInPage(-s,-o)},mustExec:!1})},u);for(const d of l)d.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#h=new Map;for(const e of this.#y)this.#h.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#h)return!1;this.disableUserSelect(!1);const e=this.#h;this.#h=null;let t=!1;for(const[{x:s,y:o,pageIndex:l},u]of e)u.newX=s,u.newY=o,u.newPageIndex=l,t||=s!==u.savedX||o!==u.savedY||l!==u.savedPageIndex;if(!t)return!1;const n=(s,o,l,u)=>{if(this.#n.has(s.id)){const d=this.#s.get(u);d?s._setParentAndPosition(d,o,l):(s.pageIndex=u,s.x=o,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:o,newY:l,newPageIndex:u}]of e)n(s,o,l,u)},undo:()=>{for(const[s,{savedX:o,savedY:l,savedPageIndex:u}]of e)n(s,o,l,u)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#h)for(const n of this.#h.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#y.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#A}get imageManager(){return xe(this,"imageManager",new Zu)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,p=t.rangeCount;h<p;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:s,width:o,height:l}=e.getBoundingClientRect();let u;switch(e.getAttribute("data-main-rotation")){case"90":u=(h,p,v,y)=>({x:(p-s)/l,y:1-(h+v-n)/o,width:y/l,height:v/o});break;case"180":u=(h,p,v,y)=>({x:1-(h+v-n)/o,y:1-(p+y-s)/l,width:v/o,height:y/l});break;case"270":u=(h,p,v,y)=>({x:1-(p+y-s)/l,y:(h-n)/o,width:y/l,height:v/o});break;default:u=(h,p,v,y)=>({x:(h-n)/o,y:(p-s)/l,width:v/o,height:y/l});break}const d=[];for(let h=0,p=t.rangeCount;h<p;h++){const v=t.getRangeAt(h);if(!v.collapsed)for(const{x:y,y:A,width:w,height:C}of v.getClientRects())w===0||C===0||d.push(u(y,A,w,C))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const n=this.#i.getRawValue(t);n&&(this.#A===Ce.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}}class mi{#e="";#t=!1;#n=null;#s=null;#r=null;#i=!1;#o=null;static _l10nPromise=null;constructor(e){this.#o=e}static initialize(e){mi._l10nPromise||=e}async render(){const e=this.#n=document.createElement("button");e.className="altText";const t=await mi._l10nPromise.get("pdfjs-editor-alt-text-button-label");e.textContent=t,e.setAttribute("aria-label",t),e.tabIndex="0";const n=this.#o._uiManager._signal;e.addEventListener("contextmenu",bt,{signal:n}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),this.#o._uiManager.editAltText(this.#o)};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(this.#i=!0,s(o))},{signal:n}),await this.#l(),e}finish(){this.#n&&(this.#n.focus({focusVisible:this.#i}),this.#i=!1)}isEmpty(){return!this.#e&&!this.#t}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t}){this.#e===e&&this.#t===t||(this.#e=e,this.#t=t,this.#l())}toggle(e=!1){this.#n&&(!e&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!e)}destroy(){this.#n?.remove(),this.#n=null,this.#s=null}async#l(){const e=this.#n;if(!e)return;if(!this.#e&&!this.#t){e.classList.remove("done"),this.#s?.remove();return}e.classList.add("done"),mi._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(s=>{e.setAttribute("aria-label",s)});let t=this.#s;if(!t){this.#s=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip");const s=t.id=`alt-text-tooltip-${this.#o.id}`;e.setAttribute("aria-describedby",s);const o=100,l=this.#o._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#o._reportTelemetry({action:"alt_text_tooltip"})},o)},{signal:l}),e.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:l})}t.innerText=this.#t?await mi._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):this.#e,t.parentNode||e.append(t),this.#o.getImageForAltText()?.setAttribute("aria-describedby",t.id)}}class he{#e=null;#t=null;#n=null;#s=!1;#r=!1;#i=null;#o=null;#l=this.focusin.bind(this);#c=this.focusout.bind(this);#d=null;#h="";#u=!1;#a=null;#p=!1;#g=!1;#f=!1;#m=null;#v=0;#_=0;#E=null;_initialOptions=Object.create(null);_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#w=!1;#S=he._zIndex++;static _borderLineWidth=-1;static _colorManager=new ju;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=he.prototype._resizeWithKeyboard,t=jn.TRANSLATE_SMALL,n=jn.TRANSLATE_BIG;return xe(this,"_resizerKeyboardManager",new cr([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],he.prototype._stopResizingWithKeyboard]]))}constructor(e){this.constructor===he&&Le("Cannot initialize AnnotationEditor."),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[o,l];const[u,d]=this.parentDimensions;this.x=e.x/u,this.y=e.y/d,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return xe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new VS({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t,n){if(he._l10nPromise||=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(o=>[o,e.get(o.replaceAll(/([A-Z])/g,l=>`-${l.toLowerCase()}`))])),n?.strings)for(const o of n.strings)he._l10nPromise.set(o,e.get(o));if(he._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);he._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Le("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#w}set _isDraggable(e){this.#w=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#S}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#L(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#u?this.#u=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[o,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/o,this.y=(t+s)/l,this.fixAndSetPosition()}#b([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this.fixAndSetPosition()}translate(e,t){this.#b(this.parentDimensions,e,t)}translateInPage(e,t){this.#a||=[this.x,this.y],this.#b(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#a||=[this.x,this.y];const[n,s]=this.parentDimensions;if(this.x+=e/n,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:l}=this;const[u,d]=this.getBaseTranslation();o+=u,l+=d,this.div.style.left=`${(100*o).toFixed(2)}%`,this.div.style.top=`${(100*l).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=he,s=n/e,o=n/t;switch(this.rotation){case 90:return[-s,o];case 180:return[s,o];case 270:return[s,-o];default:return[-s,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const[t,n]=this.pageDimensions;let{x:s,y:o,width:l,height:u}=this;if(l*=t,u*=n,s*=t,o*=n,this._mustFixPosition)switch(e){case 0:s=Math.max(0,Math.min(t-l,s)),o=Math.max(0,Math.min(n-u,o));break;case 90:s=Math.max(0,Math.min(t-u,s)),o=Math.min(n,Math.max(l,o));break;case 180:s=Math.min(t,Math.max(l,s)),o=Math.min(n,Math.max(u,o));break;case 270:s=Math.min(t,Math.max(u,s)),o=Math.max(0,Math.min(n-l,o));break}this.x=s/=t,this.y=o/=n;const[d,h]=this.getBaseTranslation();s+=d,o+=h;const{style:p}=this.div;p.left=`${(100*s).toFixed(2)}%`,p.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#k(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return he.#k(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return he.#k(e,t,360-this.parentRotation)}#I(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this,s=t*e,o=n*e;return Rt.isCSSRoundSupported?[Math.round(s),Math.round(o)]:[s,o]}setDims(e,t){const[n,s]=this.parentDimensions;this.div.style.width=`${(100*e/n).toFixed(2)}%`,this.#r||(this.div.style.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,s=n.endsWith("%"),o=!this.#r&&t.endsWith("%");if(s&&o)return;const[l,u]=this.parentDimensions;s||(e.width=`${(100*parseFloat(n)/l).toFixed(2)}%`),!this.#r&&!o&&(e.height=`${(100*parseFloat(t)/u).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#C(){if(this.#i)return;this.#i=document.createElement("div"),this.#i.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");this.#i.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#A.bind(this,n),{signal:t}),s.addEventListener("contextmenu",bt,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#i)}#A(e,t){t.preventDefault();const{isMac:n}=Rt.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#n?.toggle(!1);const s=this.#T.bind(this,e),o=this._isDraggable;this._isDraggable=!1;const l=this._uiManager._signal,u={passive:!0,capture:!0,signal:l};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",s,u),window.addEventListener("contextmenu",bt,{signal:l});const d=this.x,h=this.y,p=this.width,v=this.height,y=this.parent.div.style.cursor,A=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const w=()=>{this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=o,window.removeEventListener("pointerup",w),window.removeEventListener("blur",w),window.removeEventListener("pointermove",s,u),window.removeEventListener("contextmenu",bt),this.parent.div.style.cursor=y,this.div.style.cursor=A,this.#y(d,h,p,v)};window.addEventListener("pointerup",w,{signal:l}),window.addEventListener("blur",w,{signal:l})}#y(e,t,n,s){const o=this.x,l=this.y,u=this.width,d=this.height;o===e&&l===t&&u===n&&d===s||this.addCommands({cmd:()=>{this.width=u,this.height=d,this.x=o,this.y=l;const[h,p]=this.parentDimensions;this.setDims(h*u,p*d),this.fixAndSetPosition()},undo:()=>{this.width=n,this.height=s,this.x=e,this.y=t;const[h,p]=this.parentDimensions;this.setDims(h*n,p*s),this.fixAndSetPosition()},mustExec:!0})}#T(e,t){const[n,s]=this.parentDimensions,o=this.x,l=this.y,u=this.width,d=this.height,h=he.MIN_SIZE/n,p=he.MIN_SIZE/s,v=X=>Math.round(X*1e4)/1e4,y=this.#I(this.rotation),A=(X,G)=>[y[0]*X+y[2]*G,y[1]*X+y[3]*G],w=this.#I(360-this.rotation),C=(X,G)=>[w[0]*X+w[2]*G,w[1]*X+w[3]*G];let T,x,I=!1,P=!1;switch(e){case"topLeft":I=!0,T=(X,G)=>[0,0],x=(X,G)=>[X,G];break;case"topMiddle":T=(X,G)=>[X/2,0],x=(X,G)=>[X/2,G];break;case"topRight":I=!0,T=(X,G)=>[X,0],x=(X,G)=>[0,G];break;case"middleRight":P=!0,T=(X,G)=>[X,G/2],x=(X,G)=>[0,G/2];break;case"bottomRight":I=!0,T=(X,G)=>[X,G],x=(X,G)=>[0,0];break;case"bottomMiddle":T=(X,G)=>[X/2,G],x=(X,G)=>[X/2,0];break;case"bottomLeft":I=!0,T=(X,G)=>[0,G],x=(X,G)=>[X,0];break;case"middleLeft":P=!0,T=(X,G)=>[0,G/2],x=(X,G)=>[X,G/2];break}const M=T(u,d),F=x(u,d);let H=A(...F);const O=v(o+H[0]),K=v(l+H[1]);let q=1,J=1,[j,le]=this.screenToPageTranslation(t.movementX,t.movementY);if([j,le]=C(j/n,le/s),I){const X=Math.hypot(u,d);q=J=Math.max(Math.min(Math.hypot(F[0]-M[0]-j,F[1]-M[1]-le)/X,1/u,1/d),h/u,p/d)}else P?q=Math.max(h,Math.min(1,Math.abs(F[0]-M[0]-j)))/u:J=Math.max(p,Math.min(1,Math.abs(F[1]-M[1]-le)))/d;const ge=v(u*q),Pe=v(d*J);H=A(...x(ge,Pe));const Te=O-H[0],ye=K-H[1];this.width=ge,this.height=Pe,this.x=Te,this.y=ye,this.setDims(n*ge,s*Pe),this.fixAndSetPosition()}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this.#d||this.#g?this.#d:(this.#d=new Qu(this),this.div.append(this.#d.render()),this.#n&&this.#d.addAltTextButton(await this.#n.render()),this.#d)}removeEditToolbar(){this.#d&&(this.#d.remove(),this.#d=null,this.#n?.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(mi.initialize(he._l10nPromise),this.#n=new mi(this),this.#e&&(this.#n.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}hasAltText(){return!this.#n?.isEmpty()}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#s?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground();const e=this._uiManager._signal;this.div.addEventListener("focusin",this.#l,{signal:e}),this.div.addEventListener("focusout",this.#c,{signal:e});const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*n/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,o]=this.getInitialTranslation();return this.translate(s,o),Bo(this,this.div,["pointerdown"]),this.div}pointerdown(e){const{isMac:t}=Rt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#u=!0,this._isDraggable){this.#M(e);return}this.#x(e)}#x(e){const{isMac:t}=Rt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#M(e){const t=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let n,s;const o=this._uiManager._signal;t&&(this.div.classList.add("moving"),n={passive:!0,capture:!0,signal:o},this.#v=e.clientX,this.#_=e.clientY,s=u=>{const{clientX:d,clientY:h}=u,[p,v]=this.screenToPageTranslation(d-this.#v,h-this.#_);this.#v=d,this.#_=h,this._uiManager.dragSelectedEditors(p,v)},window.addEventListener("pointermove",s,n));const l=()=>{window.removeEventListener("pointerup",l),window.removeEventListener("blur",l),t&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",s,n)),this.#u=!1,this._uiManager.endDragSession()||this.#x(e)};window.addEventListener("pointerup",l,{signal:o}),window.addEventListener("blur",l,{signal:o})}moveInDOM(){this.#m&&clearTimeout(this.#m),this.#m=setTimeout(()=>{this.#m=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition()}getRect(e,t,n=this.rotation){const s=this.parentScale,[o,l]=this.pageDimensions,[u,d]=this.pageTranslation,h=e/s,p=t/s,v=this.x*o,y=this.y*l,A=this.width*o,w=this.height*l;switch(n){case 0:return[v+h+u,l-y-p-w+d,v+h+A+u,l-y-p+d];case 90:return[v+p+u,l-y+h+d,v+p+w+u,l-y+h+A+d];case 180:return[v-h-A+u,l-y+p+d,v-h+u,l-y+p+w+d];case 270:return[v-p-w+u,l-y-h-A+d,v-p+u,l-y-h+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,o,l]=e,u=o-n,d=l-s;switch(this.rotation){case 0:return[n,t-l,u,d];case 90:return[n,t-s,d,u];case 180:return[o,t-s,u,d];case 270:return[o,t-l,d,u];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#g=!0}disableEditMode(){this.#g=!1}isInEditMode(){return this.#g}shouldGetKeyboardEvents(){return this.#f}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){const e=this._uiManager._signal;this.div?.addEventListener("focusin",this.#l,{signal:e}),this.div?.addEventListener("focusout",this.#c,{signal:e})}rotate(e){}serialize(e=!1,t=null){Le("An editor must be serializable")}static deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});s.rotation=e.rotation,s.#e=e.accessibilityData;const[o,l]=s.pageDimensions,[u,d,h,p]=s.getRectInCurrentCoords(e.rect,l);return s.x=u/o,s.y=d/l,s.width=h/o,s.height=p/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",this.#l),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#m&&(clearTimeout(this.#m),this.#m=null),this.#L(),this.removeEditToolbar(),this.#E){for(const e of this.#E.values())clearTimeout(e);this.#E=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#C(),this.#i.classList.remove("hidden"),Bo(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#o={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#i.children;if(!this.#t){this.#t=Array.from(t);const l=this.#P.bind(this),u=this.#D.bind(this),d=this._uiManager._signal;for(const h of this.#t){const p=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",l,{signal:d}),h.addEventListener("blur",u,{signal:d}),h.addEventListener("focus",this.#N.bind(this,p),{signal:d}),he._l10nPromise.get(`pdfjs-editor-resizer-label-${p}`).then(v=>h.setAttribute("aria-label",v))}}const n=this.#t[0];let s=0;for(const l of t){if(l===n)break;s++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(o!==s){if(o<s)for(let u=0;u<s-o;u++)this.#i.append(this.#i.firstChild);else if(o>s)for(let u=0;u<o-s;u++)this.#i.firstChild.before(this.#i.lastChild);let l=0;for(const u of t){const h=this.#t[l++].getAttribute("data-resizer-name");he._l10nPromise.get(`pdfjs-editor-resizer-label-${h}`).then(p=>u.setAttribute("aria-label",p))}}this.#F(0),this.#f=!0,this.#i.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#P(e){he._resizerKeyboardManager.exec(this,e)}#D(e){this.#f&&e.relatedTarget?.parentNode!==this.#i&&this.#L()}#N(e){this.#h=this.#f?e:""}#F(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#f&&this.#T(this.#h,{movementX:e,movementY:t})}#L(){if(this.#f=!1,this.#F(-1),this.#o){const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=this.#o;this.#y(e,t,n,s),this.#o=null}}_stopResizingWithKeyboard(){this.#L(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this.#d){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this.#d?.show()});return}this.#d?.show()}unselect(){this.#i?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this.#d?.hide()}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#r=!0;const n=e/t,{style:s}=this.div;s.aspectRatio=n,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#E||=new Map;const{action:n}=e;let s=this.#E.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#E.delete(n),this.#E.size===0&&(this.#E=null)},he._telemetryTimeout),this.#E.set(n,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class VS extends he{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}const zp=3285377520,$t=4294901760,hn=65535;class qg{constructor(e){this.h1=e?e&4294967295:zp,this.h2=e?e&4294967295:zp}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let C=0,T=e.length;C<T;C++){const x=e.charCodeAt(C);x<=255?t[n++]=x:(t[n++]=x>>>8,t[n++]=x&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,o=n-s*4,l=new Uint32Array(t.buffer,0,s);let u=0,d=0,h=this.h1,p=this.h2;const v=3432918353,y=461845907,A=v&hn,w=y&hn;for(let C=0;C<s;C++)C&1?(u=l[C],u=u*v&$t|u*A&hn,u=u<<15|u>>>17,u=u*y&$t|u*w&hn,h^=u,h=h<<13|h>>>19,h=h*5+3864292196):(d=l[C],d=d*v&$t|d*A&hn,d=d<<15|d>>>17,d=d*y&$t|d*w&hn,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,o){case 3:u^=t[s*4+2]<<16;case 2:u^=t[s*4+1]<<8;case 1:u^=t[s*4],u=u*v&$t|u*A&hn,u=u<<15|u>>>17,u=u*y&$t|u*w&hn,s&1?h^=u:p^=u}this.h1=h,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&$t|e*36045&hn,t=t*4283543511&$t|((t<<16|e>>>16)*2950163797&$t)>>>16,e^=t>>>1,e=e*444984403&$t|e*60499&hn,t=t*3301882366&$t|((t<<16|e>>>16)*3120437893&$t)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Ru=Object.freeze({map:null,hash:"",transfer:void 0});class ec{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#n.values())if(t instanceof he)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let s=!1;if(n!==void 0)for(const[o,l]of Object.entries(t))n[o]!==l&&(s=!0,n[o]=l);else s=!0,this.#n.set(e,t);s&&this.#s(),t instanceof he&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}getAll(){return this.#n.size>0?$u(this.#n):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return this.#n.size}#s(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new $g(this)}get serializable(){if(this.#n.size===0)return Ru;const e=new Map,t=new qg,n=[],s=Object.create(null);let o=!1;for(const[l,u]of this.#n){const d=u instanceof he?u.serialize(!1,s):u;d&&(e.set(l,d),t.update(`${l}:${JSON.stringify(d)}`),o||=!!d.bitmap)}if(o)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:Ru}get editorStats(){let e=null;const t=new Map;for(const n of this.#n.values()){if(!(n instanceof he))continue;const s=n.telemetryFinalData;if(!s)continue;const{type:o}=s;t.has(o)||t.set(o,Object.getPrototypeOf(n).constructor),e||=Object.create(null);const l=e[o]||=new Map;for(const[u,d]of Object.entries(s)){if(u==="type")continue;let h=l.get(u);h||(h=new Map,l.set(u,h));const p=h.get(d)??0;h.set(d,p+1)}}for(const[n,s]of t)e[n]=s.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#n.values())!(t instanceof he)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}}class $g extends ec{#e;constructor(e){super();const{map:t,hash:n,transfer:s}=e.serializable,o=structuredClone(t,s?{transfer:s}:null);this.#e={map:o,hash:n,transfer:s}}get print(){Le("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return xe(this,"modifiedIds",{ids:new Set,hash:""})}}class GS{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(tt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:s,style:o}=e,l=new FontFace(n,s,o);this.addNativeFontFace(l);try{await l.load(),this.#e.add(n),t?.(e)}catch{Se(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Le("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Se(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return xe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(mt||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),xe(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(tt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return xe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(M,F){return M.charCodeAt(F)<<24|M.charCodeAt(F+1)<<16|M.charCodeAt(F+2)<<8|M.charCodeAt(F+3)&255}function s(M,F,H,O){const K=M.substring(0,F),q=M.substring(F+H);return K+O+q}let o,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let h=0;function p(M,F){if(++h>30){Se("Load test font never loaded."),F();return}if(d.font="30px "+M,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(p.bind(null,M,F))}const v=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=s(y,976,v.length,v);const w=16,C=1482184792;let T=n(y,w);for(o=0,l=v.length-3;o<l;o+=4)T=T-C+n(v,o)|0;o<v.length&&(T=T-C+n(v+"XXX",o)|0),y=s(y,w,4,TS(T));const x=`url(data:font/opentype;base64,${btoa(y)});`,I=`@font-face {font-family:"${v}";src:${x}}`;this.insertRule(I);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const M of[e.loadedName,v]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=M,P.append(F)}this._document.body.append(P),p(v,()=>{P.remove(),t.complete()})}}class zS{constructor(e,{disableFontFace:t=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this.disableFontFace=t===!0,this._inspectFont=n}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=Bg(this.data),t=`url(data:${this.mimetype};base64,${btoa(e)});`;let n;if(!this.cssFontInfo)n=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),n=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),n}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let n;try{n=e.get(this.loadedName+"_path_"+t)}catch(o){Se(`getPathGenerator - ignoring character: "${o}".`)}if(!Array.isArray(n)||n.length===0)return this.compiledGlyphs[t]=function(o,l){};const s=[];for(let o=0,l=n.length;o<l;)switch(n[o++]){case Tn.BEZIER_CURVE_TO:{const[u,d,h,p,v,y]=n.slice(o,o+6);s.push(A=>A.bezierCurveTo(u,d,h,p,v,y)),o+=6}break;case Tn.MOVE_TO:{const[u,d]=n.slice(o,o+2);s.push(h=>h.moveTo(u,d)),o+=2}break;case Tn.LINE_TO:{const[u,d]=n.slice(o,o+2);s.push(h=>h.lineTo(u,d)),o+=2}break;case Tn.QUADRATIC_CURVE_TO:{const[u,d,h,p]=n.slice(o,o+4);s.push(v=>v.quadraticCurveTo(u,d,h,p)),o+=4}break;case Tn.RESTORE:s.push(u=>u.restore());break;case Tn.SAVE:s.push(u=>u.save());break;case Tn.SCALE:tt(s.length===2,"Scale command is only valid at the third position.");break;case Tn.TRANSFORM:{const[u,d,h,p,v,y]=n.slice(o,o+6);s.push(A=>A.transform(u,d,h,p,v,y)),o+=6}break;case Tn.TRANSLATE:{const[u,d]=n.slice(o,o+2);s.push(h=>h.translate(u,d)),o+=2}break}return this.compiledGlyphs[t]=function(l,u){s[0](l),s[1](l),l.scale(u,-u);for(let d=2,h=s.length;d<h;d++)s[d](l)}}}if(mt){var bu=Promise.withResolvers(),Pu=null;(async()=>{const e=await xo(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),t=await xo(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),n=await xo(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),s=await xo(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);let o,l;return new Map(Object.entries({fs:e,http:t,https:n,url:s,canvas:o,path2d:l}))})().then(e=>{Pu=e,bu.resolve()},e=>{Se(`loadPackages: ${e}`),Pu=new Map,bu.resolve()})}class mn{static get promise(){return bu.promise}static get(e){return Pu?.get(e)}}const Wg=function(i){return mn.get("fs").promises.readFile(i).then(t=>new Uint8Array(t))};class qS extends ea{}class $S extends ta{_createCanvas(e,t){return mn.get("canvas").createCanvas(e,t)}}class WS extends na{_fetchData(e,t){return Wg(e).then(n=>({cMapData:n,compressionType:t}))}}class YS extends ia{_fetchData(e){return Wg(e)}}const _t={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Mu(i,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),i.clip(s)}class dr{constructor(){this.constructor===dr&&Le("Cannot initialize BaseShadingPattern.")}getPattern(){Le("Abstract method `getPattern` called.")}}class KS extends dr{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let o;if(s===_t.STROKE||s===_t.FILL){const l=t.current.getClippedPathBoundingBox(s,ze(e))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,d=Math.ceil(l[3]-l[1])||1,h=t.cachedCanvases.getCanvas("pattern",u,d,!0),p=h.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=re.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),Mu(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),o=e.createPattern(h.canvas,"no-repeat");const v=new DOMMatrix(n);o.setTransform(v)}else Mu(e,this._bbox),o=this._createGradient(e);return o}}function fu(i,e,t,n,s,o,l,u){const d=e.coords,h=e.colors,p=i.data,v=i.width*4;let y;d[t+1]>d[n+1]&&(y=t,t=n,n=y,y=o,o=l,l=y),d[n+1]>d[s+1]&&(y=n,n=s,s=y,y=l,l=u,u=y),d[t+1]>d[n+1]&&(y=t,t=n,n=y,y=o,o=l,l=y);const A=(d[t]+e.offsetX)*e.scaleX,w=(d[t+1]+e.offsetY)*e.scaleY,C=(d[n]+e.offsetX)*e.scaleX,T=(d[n+1]+e.offsetY)*e.scaleY,x=(d[s]+e.offsetX)*e.scaleX,I=(d[s+1]+e.offsetY)*e.scaleY;if(w>=I)return;const P=h[o],M=h[o+1],F=h[o+2],H=h[l],O=h[l+1],K=h[l+2],q=h[u],J=h[u+1],j=h[u+2],le=Math.round(w),ge=Math.round(I);let Pe,Te,ye,X,G,ae,Q,N;for(let V=le;V<=ge;V++){if(V<T){const fe=V<w?0:(w-V)/(w-T);Pe=A-(A-C)*fe,Te=P-(P-H)*fe,ye=M-(M-O)*fe,X=F-(F-K)*fe}else{let fe;V>I?fe=1:T===I?fe=0:fe=(T-V)/(T-I),Pe=C-(C-x)*fe,Te=H-(H-q)*fe,ye=O-(O-J)*fe,X=K-(K-j)*fe}let oe;V<w?oe=0:V>I?oe=1:oe=(w-V)/(w-I),G=A-(A-x)*oe,ae=P-(P-q)*oe,Q=M-(M-J)*oe,N=F-(F-j)*oe;const ve=Math.round(Math.min(Pe,G)),Ee=Math.round(Math.max(Pe,G));let _e=v*V+ve*4;for(let fe=ve;fe<=Ee;fe++)oe=(Pe-fe)/(Pe-G),oe<0?oe=0:oe>1&&(oe=1),p[_e++]=Te-(Te-ae)*oe|0,p[_e++]=ye-(ye-Q)*oe|0,p[_e++]=X-(X-N)*oe|0,p[_e++]=255}}function JS(i,e,t){const n=e.coords,s=e.colors;let o,l;switch(e.type){case"lattice":const u=e.verticesPerRow,d=Math.floor(n.length/u)-1,h=u-1;for(o=0;o<d;o++){let p=o*u;for(let v=0;v<h;v++,p++)fu(i,t,n[p],n[p+1],n[p+u],s[p],s[p+1],s[p+u]),fu(i,t,n[p+u+1],n[p+1],n[p+u],s[p+u+1],s[p+1],s[p+u])}break;case"triangles":for(o=0,l=n.length;o<l;o+=3)fu(i,t,n[o],n[o+1],n[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class XS extends dr{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-d,v=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),A=h/v,w=p/y,C={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/A,scaleY:1/w},T=v+4,x=y+4,I=n.getCanvas("mesh",T,x,!1),P=I.context,M=P.createImageData(v,y);if(t){const H=M.data;for(let O=0,K=H.length;O<K;O+=4)H[O]=t[0],H[O+1]=t[1],H[O+2]=t[2],H[O+3]=255}for(const H of this._figures)JS(M,H,C);return P.putImageData(M,2,2),{canvas:I.canvas,offsetX:u-2*A,offsetY:d-2*w,scaleX:A,scaleY:w}}getPattern(e,t,n,s){Mu(e,this._bbox);let o;if(s===_t.SHADING)o=re.singularValueDecompose2dScale(ze(e));else if(o=re.singularValueDecompose2dScale(t.baseTransform),this.matrix){const u=re.singularValueDecompose2dScale(this.matrix);o=[o[0]*u[0],o[1]*u[1]]}const l=this._createMeshCanvas(o,s===_t.SHADING?null:this._background,t.cachedCanvases);return s!==_t.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class QS extends dr{getPattern(){return"hotpink"}}function ZS(i){switch(i[0]){case"RadialAxial":return new KS(i);case"Mesh":return new XS(i);case"Dummy":return new QS}throw new Error(`Unknown IR type: ${i[0]}`)}const qp={COLORED:1,UNCOLORED:2};class tc{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,s,o){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=s,this.baseTransform=o}createPatternCanvas(e){const t=this.operatorList,n=this.bbox,s=this.xstep,o=this.ystep,l=this.paintType,u=this.tilingType,d=this.color,h=this.canvasGraphicsFactory;Qo("TilingType: "+u);const p=n[0],v=n[1],y=n[2],A=n[3],w=re.singularValueDecompose2dScale(this.matrix),C=re.singularValueDecompose2dScale(this.baseTransform),T=[w[0]*C[0],w[1]*C[1]],x=this.getSizeAndScale(s,this.ctx.canvas.width,T[0]),I=this.getSizeAndScale(o,this.ctx.canvas.height,T[1]),P=e.cachedCanvases.getCanvas("pattern",x.size,I.size,!0),M=P.context,F=h.createCanvasGraphics(M);F.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(F,l,d);let H=p,O=v,K=y,q=A;return p<0&&(H=0,K+=Math.abs(p)),v<0&&(O=0,q+=Math.abs(v)),M.translate(-(x.scale*H),-(I.scale*O)),F.transform(x.scale,0,0,I.scale,0,0),M.save(),this.clipBbox(F,H,O,K,q),F.baseTransform=ze(F.ctx),F.executeOperatorList(t),F.endDrawing(),{canvas:P.canvas,scaleX:x.scale,scaleY:I.scale,offsetX:H,offsetY:O}}getSizeAndScale(e,t,n){e=Math.abs(e);const s=Math.max(tc.MAX_PATTERN_SIZE,t);let o=Math.ceil(e*n);return o>=s?o=s:n=o/e,{scale:n,size:o}}clipBbox(e,t,n,s,o){const l=s-t,u=o-n;e.ctx.rect(t,n,l,u),e.current.updateRectMinMax(ze(e.ctx),[t,n,s,o]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,o=e.current;switch(t){case qp.COLORED:const l=this.ctx;s.fillStyle=l.fillStyle,s.strokeStyle=l.strokeStyle,o.fillColor=l.fillStyle,o.strokeColor=l.strokeStyle;break;case qp.UNCOLORED:const u=re.makeHexColor(n[0],n[1],n[2]);s.fillStyle=u,s.strokeStyle=u,o.fillColor=u,o.strokeColor=u;break;default:throw new CS(`Unsupported paint type: ${t}`)}}getPattern(e,t,n,s){let o=n;s!==_t.SHADING&&(o=re.transform(o,t.baseTransform),this.matrix&&(o=re.transform(o,this.matrix)));const l=this.createPatternCanvas(t);let u=new DOMMatrix(o);u=u.translate(l.offsetX,l.offsetY),u=u.scale(1/l.scaleX,1/l.scaleY);const d=e.createPattern(l.canvas,"repeat");return d.setTransform(u),d}}function jS({src:i,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const u=Rt.isLittleEndian?4278190080:255,[d,h]=l?[o,u]:[u,o],p=n>>3,v=n&7,y=i.length;t=new Uint32Array(t.buffer);let A=0;for(let w=0;w<s;w++){for(const T=e+p;e<T;e++){const x=e<y?i[e]:255;t[A++]=x&128?h:d,t[A++]=x&64?h:d,t[A++]=x&32?h:d,t[A++]=x&16?h:d,t[A++]=x&8?h:d,t[A++]=x&4?h:d,t[A++]=x&2?h:d,t[A++]=x&1?h:d}if(v===0)continue;const C=e<y?i[e++]:255;for(let T=0;T<v;T++)t[A++]=C&1<<7-T?h:d}return{srcPos:e,destPos:A}}const $p=16,Wp=100,eC=15,Yp=10,Kp=1e3,It=16;function tC(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(n,s){e.translate(n,s),this.__originalTranslate(n,s)},i.scale=function(n,s){e.scale(n,s),this.__originalScale(n,s)},i.transform=function(n,s,o,l,u,d){e.transform(n,s,o,l,u,d),this.__originalTransform(n,s,o,l,u,d)},i.setTransform=function(n,s,o,l,u,d){e.setTransform(n,s,o,l,u,d),this.__originalSetTransform(n,s,o,l,u,d)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(n){e.rotate(n),this.__originalRotate(n)},i.clip=function(n){e.clip(n),this.__originalClip(n)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,s,o,l,u){e.bezierCurveTo(t,n,s,o,l,u),this.__originalBezierCurveTo(t,n,s,o,l,u)},i.rect=function(t,n,s,o){e.rect(t,n,s,o),this.__originalRect(t,n,s,o)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class nC{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function ko(i,e,t,n,s,o,l,u,d,h){const[p,v,y,A,w,C]=ze(i);if(v===0&&y===0){const I=l*p+w,P=Math.round(I),M=u*A+C,F=Math.round(M),H=(l+d)*p+w,O=Math.abs(Math.round(H)-P)||1,K=(u+h)*A+C,q=Math.abs(Math.round(K)-F)||1;return i.setTransform(Math.sign(p),0,0,Math.sign(A),P,F),i.drawImage(e,t,n,s,o,0,0,O,q),i.setTransform(p,v,y,A,w,C),[O,q]}if(p===0&&A===0){const I=u*y+w,P=Math.round(I),M=l*v+C,F=Math.round(M),H=(u+h)*y+w,O=Math.abs(Math.round(H)-P)||1,K=(l+d)*v+C,q=Math.abs(Math.round(K)-F)||1;return i.setTransform(0,Math.sign(v),Math.sign(y),0,P,F),i.drawImage(e,t,n,s,o,0,0,q,O),i.setTransform(p,v,y,A,w,C),[q,O]}i.drawImage(e,t,n,s,o,l,u,d,h);const T=Math.hypot(p,v),x=Math.hypot(y,A);return[T*d,x*h]}function iC(i){const{width:e,height:t}=i;if(e>Kp||t>Kp)return null;const n=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=e+1;let l=new Uint8Array(o*(t+1)),u,d,h;const p=e+7&-8;let v=new Uint8Array(p*t),y=0;for(const x of i.data){let I=128;for(;I>0;)v[y++]=x&I?0:255,I>>=1}let A=0;for(y=0,v[y]!==0&&(l[0]=1,++A),d=1;d<e;d++)v[y]!==v[y+1]&&(l[d]=v[y]?2:1,++A),y++;for(v[y]!==0&&(l[d]=2,++A),u=1;u<t;u++){y=u*p,h=u*o,v[y-p]!==v[y]&&(l[h]=v[y]?1:8,++A);let x=(v[y]?4:0)+(v[y-p]?8:0);for(d=1;d<e;d++)x=(x>>2)+(v[y+1]?4:0)+(v[y-p+1]?8:0),s[x]&&(l[h+d]=s[x],++A),y++;if(v[y-p]!==v[y]&&(l[h+d]=v[y]?2:4,++A),A>n)return null}for(y=p*(t-1),h=u*o,v[y]!==0&&(l[h]=8,++A),d=1;d<e;d++)v[y]!==v[y+1]&&(l[h+d]=v[y]?4:8,++A),y++;if(v[y]!==0&&(l[h+d]=4,++A),A>n)return null;const w=new Int32Array([0,o,-1,0,-o,0,0,0,1]),C=new Path2D;for(u=0;A&&u<=t;u++){let x=u*o;const I=x+e;for(;x<I&&!l[x];)x++;if(x===I)continue;C.moveTo(x%o,u);const P=x;let M=l[x];do{const F=w[M];do x+=F;while(!l[x]);const H=l[x];H!==5&&H!==10?(M=H,l[x]=0):(M=H&51*M>>4,l[x]&=M>>2|M<<2),C.lineTo(x%o,x/o|0),l[x]||--A}while(P!==x);--u}return v=null,l=null,function(x){x.save(),x.scale(1/e,-1/t),x.translate(0,-t),x.fill(C),x.beginPath(),x.restore()}}class Jp{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Ug,this.textMatrixScale=1,this.fontMatrix=Tu,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=ht.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=re.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=re.applyTransform(t,e),s=re.applyTransform(t.slice(2),e),o=re.applyTransform([t[0],t[3]],e),l=re.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],s[0],o[0],l[0]),this.minY=Math.min(this.minY,n[1],s[1],o[1],l[1]),this.maxX=Math.max(this.maxX,n[0],s[0],o[0],l[0]),this.maxY=Math.max(this.maxY,n[1],s[1],o[1],l[1])}updateScalingPathMinMax(e,t){re.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,s,o,l,u,d,h,p){const v=re.bezierBoundingBox(t,n,s,o,l,u,d,h,p);p||this.updateRectMinMax(e,v)}getPathBoundingBox(e=_t.FILL,t=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===_t.STROKE){t||Le("Stroke bounding box must include transform.");const s=re.singularValueDecompose2dScale(t),o=s[0]*this.lineWidth/2,l=s[1]*this.lineWidth/2;n[0]-=o,n[1]-=l,n[2]+=o,n[3]+=l}return n}updateClipFromPath(){const e=re.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=_t.FILL,t=null){return re.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Xp(i,e){if(typeof ImageData<"u"&&e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%It,o=(t-s)/It,l=s===0?o:o+1,u=i.createImageData(n,It);let d=0,h;const p=e.data,v=u.data;let y,A,w,C;if(e.kind===Do.GRAYSCALE_1BPP){const T=p.byteLength,x=new Uint32Array(v.buffer,0,v.byteLength>>2),I=x.length,P=n+7>>3,M=4294967295,F=Rt.isLittleEndian?4278190080:255;for(y=0;y<l;y++){for(w=y<o?It:s,h=0,A=0;A<w;A++){const H=T-d;let O=0;const K=H>P?n:H*8-7,q=K&-8;let J=0,j=0;for(;O<q;O+=8)j=p[d++],x[h++]=j&128?M:F,x[h++]=j&64?M:F,x[h++]=j&32?M:F,x[h++]=j&16?M:F,x[h++]=j&8?M:F,x[h++]=j&4?M:F,x[h++]=j&2?M:F,x[h++]=j&1?M:F;for(;O<K;O++)J===0&&(j=p[d++],J=128),x[h++]=j&J?M:F,J>>=1}for(;h<I;)x[h++]=0;i.putImageData(u,0,y*It)}}else if(e.kind===Do.RGBA_32BPP){for(A=0,C=n*It*4,y=0;y<o;y++)v.set(p.subarray(d,d+C)),d+=C,i.putImageData(u,0,A),A+=It;y<l&&(C=n*s*4,v.set(p.subarray(d,d+C)),i.putImageData(u,0,A))}else if(e.kind===Do.RGB_24BPP)for(w=It,C=n*w,y=0;y<l;y++){for(y>=o&&(w=s,C=n*w),h=0,A=C;A--;)v[h++]=p[d++],v[h++]=p[d++],v[h++]=p[d++],v[h++]=255;i.putImageData(u,0,y*It)}else throw new Error(`bad image kind: ${e.kind}`)}function Qp(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%It,o=(t-s)/It,l=s===0?o:o+1,u=i.createImageData(n,It);let d=0;const h=e.data,p=u.data;for(let v=0;v<l;v++){const y=v<o?It:s;({srcPos:d}=jS({src:h,srcPos:d,dest:p,width:n,height:y,nonBlackColor:0})),i.putImageData(u,0,v*It)}}function Xs(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function Io(i){if(i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0),!mt){const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}}function Zp(i,e){if(e)return!0;const t=re.singularValueDecompose2dScale(i);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*ss.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}const sC=["butt","round","square"],rC=["miter","round","bevel"],oC={},jp={};class is{constructor(e,t,n,s,o,{optionalContentConfig:l,markedContentStack:u=null},d,h){this.ctx=e,this.current=new Jp(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new nC(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=u,n){const d=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...ze(this.compositeCtx))}this.ctx.save(),Io(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=ze(this.ctx)}executeOperatorList(e,t,n,s){const o=e.argsArray,l=e.fnArray;let u=t||0;const d=o.length;if(d===u)return u;const h=d-u>Yp&&typeof n=="function",p=h?Date.now()+eC:0;let v=0;const y=this.commonObjs,A=this.objs;let w;for(;;){if(s!==void 0&&u===s.nextBreakPoint)return s.breakIt(u,n),u;if(w=l[u],w!==tn.dependency)this[w].apply(this,o[u]);else for(const C of o[u]){const T=C.startsWith("g_")?y:A;if(!T.has(C))return T.get(C,n),u}if(u++,u===d)return u;if(h&&++v>Yp){if(Date.now()>p)return n(),u;v=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width,s=e.height;let o=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),u=n,d=s,h="prescale1",p,v;for(;o>2&&u>1||l>2&&d>1;){let y=u,A=d;o>2&&u>1&&(y=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),o/=u/y),l>2&&d>1&&(A=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,l/=d/A),p=this.cachedCanvases.getCanvas(h,y,A),v=p.context,v.clearRect(0,0,y,A),v.drawImage(e,0,0,u,d,0,0,y,A),e=p.canvas,u=y,d=A,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:u,paintHeight:d}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:s}=e,o=this.current.fillColor,l=this.current.patternFill,u=ze(t);let d,h,p,v;if((e.bitmap||e.data)&&e.count>1){const K=e.bitmap||e.data.buffer;h=JSON.stringify(l?u:[u.slice(0,4),o]),d=this._cachedBitmapsMap.get(K),d||(d=new Map,this._cachedBitmapsMap.set(K,d));const q=d.get(h);if(q&&!l){const J=Math.round(Math.min(u[0],u[2])+u[4]),j=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:q,offsetX:J,offsetY:j}}p=q}p||(v=this.cachedCanvases.getCanvas("maskCanvas",n,s),Qp(v.context,e));let y=re.transform(u,[1/n,0,0,-1/s,0,0]);y=re.transform(y,[1,0,0,1,0,-s]);const[A,w,C,T]=re.getAxialAlignedBoundingBox([0,0,n,s],y),x=Math.round(C-A)||1,I=Math.round(T-w)||1,P=this.cachedCanvases.getCanvas("fillCanvas",x,I),M=P.context,F=A,H=w;M.translate(-F,-H),M.transform(...y),p||(p=this._scaleImage(v.canvas,xn(M)),p=p.img,d&&l&&d.set(h,p)),M.imageSmoothingEnabled=Zp(ze(M),e.interpolate),ko(M,p,0,0,p.width,p.height,0,0,n,s),M.globalCompositeOperation="source-in";const O=re.transform(xn(M),[1,0,0,1,-F,-H]);return M.fillStyle=l?o.getPattern(t,this,O,_t.FILL):o,M.fillRect(0,0,n,s),d&&!l&&(this.cachedCanvases.delete("fillCanvas"),d.set(h,P.canvas)),{canvas:P.canvas,offsetX:Math.round(F),offsetY:Math.round(H)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=sC[e]}setLineJoin(e){this.ctx.lineJoin=rC[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=s.context;const o=this.ctx;o.setTransform(...ze(this.suspendedCtx)),Xs(this.suspendedCtx,o),tC(o,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Xs(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const o=s[0],l=s[1],u=s[2]-o,d=s[3]-l;u===0||d===0||(this.genericComposeSMask(t.context,n,u,d,t.subtype,t.backdrop,t.transferMap,o,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,o,l,u,d,h,p,v){let y=e.canvas,A=d-p,w=h-v;if(l){if(A<0||w<0||A+n>y.width||w+s>y.height){const T=this.cachedCanvases.getCanvas("maskExtension",n,s),x=T.context;x.drawImage(y,-A,-w),l.some(I=>I!==0)&&(x.globalCompositeOperation="destination-atop",x.fillStyle=re.makeHexColor(...l),x.fillRect(0,0,n,s),x.globalCompositeOperation="source-over"),y=T.canvas,A=w=0}else if(l.some(T=>T!==0)){e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const T=new Path2D;T.rect(A,w,n,s),e.clip(T),e.globalCompositeOperation="destination-atop",e.fillStyle=re.makeHexColor(...l),e.fillRect(A,w,n,s),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&u?t.filter=this.filterFactory.addAlphaFilter(u):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(u));const C=new Path2D;C.rect(d,h,n,s),t.clip(C),t.globalCompositeOperation="destination-in",t.drawImage(y,A,w,n,s,d,h,n,s),t.restore()}save(){this.inSMaskMode?(Xs(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Xs(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,s,o,l){this.ctx.transform(e,t,n,s,o,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const s=this.ctx,o=this.current;let l=o.x,u=o.y,d,h;const p=ze(s),v=p[0]===0&&p[3]===0||p[1]===0&&p[2]===0,y=v?n.slice(0):null;for(let A=0,w=0,C=e.length;A<C;A++)switch(e[A]|0){case tn.rectangle:l=t[w++],u=t[w++];const T=t[w++],x=t[w++],I=l+T,P=u+x;s.moveTo(l,u),T===0||x===0?s.lineTo(I,P):(s.lineTo(I,u),s.lineTo(I,P),s.lineTo(l,P)),v||o.updateRectMinMax(p,[l,u,I,P]),s.closePath();break;case tn.moveTo:l=t[w++],u=t[w++],s.moveTo(l,u),v||o.updatePathMinMax(p,l,u);break;case tn.lineTo:l=t[w++],u=t[w++],s.lineTo(l,u),v||o.updatePathMinMax(p,l,u);break;case tn.curveTo:d=l,h=u,l=t[w+4],u=t[w+5],s.bezierCurveTo(t[w],t[w+1],t[w+2],t[w+3],l,u),o.updateCurvePathMinMax(p,d,h,t[w],t[w+1],t[w+2],t[w+3],l,u,y),w+=6;break;case tn.curveTo2:d=l,h=u,s.bezierCurveTo(l,u,t[w],t[w+1],t[w+2],t[w+3]),o.updateCurvePathMinMax(p,d,h,l,u,t[w],t[w+1],t[w+2],t[w+3],y),l=t[w+2],u=t[w+3],w+=4;break;case tn.curveTo3:d=l,h=u,l=t[w+2],u=t[w+3],s.bezierCurveTo(t[w],t[w+1],l,u,l,u),o.updateCurvePathMinMax(p,d,h,t[w],t[w+1],l,u,l,u,y),w+=4;break;case tn.closePath:s.closePath();break}v&&o.updateScalingPathMinMax(p,y),o.setCurrentPoint(l,u)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&n?.getPattern?(t.save(),t.strokeStyle=n.getPattern(t,this,xn(t),_t.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,n=this.current.fillColor,s=this.current.patternFill;let o=!1;s&&(t.save(),t.fillStyle=n.getPattern(t,this,xn(t),_t.FILL),o=!0);const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),o&&t.restore(),e&&this.consumePath(l)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=oC}eoClip(){this.pendingClip=jp}beginText(){this.current.textMatrix=Ug,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(const n of e)t.setTransform(...n.transform),t.translate(n.x,n.y),n.addToPath(t,n.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const n=this.commonObjs.get(e),s=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=n.fontMatrix||Tu,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Se("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const o=n.loadedName||"sans-serif",l=n.systemFontInfo?.css||`"${o}", ${n.fallbackName}`;let u="normal";n.black?u="900":n.bold&&(u="bold");const d=n.italic?"italic":"normal";let h=t;t<$p?h=$p:t>Wp&&(h=Wp),this.current.fontSizeScale=t/h,this.ctx.font=`${d} ${u} ${h}px ${l}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,s,o,l){this.current.textMatrix=[e,t,n,s,o,l],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,s){const o=this.ctx,l=this.current,u=l.font,d=l.textRenderingMode,h=l.fontSize/l.fontSizeScale,p=d&ht.FILL_STROKE_MASK,v=!!(d&ht.ADD_TO_PATH_FLAG),y=l.patternFill&&!u.missingFile;let A;(u.disableFontFace||v||y)&&(A=u.getPathGenerator(this.commonObjs,e)),u.disableFontFace||y?(o.save(),o.translate(t,n),o.beginPath(),A(o,h),s&&o.setTransform(...s),(p===ht.FILL||p===ht.FILL_STROKE)&&o.fill(),(p===ht.STROKE||p===ht.FILL_STROKE)&&o.stroke(),o.restore()):((p===ht.FILL||p===ht.FILL_STROKE)&&o.fillText(e,t,n),(p===ht.STROKE||p===ht.FILL_STROKE)&&o.strokeText(e,t,n)),v&&(this.pendingTextPaths||=[]).push({transform:ze(o),x:t,y:n,fontSize:h,addToPath:A})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return xe(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const o=this.ctx,l=t.fontSizeScale,u=t.charSpacing,d=t.wordSpacing,h=t.fontDirection,p=t.textHScale*h,v=e.length,y=n.vertical,A=y?1:-1,w=n.defaultVMetrics,C=s*t.fontMatrix[0],T=t.textRenderingMode===ht.FILL&&!n.disableFontFace&&!t.patternFill;o.save(),o.transform(...t.textMatrix),o.translate(t.x,t.y+t.textRise),h>0?o.scale(p,-1):o.scale(p,1);let x;if(t.patternFill){o.save();const H=t.fillColor.getPattern(o,this,xn(o),_t.FILL);x=ze(o),o.restore(),o.fillStyle=H}let I=t.lineWidth;const P=t.textMatrixScale;if(P===0||I===0){const H=t.textRenderingMode&ht.FILL_STROKE_MASK;(H===ht.STROKE||H===ht.FILL_STROKE)&&(I=this.getSinglePixelWidth())}else I/=P;if(l!==1&&(o.scale(l,l),I/=l),o.lineWidth=I,n.isInvalidPDFjsFont){const H=[];let O=0;for(const K of e)H.push(K.unicode),O+=K.width;o.fillText(H.join(""),0,0),t.x+=O*C*p,o.restore(),this.compose();return}let M=0,F;for(F=0;F<v;++F){const H=e[F];if(typeof H=="number"){M+=A*H*s/1e3;continue}let O=!1;const K=(H.isSpace?d:0)+u,q=H.fontChar,J=H.accent;let j,le,ge=H.width;if(y){const Te=H.vmetric||w,ye=-(H.vmetric?Te[1]:ge*.5)*C,X=Te[2]*C;ge=Te?-Te[0]:ge,j=ye/l,le=(M+X)/l}else j=M/l,le=0;if(n.remeasure&&ge>0){const Te=o.measureText(q).width*1e3/s*l;if(ge<Te&&this.isFontSubpixelAAEnabled){const ye=ge/Te;O=!0,o.save(),o.scale(ye,1),j/=ye}else ge!==Te&&(j+=(ge-Te)/2e3*s/l)}if(this.contentVisible&&(H.isInFont||n.missingFile)){if(T&&!J)o.fillText(q,j,le);else if(this.paintChar(q,j,le,x),J){const Te=j+s*J.offset.x/l,ye=le-s*J.offset.y/l;this.paintChar(J.fontChar,Te,ye,x)}}const Pe=y?ge*C-K*h:ge*C+K*h;M+=Pe,O&&o.restore()}y?t.y-=M:t.x+=M*p,o.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,s=n.font,o=n.fontSize,l=n.fontDirection,u=s.vertical?1:-1,d=n.charSpacing,h=n.wordSpacing,p=n.textHScale*l,v=n.fontMatrix||Tu,y=e.length,A=n.textRenderingMode===ht.INVISIBLE;let w,C,T,x;if(!(A||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(p,l),w=0;w<y;++w){if(C=e[w],typeof C=="number"){x=u*C*o/1e3,this.ctx.translate(x,0),n.x+=x*p;continue}const I=(C.isSpace?h:0)+d,P=s.charProcOperatorList[C.operatorListId];if(!P){Se(`Type3 character "${C.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=C,this.save(),t.scale(o,o),t.transform(...v),this.executeOperatorList(P),this.restore()),T=re.applyTransform([C.width,0],v)[0]*o+I,t.translate(T,0),n.x+=T*p}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,s,o,l){this.ctx.rect(n,s,o-n,l-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=e[1],s=this.baseTransform||ze(this.ctx),o={createCanvasGraphics:l=>new is(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new tc(e,n,this.ctx,o,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=re.makeHexColor(e,t,n)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=re.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=ZS(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,xn(t),_t.SHADING);const s=xn(t);if(s){const{width:o,height:l}=t.canvas,[u,d,h,p]=re.getAxialAlignedBoundingBox([0,0,o,l],s);this.ctx.fillRect(u,d,h-u,p-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Le("Should not call beginInlineImage")}beginImageData(){Le("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=ze(this.ctx),t)){const n=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],n,s),this.current.updateRectMinMax(ze(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Qo("TODO: Support non-isolated groups."),e.knockout&&Se("Knockout groups not supported.");const n=ze(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=re.getAxialAlignedBoundingBox(e.bbox,ze(t));const o=[0,0,t.canvas.width,t.canvas.height];s=re.intersect(s,o)||[0,0,0,0];const l=Math.floor(s[0]),u=Math.floor(s[1]),d=Math.max(Math.ceil(s[2])-l,1),h=Math.max(Math.ceil(s[3])-u,1);this.current.startNewPathAndClipBox([0,0,d,h]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(p,d,h),y=v.context;y.translate(-l,-u),y.transform(...n),e.smask?this.smaskStack.push({canvas:v.canvas,context:y,offsetX:l,offsetY:u,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(l,u),t.save()),Xs(t,y),this.ctx=y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=ze(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const o=re.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,n,s,o){if(this.#e(),Io(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const l=t[2]-t[0],u=t[3]-t[1];if(o&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=l,t[3]=u;const[d,h]=re.singularValueDecompose2dScale(ze(this.ctx)),{viewportScale:p}=this,v=Math.ceil(l*this.outputScaleX*p),y=Math.ceil(u*this.outputScaleY*p);this.annotationCanvas=this.canvasFactory.create(v,y);const{canvas:A,context:w}=this.annotationCanvas;this.annotationCanvasMap.set(e,A),this.annotationCanvas.savedCtx=this.ctx,this.ctx=w,this.ctx.save(),this.ctx.setTransform(d,0,0,-h,0,u*h),Io(this.ctx)}else Io(this.ctx),this.ctx.rect(t[0],t[1],l,u),this.ctx.clip(),this.endPath()}this.current=new Jp(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=iC(e)),s.compiled)){s.compiled(n);return}const o=this._createMaskCanvas(e),l=o.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(l,o.offsetX,o.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,s=0,o,l){if(!this.contentVisible)return;e=this.getObject(e.data,e);const u=this.ctx;u.save();const d=ze(u);u.transform(t,n,s,o,0,0);const h=this._createMaskCanvas(e);u.setTransform(1,0,0,1,h.offsetX-d[4],h.offsetY-d[5]);for(let p=0,v=l.length;p<v;p+=2){const y=re.transform(d,[t,n,s,o,l[p],l[p+1]]),[A,w]=re.applyTransform([0,0],y);u.drawImage(h.canvas,A,w)}u.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,s=this.current.patternFill;for(const o of e){const{data:l,width:u,height:d,transform:h}=o,p=this.cachedCanvases.getCanvas("maskCanvas",u,d),v=p.context;v.save();const y=this.getObject(l,o);Qp(v,y),v.globalCompositeOperation="source-in",v.fillStyle=s?n.getPattern(v,this,xn(t),_t.FILL):n,v.fillRect(0,0,u,d),v.restore(),t.save(),t.transform(...h),t.scale(1,-1),ko(t,p.canvas,0,0,u,d,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Se("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,s){if(!this.contentVisible)return;const o=this.getObject(e);if(!o){Se("Dependent image isn't ready yet");return}const l=o.width,u=o.height,d=[];for(let h=0,p=s.length;h<p;h+=2)d.push({transform:[t,0,0,n,s[h],s[h+1]],x:0,y:0,w:l,h:u});this.paintInlineImageXObjectGroup(o,d)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,o=this.cachedCanvases.getCanvas("inlineImage",n,s),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",o.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,s=this.ctx;if(this.save(),!mt){const{filter:u}=s;u!=="none"&&u!==""&&(s.filter="none")}s.scale(1/t,-1/n);let o;if(e.bitmap)o=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)o=e;else{const d=this.cachedCanvases.getCanvas("inlineImage",t,n).context;Xp(d,e),o=this.applyTransferMapsToCanvas(d)}const l=this._scaleImage(o,xn(s));s.imageSmoothingEnabled=Zp(ze(s),e.interpolate),ko(s,l.img,0,0,l.paintWidth,l.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const o=e.width,l=e.height,d=this.cachedCanvases.getCanvas("inlineImage",o,l).context;Xp(d,e),s=this.applyTransferMapsToCanvas(d)}for(const o of t)n.save(),n.transform(...o.transform),n.scale(1,-1),ko(n,s,o.x,o.y,o.w,o.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===jp?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=ze(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:o}=this.ctx.getTransform();let l,u;if(n===0&&s===0){const d=Math.abs(t),h=Math.abs(o);if(d===h)if(e===0)l=u=1/d;else{const p=d*e;l=u=p<1?1/p:1}else if(e===0)l=1/d,u=1/h;else{const p=d*e,v=h*e;l=p<1?1/p:1,u=v<1?1/v:1}}else{const d=Math.abs(t*o-n*s),h=Math.hypot(t,n),p=Math.hypot(s,o);if(e===0)l=p/d,u=h/d;else{const v=e*d;l=p>v?p/v:1,u=h>v?h/v:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[s,o]=this.getScaleForStroking();if(t.lineWidth=n||1,s===1&&o===1){t.stroke();return}const l=t.getLineDash();if(e&&t.save(),t.scale(s,o),l.length>0){const u=Math.max(s,o);t.setLineDash(l.map(d=>d/u)),t.lineDashOffset/=u}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const i in tn)is.prototype[i]!==void 0&&(is.prototype[tn[i]]=is.prototype[i]);class or{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}const Ro={DATA:1,ERROR:2},Je={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Ft(i){switch(i instanceof Error||typeof i=="object"&&i!==null||Le('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new Ci(i.message);case"MissingPDFException":return new Si(i.message);case"PasswordException":return new ku(i.message,i.code);case"UnexpectedResponseException":return new Zo(i.message,i.status);case"UnknownErrorException":return new Iu(i.message,i.details);default:return new Iu(i.message,i.toString())}}class tr{constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=s=>{const o=s.data;if(o.targetName!==this.sourceName)return;if(o.stream){this.#t(o);return}if(o.callback){const u=o.callbackId,d=this.callbackCapabilities[u];if(!d)throw new Error(`Cannot resolve callback ${u}`);if(delete this.callbackCapabilities[u],o.callback===Ro.DATA)d.resolve(o.data);else if(o.callback===Ro.ERROR)d.reject(Ft(o.reason));else throw new Error("Unexpected callback case");return}const l=this.actionHandler[o.action];if(!l)throw new Error(`Unknown action from worker: ${o.action}`);if(o.callbackId){const u=this.sourceName,d=o.sourceName;new Promise(function(h){h(l(o.data))}).then(function(h){n.postMessage({sourceName:u,targetName:d,callback:Ro.DATA,callbackId:o.callbackId,data:h})},function(h){n.postMessage({sourceName:u,targetName:d,callback:Ro.ERROR,callbackId:o.callbackId,reason:Ft(h)})});return}if(o.streamId){this.#e(o);return}l(o.data)},n.addEventListener("message",this._onComObjOnMessage)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[s]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(l){o.reject(l)}return o.promise}sendWithStream(e,t,n,s){const o=this.streamId++,l=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:h=>{const p=Promise.withResolvers();return this.streamControllers[o]={controller:h,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:l,targetName:u,action:e,streamId:o,data:t,desiredSize:h.desiredSize},s),p.promise},pull:h=>{const p=Promise.withResolvers();return this.streamControllers[o].pullCall=p,d.postMessage({sourceName:l,targetName:u,stream:Je.PULL,streamId:o,desiredSize:h.desiredSize}),p.promise},cancel:h=>{tt(h instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[o].cancelCall=p,this.streamControllers[o].isClosed=!0,d.postMessage({sourceName:l,targetName:u,stream:Je.CANCEL,streamId:o,reason:Ft(h)}),p.promise}},n)}#e(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this,u=this.actionHandler[e.action],d={enqueue(h,p=1,v){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=p,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:s,stream:Je.ENQUEUE,streamId:t,chunk:h},v)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:Je.CLOSE,streamId:t}),delete l.streamSinks[t])},error(h){tt(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:Je.ERROR,streamId:t,reason:Ft(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[t]=d,new Promise(function(h){h(u(e.data,d))}).then(function(){o.postMessage({sourceName:n,targetName:s,stream:Je.START_COMPLETE,streamId:t,success:!0})},function(h){o.postMessage({sourceName:n,targetName:s,stream:Je.START_COMPLETE,streamId:t,reason:Ft(h)})})}#t(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this.streamControllers[t],u=this.streamSinks[t];switch(e.stream){case Je.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(Ft(e.reason));break;case Je.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(Ft(e.reason));break;case Je.PULL:if(!u){o.postMessage({sourceName:n,targetName:s,stream:Je.PULL_COMPLETE,streamId:t,success:!0});break}u.desiredSize<=0&&e.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=e.desiredSize,new Promise(function(d){d(u.onPull?.())}).then(function(){o.postMessage({sourceName:n,targetName:s,stream:Je.PULL_COMPLETE,streamId:t,success:!0})},function(d){o.postMessage({sourceName:n,targetName:s,stream:Je.PULL_COMPLETE,streamId:t,reason:Ft(d)})});break;case Je.ENQUEUE:if(tt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case Je.CLOSE:if(tt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#n(l,t);break;case Je.ERROR:tt(l,"error should have stream controller"),l.controller.error(Ft(e.reason)),this.#n(l,t);break;case Je.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(Ft(e.reason)),this.#n(l,t);break;case Je.CANCEL:if(!u)break;new Promise(function(d){d(u.onCancel?.(Ft(e.reason)))}).then(function(){o.postMessage({sourceName:n,targetName:s,stream:Je.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){o.postMessage({sourceName:n,targetName:s,stream:Je.CANCEL_COMPLETE,streamId:t,reason:Ft(d)})}),u.sinkCapability.reject(Ft(e.reason)),u.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#n(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}class aC{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return $u(this.#e)}has(e){return this.#e.has(e)}}const Qn=Symbol("INTERNAL");class lC{#e=!1;#t=!1;#n=!1;#s=!0;constructor(e,{name:t,intent:n,usage:s}){this.#e=!!(e&Ut.DISPLAY),this.#t=!!(e&Ut.PRINT),this.name=t,this.intent=n,this.usage=s}get visible(){if(this.#n)return this.#s;if(!this.#s)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==Qn&&Le("Internal method `_setVisible` called."),this.#n=n,this.#s=t}}class uC{#e=null;#t=new Map;#n=null;#s=null;constructor(e,t=Ut.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#s=e.order;for(const n of e.groups)this.#t.set(n.id,new lC(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(Qn,!1);for(const n of e.on)this.#t.get(n)._setVisible(Qn,!0);for(const n of e.off)this.#t.get(n)._setVisible(Qn,!1);this.#n=this.getHash()}}#r(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const o=e[s];let l;if(Array.isArray(o))l=this.#r(o);else if(this.#t.has(o))l=this.#t.get(o).visible;else return Se(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Qo("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Se(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Se(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Se(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Se(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Se(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Se(`Unknown optional content policy ${e.policy}.`),!0}return Se(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0){const n=this.#t.get(e);if(!n){Se(`Optional content group not found: ${e}`);return}n._setVisible(Qn,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const o=this.#t.get(s);if(o)switch(n){case"ON":o._setVisible(Qn,!0);break;case"OFF":o._setVisible(Qn,!1);break;case"Toggle":o._setVisible(Qn,!o.visible);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#s?this.#s.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?$u(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new qg;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}}class cC{constructor(e,{disableRange:t=!1,disableStream:n=!1}){tt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:o,progressiveDone:l,contentDispositionFilename:u}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=u,o?.length>0){const d=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((d,h)=>{this._onReceiveData({begin:d,chunk:h})}),e.addProgressListener((d,h)=>{this._onProgress({loaded:d,total:h})}),e.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(n),!0)});tt(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){tt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new dC(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new hC(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class dC{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=Ju(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class hC{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function fC(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let p=u(t);return p=unescape(p),p=d(p),p=h(p),o(p)}if(t=l(i),t){const p=h(t);return o(p)}if(t=n("filename","i").exec(i),t){t=t[1];let p=u(t);return p=h(p),o(p)}function n(p,v){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function s(p,v){if(p){if(!/^[\x00-\xFF]+$/.test(v))return v;try{const y=new TextDecoder(p,{fatal:!0}),A=jo(v);v=y.decode(A),e=!1}catch{}}return v}function o(p){return e&&/[\x80-\xff]/.test(p)&&(p=s("utf-8",p),e&&(p=s("iso-8859-1",p))),p}function l(p){const v=[];let y;const A=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=A.exec(p))!==null;){let[,C,T,x]=y;if(C=parseInt(C,10),C in v){if(C===0)break;continue}v[C]=[T,x]}const w=[];for(let C=0;C<v.length&&C in v;++C){let[T,x]=v[C];x=u(x),T&&(x=unescape(x),C===0&&(x=d(x))),w.push(x)}return w.join("")}function u(p){if(p.startsWith('"')){const v=p.slice(1).split('\\"');for(let y=0;y<v.length;++y){const A=v[y].indexOf('"');A!==-1&&(v[y]=v[y].slice(0,A),v.length=y+1),v[y]=v[y].replaceAll(/\\(.)/g,"$1")}p=v.join('"')}return p}function d(p){const v=p.indexOf("'");if(v===-1)return p;const y=p.slice(0,v),w=p.slice(v+1).replace(/^[^']*'/,"");return s(y,w)}function h(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,y,A,w){if(A==="q"||A==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(C,T){return String.fromCharCode(parseInt(T,16))}),s(y,w);try{w=atob(w)}catch{}return s(y,w)})}return""}function nc({getResponseHeader:i,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(i("Content-Length"),10);return!Number.isInteger(o)||(s.suggestedLength=o,o<=2*t)||n||!e||i("Accept-Ranges")!=="bytes"||(i("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function ic(i){const e=i("Content-Disposition");if(e){let t=fC(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Ju(t))return t}return null}function oa(i,e){return i===404||i===0&&e.startsWith("file:")?new Si('Missing PDF "'+e+'".'):new Zo(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i)}function Yg(i){return i===200||i===206}function Kg(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Jg(i){const e=new Headers;for(const t in i){const n=i[t];n!==void 0&&e.append(t,n)}return e}function Xg(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Se(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class eg{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return tt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new pC(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new gC(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class pC{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._headers=Jg(this._stream.httpHeaders);const n=t.url;fetch(n,Kg(this._headers,this._withCredentials,this._abortController)).then(s=>{if(!Yg(s.status))throw oa(s.status,n);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=d=>s.headers.get(d),{allowRangeRequests:l,suggestedLength:u}=nc({getResponseHeader:o,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=u||this._contentLength,this._filename=ic(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ci("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Xg(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class gC{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController,this._headers=Jg(this._stream.httpHeaders),this._headers.append("Range",`bytes=${t}-${n-1}`);const o=s.url;fetch(o,Kg(this._headers,this._withCredentials,this._abortController)).then(l=>{if(!Yg(l.status))throw oa(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Xg(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const pu=200,gu=206;function mC(i){const e=i.response;return typeof e!="string"?e:jo(e).buffer}class vC{constructor(e,t={}){this.url=e,this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||Object.create(null),this.withCredentials=t.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,n){const s={begin:e,end:t};for(const o in n)s[o]=n[o];return this.request(s)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const o in this.httpHeaders){const l=this.httpHeaders[o];l!==void 0&&t.setRequestHeader(o,l)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=gu):s.expectedStatus=pu,t.responseType="arraybuffer",e.onError&&(t.onerror=function(o){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError?.(s.status);return}const o=s.status||pu;if(!(o===pu&&n.expectedStatus===gu)&&o!==n.expectedStatus){n.onError?.(s.status);return}const u=mC(s);if(o===gu){const d=s.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);n.onDone({begin:parseInt(h[1],10),chunk:u})}else u?n.onDone({begin:0,chunk:u}):n.onError?.(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class yC{constructor(e){this._source=e,this._manager=new vC(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return tt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _C(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new EC(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class _C{constructor(e,t){this._manager=e;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=l=>t.getResponseHeader(l),{allowRangeRequests:s,suggestedLength:o}=nc({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=ic(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=oa(e,this._url),this._headersReceivedCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersReceivedCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class EC{constructor(e,t,n){this._manager=e;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,n,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=oa(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Qg=/^file:\/\/\/[a-zA-Z]:\//;function AC(i){const e=mn.get("url"),t=e.parse(i);return t.protocol==="file:"||t.host?t:/^[a-z]:[/\\]/i.test(i)?e.parse(`file:///${i}`):(t.host||(t.protocol="file:"),t)}class wC{constructor(e){this.source=e,this.url=AC(e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return tt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new TC(this):new SC(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=this.isFsUrl?new xC(this,e,t):new CC(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Zg{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ci("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class jg{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Oo(i,e){return{protocol:i.protocol,auth:i.auth,host:i.hostname,port:i.port,path:i.path,method:"GET",headers:e}}class SC extends Zg{constructor(e){super(e);const t=n=>{if(n.statusCode===404){const u=new Si(`Missing PDF "${this._url}".`);this._storedError=u,this._headersCapability.reject(u);return}this._headersCapability.resolve(),this._setReadableStream(n);const s=u=>this._readableStream.headers[u.toLowerCase()],{allowRangeRequests:o,suggestedLength:l}=nc({getResponseHeader:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=ic(s)};if(this._request=null,this._url.protocol==="http:"){const n=mn.get("http");this._request=n.request(Oo(this._url,e.httpHeaders),t)}else{const n=mn.get("https");this._request=n.request(Oo(this._url,e.httpHeaders),t)}this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}}class CC extends jg{constructor(e,t,n){super(e),this._httpHeaders={};for(const o in e.httpHeaders){const l=e.httpHeaders[o];l!==void 0&&(this._httpHeaders[o]=l)}this._httpHeaders.Range=`bytes=${t}-${n-1}`;const s=o=>{if(o.statusCode===404){const l=new Si(`Missing PDF "${this._url}".`);this._storedError=l;return}this._setReadableStream(o)};if(this._request=null,this._url.protocol==="http:"){const o=mn.get("http");this._request=o.request(Oo(this._url,this._httpHeaders),s)}else{const o=mn.get("https");this._request=o.request(Oo(this._url,this._httpHeaders),s)}this._request.on("error",o=>{this._storedError=o}),this._request.end()}}class TC extends Zg{constructor(e){super(e);let t=decodeURIComponent(this._url.path);Qg.test(this._url.href)&&(t=t.replace(/^\//,""));const n=mn.get("fs");n.promises.lstat(t).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(t)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new Si(`Missing PDF "${t}".`)),this._storedError=s,this._headersCapability.reject(s)})}}class xC extends jg{constructor(e,t,n){super(e);let s=decodeURIComponent(this._url.path);Qg.test(this._url.href)&&(s=s.replace(/^\//,""));const o=mn.get("fs");this._setReadableStream(o.createReadStream(s,{start:t,end:n-1}))}}const kC=1e5,kt=30,IC=.8;class Ht{#e=Promise.withResolvers();#t=null;#n=!1;#s=!!globalThis.FontInspector?.enabled;#r=null;#i=null;#o=0;#l=0;#c=null;#d=null;#h=0;#u=0;#a=Object.create(null);#p=[];#g=null;#f=[];#m=new WeakMap;#v=null;static#_=new Map;static#E=new Map;static#w=null;static#S=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#g=e;else if(typeof e=="object")this.#g=new ReadableStream({start(d){d.enqueue(e),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#d=t,this.#u=n.scale*(globalThis.devicePixelRatio||1),this.#h=n.rotation,this.#i={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:o,pageX:l,pageY:u}=n.rawDims;this.#v=[1,0,0,-1,-l,u+o],this.#l=s,this.#o=o,Ht.#A(),_i(t,n),this.#e.promise.catch(()=>{}).then(()=>{Ht.#S.delete(this),this.#i=null,this.#a=null})}render(){const e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#r??=t.lang,Object.assign(this.#a,t.styles),this.#b(t.items),e()},this.#e.reject)};return this.#c=this.#g.getReader(),Ht.#S.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*(globalThis.devicePixelRatio||1),s=e.rotation;if(s!==this.#h&&(t?.(),this.#h=s,_i(this.#d,{rotation:s})),n!==this.#u){t?.(),this.#u=n;const o={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:Ht.#C(this.#r)};for(const l of this.#f)o.properties=this.#m.get(l),o.div=l,this.#I(o)}}cancel(){const e=new Ci("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#f}get textContentItemsStr(){return this.#p}#b(e){if(this.#n)return;this.#i.ctx??=Ht.#C(this.#r);const t=this.#f,n=this.#p;for(const s of e){if(t.length>kC){Se("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const o=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),s.id!==null&&this.#t.setAttribute("id",`${s.id}`),o.append(this.#t)}else s.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(s.str),this.#k(s)}}#k(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#f.push(t);const s=re.transform(this.#v,e.transform);let o=Math.atan2(s[1],s[0]);const l=this.#a[e.fontName];l.vertical&&(o+=Math.PI/2);const u=this.#s&&l.fontSubstitution||l.fontFamily,d=Math.hypot(s[2],s[3]),h=d*Ht.#y(u,this.#r);let p,v;o===0?(p=s[4],v=s[5]-h):(p=s[4]+h*Math.sin(o),v=s[5]-h*Math.cos(o));const y="calc(var(--scale-factor)*",A=t.style;this.#t===this.#d?(A.left=`${(100*p/this.#l).toFixed(2)}%`,A.top=`${(100*v/this.#o).toFixed(2)}%`):(A.left=`${y}${p.toFixed(2)}px)`,A.top=`${y}${v.toFixed(2)}px)`),A.fontSize=`${y}${(Ht.#w*d).toFixed(2)}px)`,A.fontFamily=u,n.fontSize=d,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#s&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),o!==0&&(n.angle=o*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const C=Math.abs(e.transform[0]),T=Math.abs(e.transform[3]);C!==T&&Math.max(C,T)/Math.min(C,T)>1.5&&(w=!0)}if(w&&(n.canvasWidth=l.vertical?e.height:e.width),this.#m.set(t,n),this.#i.div=t,this.#i.properties=n,this.#I(this.#i),n.hasText&&this.#t.append(t),n.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),this.#t.append(C)}}#I(e){const{div:t,properties:n,ctx:s,prevFontSize:o,prevFontFamily:l}=e,{style:u}=t;let d="";if(Ht.#w>1&&(d=`scale(${1/Ht.#w})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:h}=u,{canvasWidth:p,fontSize:v}=n;(o!==v||l!==h)&&(s.font=`${v*this.#u}px ${h}`,e.prevFontSize=v,e.prevFontFamily=h);const{width:y}=s.measureText(t.textContent);y>0&&(d=`scaleX(${p*this.#u/y}) ${d}`)}n.angle!==0&&(d=`rotate(${n.angle}deg) ${d}`),d.length>0&&(u.transform=d)}static cleanup(){if(!(this.#S.size>0)){this.#_.clear();for(const{canvas:e}of this.#E.values())e.remove();this.#E.clear()}}static#C(e=null){let t=this.#E.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#E.set(e,t)}return t}static#A(){if(this.#w!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#w=e.getBoundingClientRect().height,e.remove()}static#y(e,t){const n=this.#_.get(e);if(n)return n;const s=this.#C(t),o=s.font;s.canvas.width=s.canvas.height=kt,s.font=`${kt}px ${e}`;const l=s.measureText("");let u=l.fontBoundingBoxAscent,d=Math.abs(l.fontBoundingBoxDescent);if(u){const v=u/(u+d);return this.#_.set(e,v),s.canvas.width=s.canvas.height=0,s.font=o,v}s.strokeStyle="red",s.clearRect(0,0,kt,kt),s.strokeText("g",0,0);let h=s.getImageData(0,0,kt,kt).data;d=0;for(let v=h.length-1-3;v>=0;v-=4)if(h[v]>0){d=Math.ceil(v/4/kt);break}s.clearRect(0,0,kt,kt),s.strokeText("A",0,kt),h=s.getImageData(0,0,kt,kt).data,u=0;for(let v=0,y=h.length;v<y;v+=4)if(h[v]>0){u=kt-Math.floor(v/4/kt);break}s.canvas.width=s.canvas.height=0,s.font=o;const p=u?u/(u+d):IC;return this.#_.set(e,p),p}}class ar{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(o){if(!o)return;let l=null;const u=o.name;if(u==="#text")l=o.value;else if(ar.shouldBuildText(u))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&t.push({str:l}),!!o.children)for(const d of o.children)s(d)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const RC=65536,bC=100,PC=5e3,MC=mt?$S:MS,NC=mt?WS:Vg,LC=mt?qS:PS,DC=mt?YS:Gg;function FC(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new sc,{docId:t}=e,n=i.url?UC(i.url):null,s=i.data?HC(i.data):null,o=i.httpHeaders||null,l=i.withCredentials===!0,u=i.password??null,d=i.range instanceof em?i.range:null,h=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:RC;let p=i.worker instanceof Wt?i.worker:null;const v=i.verbosity,y=typeof i.docBaseUrl=="string"&&!ra(i.docBaseUrl)?i.docBaseUrl:null,A=typeof i.cMapUrl=="string"?i.cMapUrl:null,w=i.cMapPacked!==!1,C=i.CMapReaderFactory||NC,T=typeof i.standardFontDataUrl=="string"?i.standardFontDataUrl:null,x=i.StandardFontDataFactory||DC,I=i.stopAtErrors!==!0,P=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,M=i.isEvalSupported!==!1,F=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!mt,H=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,O=typeof i.disableFontFace=="boolean"?i.disableFontFace:mt,K=i.fontExtraProperties===!0,q=i.enableXfa===!0,J=i.ownerDocument||globalThis.document,j=i.disableRange===!0,le=i.disableStream===!0,ge=i.disableAutoFetch===!0,Pe=i.pdfBug===!0,Te=i.enableHWA===!0,ye=d?d.length:i.length??NaN,X=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!mt&&!O,G=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:C===Vg&&x===Gg&&A&&T&&er(A,document.baseURI)&&er(T,document.baseURI),ae=i.canvasFactory||new MC({ownerDocument:J,enableHWA:Te}),Q=i.filterFactory||new LC({docId:t,ownerDocument:J}),N=null;ES(v);const V={canvasFactory:ae,filterFactory:Q};if(G||(V.cMapReaderFactory=new C({baseUrl:A,isCompressed:w}),V.standardFontDataFactory=new x({baseUrl:T})),!p){const Ee={verbosity:v,port:or.workerPort};p=Ee.port?Wt.fromPort(Ee):new Wt(Ee),e._worker=p}const oe={docId:t,apiVersion:"4.5.136",data:s,password:u,disableAutoFetch:ge,rangeChunkSize:h,length:ye,docBaseUrl:y,enableXfa:q,evaluatorOptions:{maxImageSize:P,disableFontFace:O,ignoreErrors:I,isEvalSupported:M,isOffscreenCanvasSupported:F,canvasMaxAreaInBytes:H,fontExtraProperties:K,useSystemFonts:X,cMapUrl:G?A:null,standardFontDataUrl:G?T:null}},ve={disableFontFace:O,fontExtraProperties:K,ownerDocument:J,pdfBug:Pe,styleElement:N,loadingParams:{disableAutoFetch:ge,enableXfa:q}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Ee=p.messageHandler.sendWithPromise("GetDocRequest",oe,s?[s.buffer]:null);let _e;if(d)_e=new cC(d,{disableRange:j,disableStream:le});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");_e=(Ae=>mt?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&er(Ae.url)?new eg(Ae):new wC(Ae):er(Ae.url)?new eg(Ae):new yC(Ae))({url:n,length:ye,httpHeaders:o,withCredentials:l,rangeChunkSize:h,disableRange:j,disableStream:le})}return Ee.then(fe=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Ae=new tr(t,fe,p.port),De=new GC(Ae,e,_e,ve,V);e._transport=De,Ae.send("Ready",null)})}).catch(e._capability.reject),e}function UC(i){if(i instanceof URL)return i.href;try{return new URL(i,window.location).href}catch{if(mt&&typeof i=="string")return i}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function HC(i){if(mt&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return jo(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function tg(i){return typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0}class sc{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${sc.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}class em{constructor(e,t,n=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Le("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class BC{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return xe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class OC{#e=null;#t=!1;constructor(e,t,n,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new Vp:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new tm,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:o=!1}={}){return new ur({viewBox:this.view,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return xe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:s=Zn.ENABLE,transform:o=null,background:l=null,optionalContentConfigPromise:u=null,annotationCanvasMap:d=null,pageColors:h=null,printAnnotationStorage:p=null,isEditing:v=!1}){this._stats?.time("Overall");const y=this._transport.getRenderingIntent(n,s,p,v),{renderingIntent:A,cacheKey:w}=y;this.#t=!1,this.#s(),u||=this._transport.getOptionalContentConfig(A);let C=this._intentStates.get(w);C||(C=Object.create(null),this._intentStates.set(w,C)),C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null);const T=!!(A&Ut.PRINT);C.displayReadyCapability||(C.displayReadyCapability=Promise.withResolvers(),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(y));const x=M=>{C.renderTasks.delete(I),(this._maybeCleanupAfterRender||T)&&(this.#t=!0),this.#n(!T),M?(I.capability.reject(M),this._abortOperatorList({intentState:C,reason:M instanceof Error?M:new Error(M)})):I.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},I=new ji({callback:x,params:{canvasContext:e,viewport:t,transform:o,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:C.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:h});(C.renderTasks||=new Set).add(I);const P=I.task;return Promise.all([C.displayReadyCapability.promise,u]).then(([M,F])=>{if(this.destroyed){x();return}if(this._stats?.time("Rendering"),!(F.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");I.initializeGraphics({transparency:M,optionalContentConfig:F}),I.operatorListChanged()}).catch(x),P}getOperatorList({intent:e="display",annotationMode:t=Zn.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function o(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const l=this._transport.getRenderingIntent(e,t,n,s,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=o,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>ar.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function o(){l.read().then(function({value:d,done:h}){if(h){n(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),o()},s)}const l=t.getReader(),u={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,this.#s(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const t=this.#n(!1);return e&&t&&(this._stats&&=new Vp),t}#n(e=!1){if(this.#s(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},PC),!1;for(const{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#s(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:o,transfer:l}=n,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:s},l).getReader(),h=this._intentStates.get(t);h.streamReader=d;const p=()=>{d.read().then(({value:v,done:y})=>{if(y){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(v,h),p())},v=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const y of h.renderTasks)y.operatorListChanged();this.#n(!0)}if(h.displayReadyCapability)h.displayReadyCapability.reject(v);else if(h.opListReadCapability)h.opListReadCapability.reject(v);else throw v}})};p()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof Ku){let s=bC;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Ci(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,o]of this._intentStates)if(o===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}class VC{#e=new Set;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const s of this.#e)s.call(this,n)})}addEventListener(e,t){this.#e.add(t)}removeEventListener(e,t){this.#e.delete(t)}terminate(){this.#e.clear()}}const Rn={isWorkerDisabled:!1,fakeWorkerId:0};mt&&(Rn.isWorkerDisabled=!0,or.workerSrc||="./pdf.worker.mjs"),Rn.isSameOrigin=function(i,e){let t;try{if(t=new URL(i),!t.origin||t.origin==="null")return!1}catch{return!1}const n=new URL(e,t);return t.origin===n.origin},Rn.createCDNWrapper=function(i){const e=`await import("${i}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};class Wt{static#e;constructor({name:e=null,port:t=null,verbosity:n=AS()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(Wt.#e?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(Wt.#e||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return mt?Promise.all([mn.promise,this._readyCapability.promise]):this._readyCapability.promise}#t(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new tr("main","worker",e),this._messageHandler.on("ready",function(){}),this.#t()}_initialize(){if(Rn.isWorkerDisabled||Wt.#n){this._setupFakeWorker();return}let{workerSrc:e}=Wt;try{Rn.isSameOrigin(window.location.href,e)||(e=Rn.createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new tr("main","worker",t),s=()=>{o.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},o=new AbortController;t.addEventListener("error",()=>{this._webWorker||s()},{signal:o.signal}),n.on("test",u=>{if(o.abort(),this.destroyed||!u){s();return}this._messageHandler=n,this._port=t,this._webWorker=t,this.#t()}),n.on("ready",u=>{if(o.abort(),this.destroyed){s();return}try{l()}catch{this._setupFakeWorker()}});const l=()=>{const u=new Uint8Array;n.send("test",u,[u.buffer])};l();return}catch{Qo("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Rn.isWorkerDisabled||(Se("Setting up fake worker."),Rn.isWorkerDisabled=!0),Wt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new VC;this._port=t;const n=`fake${Rn.fakeWorkerId++}`,s=new tr(n+"_worker",n,t);e.setup(s,t),this._messageHandler=new tr(n,n+"_worker",t),this.#t()}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),Wt.#e?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#e?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Wt(e)}static get workerSrc(){if(or.workerSrc)return or.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#n(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return xe(this,"_setupFakeWorkerGlobal",(async()=>this.#n?this.#n:(await import(this.workerSrc)).WorkerMessageHandler)())}}class GC{#e=new Map;#t=new Map;#n=new Map;#s=new Map;#r=null;constructor(e,t,n,s,o){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new tm,this.fontLoader=new GS({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#i(e,t=null){const n=this.#e.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,s),s}get annotationStorage(){return xe(this,"annotationStorage",new ec)}getRenderingIntent(e,t=Zn.ENABLE,n=null,s=!1,o=!1){let l=Ut.DISPLAY,u=Ru;switch(e){case"any":l=Ut.ANY;break;case"display":break;case"print":l=Ut.PRINT;break;default:Se(`getRenderingIntent - invalid intent: ${e}`)}const d=l&Ut.PRINT&&n instanceof $g?n:this.annotationStorage;switch(t){case Zn.DISABLE:l+=Ut.ANNOTATIONS_DISABLE;break;case Zn.ENABLE:break;case Zn.ENABLE_FORMS:l+=Ut.ANNOTATIONS_FORMS;break;case Zn.ENABLE_STORAGE:l+=Ut.ANNOTATIONS_STORAGE,u=d.serializable;break;default:Se(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(l+=Ut.IS_EDITING),o&&(l+=Ut.OPLIST);const{ids:h,hash:p}=d.modifiedIds,v=[l,u.hash,p];return{renderingIntent:l,cacheKey:v.join("_"),annotationStorageSerializable:u,modifiedIds:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#n.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ht.cleanup(),this._networkStream?.cancelAllRequests(new Ci("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{tt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},s.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){s.close();return}tt(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{this._fullReader.cancel(o),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",n=>{const s=Promise.withResolvers(),o=this._fullReader;return o.headersReady.then(()=>{(!o.isStreamingSupported||!o.isRangeSupported)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),o.onProgress=l=>{t.onProgress?.({loaded:l.loaded,total:l.total})}),s.resolve({isStreamingSupported:o.isStreamingSupported,isRangeSupported:o.isRangeSupported,contentLength:o.contentLength})},s.reject),s.promise}),e.on("GetRangeReader",(n,s)=>{tt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){s.close();return}s.onPull=()=>{o.read().then(function({value:l,done:u}){if(u){s.close();return}tt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{o.cancel(l),s.ready.catch(u=>{if(!this.destroyed)throw u})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new BC(n,this))}),e.on("DocException",function(n){let s;switch(n.name){case"PasswordException":s=new ku(n.message,n.code);break;case"InvalidPDFException":s=new Hg(n.message);break;case"MissingPDFException":s=new Si(n.message);break;case"UnexpectedResponseException":s=new Zo(n.message,n.status);break;case"UnknownErrorException":s=new Iu(n.message,n.details);break;default:Le("DocException - expected a valid Error.")}t._capability.reject(s)}),e.on("PasswordRequest",n=>{if(this.#r=Promise.withResolvers(),t.onPassword){const s=o=>{o instanceof Error?this.#r.reject(o):this.#r.resolve({password:o})};try{t.onPassword(s,n.code)}catch(o){this.#r.reject(o)}}else this.#r.reject(new ku(n.message,n.code));return this.#r.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,o])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":const{disableFontFace:l,fontExtraProperties:u,pdfBug:d}=this._params;if("error"in o){const y=o.error;Se(`Error during font loading: ${y}`),this.commonObjs.resolve(n,y);break}const h=d&&globalThis.FontInspector?.enabled?(y,A)=>globalThis.FontInspector.fontAdded(y,A):null,p=new zS(o,{disableFontFace:l,inspectFont:h});this.fontLoader.bind(p).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!u&&p.data&&(p.data=null),this.commonObjs.resolve(n,p)});break;case"CopyLocalImage":const{imageRef:v}=o;tt(v,"The imageRef must be defined.");for(const y of this.#t.values())for(const[,A]of y.objs)if(A?.ref===v)return A.dataLen?(this.commonObjs.resolve(n,structuredClone(A)),A.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,o,l])=>{if(this.destroyed)return;const u=this.#t.get(s);if(!u.objs.has(n)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":u.objs.resolve(n,l),l?.dataLen>mS&&(u._maybeCleanupAfterRender=!0);break;case"Pattern":u.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(n):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(n):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Se("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#n.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#s.set(o.refStr,e);const l=new OC(t,o,this,this._params.pdfBug);return this.#t.set(t,l),l});return this.#n.set(t,s),s}getPageIndex(e){return tg(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#i("GetOptionalContentConfig").then(t=>new uC(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new aC(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ht.cleanup()}}cachedPageNumber(e){if(!tg(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#s.get(t)??null}}const bo=Symbol("INITIAL_DATA");class tm{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:bo}}get(e,t=null){if(t){const s=this.#t(e);return s.promise.then(()=>t(s.data)),null}const n=this.#e[e];if(!n||n.data===bo)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==bo}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==bo&&(yield[e,t])}}}class zC{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class ji{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:o,operatorList:l,pageIndex:u,canvasFactory:d,filterFactory:h,useRequestAnimationFrame:p=!1,pdfBug:v=!1,pageColors:y=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=h,this._pdfBug=v,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new zC(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(ji.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ji.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:s,transform:o,background:l}=this.params;this.gfx=new is(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:s,transparency:e,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),ji.#t.delete(this._canvas),this.callback(e||new Ku(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ji.#t.delete(this._canvas),this.callback())))}}const qC="4.5.136",$C="3a21f03b0";function ng(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function Qs(i){return Math.max(0,Math.min(255,255*i))}class ig{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Qs(e),[e,e,e]}static G_HTML([e]){const t=ng(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Qs)}static RGB_HTML(e){return`#${e.map(ng).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[Qs(1-Math.min(1,e+s)),Qs(1-Math.min(1,n+s)),Qs(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,o=1-t,l=1-n,u=Math.min(s,o,l);return["CMYK",s,o,l,u]}}class nm{static setupStorage(e,t,n,s,o){const l=s.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),o==="print")break;e.addEventListener("input",u=>{s.setValue(t,{value:u.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",u=>{s.setValue(t,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),o==="print")break;e.addEventListener("input",u=>{s.setValue(t,{value:u.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const u of n.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}e.addEventListener("input",u=>{const d=u.target.options,h=d.selectedIndex===-1?"":d[d.selectedIndex].value;s.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:o}){const{attributes:l}=t,u=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[d,h]of Object.entries(l))if(h!=null)switch(d){case"class":h.length&&e.setAttribute(d,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!u||d!=="href"&&d!=="newWindow")&&e.setAttribute(d,h)}u&&o.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,o=e.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:o,linkService:n});const u=o!=="richText",d=e.div;if(d.append(l),e.viewport){const v=`matrix(${e.viewport.transform.join(",")})`;d.style.transform=v}u&&d.setAttribute("class","xfaLayer xfaFont");const h=[];if(s.children.length===0){if(s.value){const v=document.createTextNode(s.value);l.append(v),u&&ar.shouldBuildText(s.name)&&h.push(v)}return{textDivs:h}}const p=[[s,-1,l]];for(;p.length>0;){const[v,y,A]=p.at(-1);if(y+1===v.children.length){p.pop();continue}const w=v.children[++p.at(-1)[1]];if(w===null)continue;const{name:C}=w;if(C==="#text"){const x=document.createTextNode(w.value);h.push(x),A.append(x);continue}const T=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,C):document.createElement(C);if(A.append(T),w.attributes&&this.setAttributes({html:T,element:w,storage:t,intent:o,linkService:n}),w.children?.length>0)p.push([w,-1,T]);else if(w.value){const x=document.createTextNode(w.value);u&&ar.shouldBuildText(C)&&h.push(x),T.append(x)}}for(const v of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))v.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const hr=1e3,WC=9,Ei=new WeakSet;function bn(i){return{width:i[2]-i[0],height:i[3]-i[1]}}class YC{static create(e){switch(e.data.annotationType){case je.LINK:return new im(e);case je.TEXT:return new KC(e);case je.WIDGET:switch(e.data.fieldType){case"Tx":return new JC(e);case"Btn":return e.data.radioButton?new sm(e):e.data.checkBox?new QC(e):new ZC(e);case"Ch":return new jC(e);case"Sig":return new XC(e)}return new Ti(e);case je.POPUP:return new Nu(e);case je.FREETEXT:return new rm(e);case je.LINE:return new tT(e);case je.SQUARE:return new nT(e);case je.CIRCLE:return new iT(e);case je.POLYLINE:return new om(e);case je.CARET:return new rT(e);case je.INK:return new am(e);case je.POLYGON:return new sT(e);case je.HIGHLIGHT:return new oT(e);case je.UNDERLINE:return new aT(e);case je.SQUIGGLY:return new lT(e);case je.STRIKEOUT:return new uT(e);case je.STAMP:return new lm(e);case je.FILEATTACHMENT:return new cT(e);default:return new Ye(e)}}}class Ye{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e?.str||t?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ye._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#s(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#s(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#s(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:u,pageY:d}}}}=this;n?.splice(0,4,...e);const{width:h,height:p}=bn(e);t.left=`${100*(e[0]-u)/o}%`,t.top=`${100*(l-e[3]+d)/l}%`,s===0?(t.width=`${100*h/o}%`,t.height=`${100*p/l}%`):this.setRotation(s)}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),this instanceof Ti||(o.tabIndex=hr);const{style:l}=o;if(l.zIndex=this.parent.zIndex++,t.popupRef&&o.setAttribute("aria-haspopup","dialog"),t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof Nu){const{rotation:C}=t;return!t.hasOwnCanvas&&C!==0&&this.setRotation(C,o),o}const{width:u,height:d}=bn(t.rect);if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const C=t.borderStyle.horizontalCornerRadius,T=t.borderStyle.verticalCornerRadius;if(C>0||T>0){const I=`calc(${C}px * var(--scale-factor)) / calc(${T}px * var(--scale-factor))`;l.borderRadius=I}else if(this instanceof sm){const I=`calc(${u}px * var(--scale-factor)) / calc(${d}px * var(--scale-factor))`;l.borderRadius=I}switch(t.borderStyle.style){case Js.SOLID:l.borderStyle="solid";break;case Js.DASHED:l.borderStyle="dashed";break;case Js.BEVELED:Se("Unimplemented border style: beveled");break;case Js.INSET:Se("Unimplemented border style: inset");break;case Js.UNDERLINE:l.borderBottomStyle="solid";break}const x=t.borderColor||null;x?(this.#t=!0,l.borderColor=re.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):l.borderWidth=0}const h=re.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:v,pageX:y,pageY:A}=s.rawDims;l.left=`${100*(h[0]-y)/p}%`,l.top=`${100*(h[1]-A)/v}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(l.width=`${100*u/p}%`,l.height=`${100*d/v}%`):this.setRotation(w,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims,{width:o,height:l}=bn(this.data.rect);let u,d;e%180===0?(u=100*o/n,d=100*l/s):(u=100*l/n,d=100*o/s),t.style.width=`${u}%`,t.style.height=`${d}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const o=s.detail[t],l=o[0],u=o.slice(1);s.target.style[n]=ig[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[n]:ig[`${l}_rgb`](u)})};return xe(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail))(e[s]||n[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,o]of Object.entries(t)){const l=n[s];if(l){const u={detail:{[s]:o},target:e};l(u),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,o]=this.data.rect.map(C=>Math.fround(C));if(e.length===8){const[C,T,x,I]=e.subarray(2,6);if(s===C&&o===T&&t===x&&n===I)return}const{style:l}=this.container;let u;if(this.#t){const{borderColor:C,borderWidth:T}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${C}" stroke-width="${T}">`],this.container.classList.add("hasBorder")}const d=s-t,h=o-n,{svgFactory:p}=this,v=p.createElement("svg");v.classList.add("quadrilateralsContainer"),v.setAttribute("width",0),v.setAttribute("height",0);const y=p.createElement("defs");v.append(y);const A=p.createElement("clipPath"),w=`clippath_${this.data.id}`;A.setAttribute("id",w),A.setAttribute("clipPathUnits","objectBoundingBox"),y.append(A);for(let C=2,T=e.length;C<T;C+=8){const x=e[C],I=e[C+1],P=e[C+2],M=e[C+3],F=p.createElement("rect"),H=(P-t)/d,O=(o-I)/h,K=(x-P)/d,q=(I-M)/h;F.setAttribute("x",H),F.setAttribute("y",O),F.setAttribute("width",K),F.setAttribute("height",q),A.append(F),u?.push(`<rect vector-effect="non-scaling-stroke" x="${H}" y="${O}" width="${K}" height="${q}"/>`)}this.#t&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(v),this.container.style.clipPath=`url(#${w})`}_createPopup(){const{container:e,data:t}=this;e.setAttribute("aria-haspopup","dialog");const n=this.#n=new Nu({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(n.render())}render(){Le("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:o,id:l,exportValues:u}of s){if(o===-1||l===t)continue;const d=typeof u=="string"?u:null,h=document.querySelector(`[data-element-id="${l}"]`);if(h&&!Ei.has(h)){Se(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:d,domElement:h})}return n}for(const s of document.getElementsByName(e)){const{exportValue:o}=s,l=s.getAttribute("data-element-id");l!==t&&Ei.has(s)&&n.push({id:l,exportValue:o,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}class im extends Ye{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action),s=!0):e.attachment?(this.#t(n,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(this.#n(n,e.setOCGState),s=!0):e.dest?(this._bindLink(n,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(n),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,n=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,n),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const o=n.get(s);o&&(e[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Se('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:s,refs:o,include:l}=t,u=[];if(s.length!==0||o.length!==0){const p=new Set(o);for(const v of s){const y=this._fieldObjects[v]||[];for(const{id:A}of y)p.add(A)}for(const v of Object.values(this._fieldObjects))for(const y of v)p.has(y.id)===l&&u.push(y)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const d=this.annotationStorage,h=[];for(const p of u){const{id:v}=p;switch(h.push(v),p.type){case"text":{const A=p.defaultValue||"";d.setValue(v,{value:A});break}case"checkbox":case"radiobutton":{const A=p.defaultValue===p.exportValues;d.setValue(v,{value:A});break}case"combobox":case"listbox":{const A=p.defaultValue||"";d.setValue(v,{value:A});break}default:continue}const y=document.querySelector(`[data-element-id="${v}"]`);if(y){if(!Ei.has(y)){Se(`_bindResetFormAction - element not allowed: ${v}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}}),!1}}}class KC extends Ye{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Ti extends Ye{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Rt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,o){n.includes("mouse")?e.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l)}})})}_setEventListeners(e,t,n,s){for(const[o,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,o,l,s),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":re.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||WC,o=e.style;let l;const u=2,d=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(h/(cu*s))||1,v=h/p;l=Math.min(s,d(v/cu))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(s,d(h/cu))}o.fontSize=`calc(${l}px * var(--scale-factor))`,o.color=re.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class JC extends Ti{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const o=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),o.setValue(l.id,{[s]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let o=s.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=s.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",u??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Ei.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=hr,this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",p=>{e.setValue(t,{value:p.target.value}),this.setPropertyOnSiblings(n,"value",p.target.value,"value"),d.formattedValue=null}),n.addEventListener("resetform",p=>{const v=this.data.defaultFieldValue??"";n.value=d.userValue=v,d.formattedValue=null});let h=p=>{const{formattedValue:v}=d;v!=null&&(p.target.value=v),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",v=>{if(d.focused)return;const{target:y}=v;d.userValue&&(y.value=d.userValue),d.lastCommittedValue=y.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),n.addEventListener("updatefromsandbox",v=>{this.showElementAndHideCanvas(v.target);const y={value(A){d.userValue=A.detail.value??"",e.setValue(t,{value:d.userValue.toString()}),A.target.value=d.userValue},formattedValue(A){const{formattedValue:w}=A.detail;d.formattedValue=w,w!=null&&A.target!==document.activeElement&&(A.target.value=w),e.setValue(t,{formattedValue:w})},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{const{charLimit:w}=A.detail,{target:C}=A;if(w===0){C.removeAttribute("maxLength");return}C.setAttribute("maxLength",w);let T=d.userValue;!T||T.length<=w||(T=T.slice(0,w),C.value=d.userValue=T,e.setValue(t,{value:T}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,willCommit:!0,commitKey:1,selStart:C.selectionStart,selEnd:C.selectionEnd}}))}};this._dispatchEventFromSandbox(y,v)}),n.addEventListener("keydown",v=>{d.commitKey=1;let y=-1;if(v.key==="Escape"?y=0:v.key==="Enter"&&!this.data.multiLine?y=2:v.key==="Tab"&&(d.commitKey=3),y===-1)return;const{value:A}=v.target;d.lastCommittedValue!==A&&(d.lastCommittedValue=A,d.userValue=A,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:y,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}))});const p=h;h=null,n.addEventListener("blur",v=>{if(!d.focused||!v.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{value:y}=v.target;d.userValue=y,d.lastCommittedValue!==y&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:d.commitKey,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}),p(v)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",v=>{d.lastCommittedValue=null;const{data:y,target:A}=v,{value:w,selectionStart:C,selectionEnd:T}=A;let x=C,I=T;switch(v.inputType){case"deleteWordBackward":{const P=w.substring(0,C).match(/\w*[^\w]*$/);P&&(x-=P[0].length);break}case"deleteWordForward":{const P=w.substring(C).match(/^[^\w]*\w*/);P&&(I+=P[0].length);break}case"deleteContentBackward":C===T&&(x-=1);break;case"deleteContentForward":C===T&&(I+=1);break}v.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,change:y||"",willCommit:!1,selStart:x,selEnd:I}})}),this._setEventListeners(n,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],v=>v.target.value)}if(h&&n.addEventListener("blur",h),this.data.comb){const v=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${v}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class XC extends Ti{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class QC extends Ti{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return Ei.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=hr,o.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const h of this._getElementsByName(u,n)){const p=d&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=p),e.setValue(h.id,{value:p})}e.setValue(n,{value:d})}),o.addEventListener("resetform",l=>{const u=t.defaultFieldValue||"Off";l.target.checked=u===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const u={value(d){d.target.checked=d.detail.value!=="Off",e.setValue(n,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class sm extends Ti{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const o=document.createElement("input");if(Ei.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.tabIndex=hr,o.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const h of this._getElementsByName(u,n))e.setValue(h.id,{value:!1});e.setValue(n,{value:d})}),o.addEventListener("resetform",l=>{const u=t.defaultFieldValue;l.target.checked=u!=null&&u===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;o.addEventListener("updatefromsandbox",u=>{const d={value:h=>{const p=l===h.detail.value;for(const v of this._getElementsByName(h.target.name)){const y=p&&v.id===n;v.domElement&&(v.domElement.checked=y),e.setValue(v.id,{value:y})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class ZC extends im{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class jC extends Ti{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");Ei.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=hr;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",p=>{const v=this.data.defaultFieldValue;for(const y of s.options)y.selected=y.value===v});for(const p of this.data.options){const v=document.createElement("option");v.textContent=p.displayValue,v.value=p.exportValue,n.value.includes(p.exportValue)&&(v.setAttribute("selected",!0),o=!1),s.append(v)}let l=null;if(o){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),s.prepend(p),l=()=>{p.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const u=p=>{const v=p?"value":"textContent",{options:y,multiple:A}=s;return A?Array.prototype.filter.call(y,w=>w.selected).map(w=>w[v]):y.selectedIndex===-1?null:y[y.selectedIndex][v]};let d=u(!1);const h=p=>{const v=p.target.options;return Array.prototype.map.call(v,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",p=>{const v={value(y){l?.();const A=y.detail.value,w=new Set(Array.isArray(A)?A:[A]);for(const C of s.options)C.selected=w.has(C.value);e.setValue(t,{value:u(!0)}),d=u(!1)},multipleSelection(y){s.multiple=!0},remove(y){const A=s.options,w=y.detail.remove;A[w].selected=!1,s.remove(w),A.length>0&&Array.prototype.findIndex.call(A,T=>T.selected)===-1&&(A[0].selected=!0),e.setValue(t,{value:u(!0),items:h(y)}),d=u(!1)},clear(y){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),d=u(!1)},insert(y){const{index:A,displayValue:w,exportValue:C}=y.detail.insert,T=s.children[A],x=document.createElement("option");x.textContent=w,x.value=C,T?T.before(x):s.append(x),e.setValue(t,{value:u(!0),items:h(y)}),d=u(!1)},items(y){const{items:A}=y.detail;for(;s.length!==0;)s.remove(0);for(const w of A){const{displayValue:C,exportValue:T}=w,x=document.createElement("option");x.textContent=C,x.value=T,s.append(x)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:u(!0),items:h(y)}),d=u(!1)},indices(y){const A=new Set(y.detail.indices);for(const w of y.target.options)w.selected=A.has(w.index);e.setValue(t,{value:u(!0)}),d=u(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(v,p)}),s.addEventListener("input",p=>{const v=u(!0),y=u(!1);e.setValue(t,{value:v}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:d,change:y,changeEx:v,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):s.addEventListener("input",function(p){e.setValue(t,{value:u(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Nu extends Ye{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:Ye._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new eT({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${Og}${n}`).join(",")),this.container}}class eT{#e=this.#k.bind(this);#t=this.#y.bind(this);#n=this.#A.bind(this);#s=this.#C.bind(this);#r=null;#i=null;#o=null;#l=null;#c=null;#d=null;#h=null;#u=!1;#a=null;#p=null;#g=null;#f=null;#m=null;#v=null;#_=!1;constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:o,contentsObj:l,richText:u,parent:d,rect:h,parentRect:p,open:v}){this.#i=e,this.#m=s,this.#o=l,this.#f=u,this.#d=d,this.#r=t,this.#g=h,this.#h=p,this.#c=n,this.#l=zg.toDateObject(o),this.trigger=n.flatMap(y=>y.getElementsToTriggerPopup());for(const y of this.trigger)y.addEventListener("click",this.#s),y.addEventListener("mouseenter",this.#n),y.addEventListener("mouseleave",this.#t),y.classList.add("popupTriggerArea");for(const y of n)y.container?.addEventListener("keydown",this.#e);this.#i.hidden=!0,v&&this.#C()}render(){if(this.#a)return;const e=this.#a=document.createElement("div");if(e.className="popup",this.#r){const o=e.style.outlineColor=re.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${o} 30%, white)`:e.style.backgroundColor=re.makeHexColor(...this.#r.map(u=>Math.floor(.7*(255-u)+u)))}const t=document.createElement("span");t.className="header";const n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=this.#m,e.append(t),this.#l){const o=document.createElement("span");o.classList.add("popupDate"),o.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),o.setAttribute("data-l10n-args",JSON.stringify({date:this.#l.toLocaleDateString(),time:this.#l.toLocaleTimeString()})),t.append(o)}const s=this.#E;if(s)nm.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const o=this._formatContents(this.#o);e.append(o)}this.#i.append(e)}get#E(){const e=this.#f,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#f.html||null}get#w(){return this.#E?.attributes?.style?.fontSize||0}get#S(){return this.#E?.attributes?.style?.color||null}#b(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#S,fontSize:this.#w?`calc(${this.#w}px * var(--scale-factor))`:""}};for(const o of e.split(`
`))t.push({name:"span",value:o,attributes:s});return n}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let o=0,l=s.length;o<l;++o){const u=s[o];n.append(document.createTextNode(u)),o<l-1&&n.append(document.createElement("br"))}return n}#k(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#u)&&this.#C()}updateEdited({rect:e,popupContent:t}){this.#v||={contentsObj:this.#o,richText:this.#f},e&&(this.#p=null),t&&(this.#f=this.#b(t),this.#o=null),this.#a?.remove(),this.#a=null}resetEdited(){this.#v&&({contentsObj:this.#o,richText:this.#f}=this.#v,this.#v=null,this.#a?.remove(),this.#a=null,this.#p=null)}#I(){if(this.#p!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:o}}}=this.#d;let l=!!this.#h,u=l?this.#h:this.#g;for(const w of this.#c)if(!u||re.intersect(w.data.rect,u)!==null){u=w.data.rect,l=!0;break}const d=re.normalizeRect([u[0],e[3]-u[1]+e[1],u[2],e[3]-u[3]+e[1]]),p=l?u[2]-u[0]+5:0,v=d[0]+p,y=d[1];this.#p=[100*(v-s)/t,100*(y-o)/n];const{style:A}=this.#i;A.left=`${this.#p[0]}%`,A.top=`${this.#p[1]}%`}#C(){this.#u=!this.#u,this.#u?(this.#A(),this.#i.addEventListener("click",this.#s),this.#i.addEventListener("keydown",this.#e)):(this.#y(),this.#i.removeEventListener("click",this.#s),this.#i.removeEventListener("keydown",this.#e))}#A(){this.#a||this.render(),this.isVisible?this.#u&&this.#i.classList.add("focused"):(this.#I(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#y(){this.#i.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#i.hidden=!0)}maybeShow(){this.#_&&(this.#a||this.#A(),this.#_=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class rm extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ce.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class tT extends Ye{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:n}=bn(e.rect),s=this.svgFactory.create(t,n,!0),o=this.#e=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class nT extends Ye{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:n}=bn(e.rect),s=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",t-o),l.setAttribute("height",n-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class iT extends Ye{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:n}=bn(e.rect),s=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",t/2),l.setAttribute("cy",n/2),l.setAttribute("rx",t/2-o/2),l.setAttribute("ry",n/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class om extends Ye{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:s}}=this;if(!t)return this.container;const{width:o,height:l}=bn(e),u=this.svgFactory.create(o,l,!0);let d=[];for(let p=0,v=t.length;p<v;p+=2){const y=t[p]-e[0],A=e[3]-t[p+1];d.push(`${y},${A}`)}d=d.join(" ");const h=this.#e=this.svgFactory.createElement(this.svgElementName);return h.setAttribute("points",d),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),u.append(h),this.container.append(u),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class sT extends om{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class rT extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class am extends Ye{#e=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=Ce.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,inkLists:t,borderStyle:n,popupRef:s}}=this,{width:o,height:l}=bn(e),u=this.svgFactory.create(o,l,!0);for(const d of t){let h=[];for(let v=0,y=d.length;v<y;v+=2){const A=d[v]-e[0],w=e[3]-d[v+1];h.push(`${A},${w}`)}h=h.join(" ");const p=this.svgFactory.createElement(this.svgElementName);this.#e.push(p),p.setAttribute("points",h),p.setAttribute("stroke-width",n.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),!s&&this.hasPopupData&&this._createPopup(),u.append(p)}return this.container.append(u),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class oT extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class aT extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class lT extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class uT extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class lm extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class cT extends Ye{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:s}=Rt.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class dT{#e=null;#t=null;#n=new Map;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:o,viewport:l}){this.div=e,this.#e=t,this.#t=n,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return this.#n.size>0}#s(e,t){const n=e.firstChild||e;n.id=`${Og}${t}`,this.div.append(e),this.#e?.moveElementInDOM(this.div,e,n,!1)}async render(e){const{annotations:t}=e,n=this.div;_i(n,this.viewport);const s=new Map,o={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Yu,annotationStorage:e.annotationStorage||new ec,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const u=l.annotationType===je.POPUP;if(u){const p=s.get(l.id);if(!p)continue;o.elements=p}else{const{width:p,height:v}=bn(l.rect);if(p<=0||v<=0)continue}o.data=l;const d=YC.create(o);if(!d.isRenderable)continue;if(!u&&l.popupRef){const p=s.get(l.popupRef);p?p.push(d):s.set(l.popupRef,[d])}const h=d.render();l.hidden&&(h.style.visibility="hidden"),this.#s(h,l.id),d._isEditable&&(this.#n.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}this.#r()}update({viewport:e}){const t=this.div;this.viewport=e,_i(t,{rotation:e.rotation}),this.#r(),t.hidden=!1}#r(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(n):o.classList.contains("annotationContent")?o.after(n):o.before(n):s.append(n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}}const Po=/\r\n?|\n/g;class et extends he{#e=this.editorDivBlur.bind(this);#t=this.editorDivFocus.bind(this);#n=this.editorDivInput.bind(this);#s=this.editorDivKeydown.bind(this);#r=this.editorDivPaste.bind(this);#i;#o="";#l=`${this.id}-editor`;#c;#d=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=et.prototype,t=o=>o.isEmpty(),n=jn.TRANSLATE_SMALL,s=jn.TRANSLATE_BIG;return xe(this,"_keyboardManager",new cr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=Ce.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#i=e.color||et._defaultColor||he._defaultLineColor,this.#c=e.fontSize||et._defaultFontSize}static initialize(e,t){he.initialize(e,t,{strings:["pdfjs-free-text-default-content"]});const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case pe.FREETEXT_SIZE:et._defaultFontSize=t;break;case pe.FREETEXT_COLOR:et._defaultColor=t;break}}updateParams(e,t){switch(e){case pe.FREETEXT_SIZE:this.#h(t);break;case pe.FREETEXT_COLOR:this.#u(t);break}}static get defaultPropertiesToUpdate(){return[[pe.FREETEXT_SIZE,et._defaultFontSize],[pe.FREETEXT_COLOR,et._defaultColor||he._defaultLineColor]]}get propertiesToUpdate(){return[[pe.FREETEXT_SIZE,this.#c],[pe.FREETEXT_COLOR,this.#i]]}#h(e){const t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-this.#c)*this.parentScale),this.#c=s,this.#p()},n=this.#c;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#u(e){const t=s=>{this.#i=this.editorDiv.style.color=s},n=this.#i;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-et._internalPadding*e,-(et._internalPadding+this.#c)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Ce.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant");const e=this._uiManager._signal;this.editorDiv.addEventListener("keydown",this.#s,{signal:e}),this.editorDiv.addEventListener("focus",this.#t,{signal:e}),this.editorDiv.addEventListener("blur",this.#e,{signal:e}),this.editorDiv.addEventListener("input",this.#n,{signal:e}),this.editorDiv.addEventListener("paste",this.#r,{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#l),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#s),this.editorDiv.removeEventListener("focus",this.#t),this.editorDiv.removeEventListener("blur",this.#e),this.editorDiv.removeEventListener("input",this.#n),this.editorDiv.removeEventListener("paste",this.#r),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#a(){const e=[];this.editorDiv.normalize();for(const t of this.editorDiv.childNodes)e.push(et.#g(t));return e.join(`
`)}#p(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,l=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#o,t=this.#o=this.#a().trimEnd();if(e===t)return;const n=s=>{if(this.#o=s,!s){this.remove();return}this.#f(),this._uiManager.rebuild(this),this.#p()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#p()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){et._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#l),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),he._l10nPromise.get("pdfjs-free-text-default-content").then(s=>this.editorDiv?.setAttribute("default-content",s)),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#c}px * var(--scale-factor))`,n.color=this.#i,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Bo(this,this.div,["dblclick","keydown"]),this.width){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this.#d;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[h,p]=this.pageDimensions,[v,y]=this.pageTranslation;let A,w;switch(this.rotation){case 0:A=e+(l[0]-v)/h,w=t+this.height-(l[1]-y)/p;break;case 90:A=e+(l[0]-v)/h,w=t-(l[1]-y)/p,[u,d]=[d,-u];break;case 180:A=e-this.width+(l[0]-v)/h,w=t-(l[1]-y)/p,[u,d]=[-u,-d];break;case 270:A=e+(l[0]-v-this.height*p)/h,w=t+(l[1]-y-this.width*h)/p,[u,d]=[-d,u];break}this.setAt(A*s,w*o,u,d)}else this.setAt(e*s,t*o,this.width*s,this.height*o);this.#f(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#g(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Po,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const s=et.#v(t.getData("text")||"").replaceAll(Po,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:d}=l,h=[],p=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(p.push(u.nodeValue.slice(d).replaceAll(Po,"")),A!==this.editorDiv){let w=h;for(const C of this.editorDiv.childNodes){if(C===A){w=p;continue}w.push(et.#g(C))}}h.push(u.nodeValue.slice(0,d).replaceAll(Po,""))}else if(u===this.editorDiv){let A=h,w=0;for(const C of this.editorDiv.childNodes)w++===d&&(A=p),A.push(et.#g(C))}this.#o=`${h.join(`
`)}${s}${p.join(`
`)}`,this.#f();const v=new Range;let y=h.reduce((A,w)=>A+w.length,0);for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const w=A.nodeValue.length;if(y<=w){v.setStart(A,y),v.setEnd(A,y);break}y-=w}o.removeAllRanges(),o.addRange(v)}#f(){if(this.editorDiv.replaceChildren(),!!this.#o)for(const e of this.#o.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#m(){return this.#o.replaceAll(" "," ")}static#v(e){return e.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static deserialize(e,t,n){let s=null;if(e instanceof rm){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:d,rotation:h,id:p},textContent:v,textPosition:y,parent:{page:{pageNumber:A}}}=e;if(!v||v.length===0)return null;s=e={annotationType:Ce.FREETEXT,color:Array.from(u),fontSize:l,value:v.join(`
`),position:y,pageIndex:A-1,rect:d.slice(0),rotation:h,id:p,deleted:!1}}const o=super.deserialize(e,t,n);return o.#c=e.fontSize,o.#i=re.makeHexColor(...e.color),o.#o=et.#v(e.value),o.annotationElementId=e.id||null,o.#d=s,o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const t=et._internalPadding*this.parentScale,n=this.getRect(t,t),s=he._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#i),o={annotationType:Ce.FREETEXT,color:s,fontSize:this.#c,value:this.#m(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!this.#_(o)?null:(o.id=this.annotationElementId,o)}#_(e){const{value:t,fontSize:n,color:s,pageIndex:o}=this.#d;return this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((l,u)=>l!==s[u])||e.pageIndex!==o}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:n}=t;n.fontSize=`calc(${this.#c}px * var(--scale-factor))`,n.color=this.#i,t.replaceChildren();for(const o of this.#o.split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),t.append(l)}const s=et._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:this.#o}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class sg{#e;#t=[];#n=[];constructor(e,t=0,n=0,s=!0){let o=1/0,l=-1/0,u=1/0,d=-1/0;const h=10**-4;for(const{x:T,y:x,width:I,height:P}of e){const M=Math.floor((T-t)/h)*h,F=Math.ceil((T+I+t)/h)*h,H=Math.floor((x-t)/h)*h,O=Math.ceil((x+P+t)/h)*h,K=[M,H,O,!0],q=[F,H,O,!1];this.#t.push(K,q),o=Math.min(o,M),l=Math.max(l,F),u=Math.min(u,H),d=Math.max(d,O)}const p=l-o+2*n,v=d-u+2*n,y=o-n,A=u-n,w=this.#t.at(s?-1:-2),C=[w[0],w[2]];for(const T of this.#t){const[x,I,P]=T;T[0]=(x-y)/p,T[1]=(I-A)/v,T[2]=(P-A)/v}this.#e={x:y,y:A,width:p,height:v,lastPoint:C}}getOutlines(){this.#t.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#t)t[3]?(e.push(...this.#l(t)),this.#i(t)):(this.#o(t),e.push(...this.#l(t)));return this.#s(e)}#s(e){const t=[],n=new Set;for(const l of e){const[u,d,h]=l;t.push([u,d,l],[u,h,l])}t.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=t.length;l<u;l+=2){const d=t[l][2],h=t[l+1][2];d.push(h),h.push(d),n.add(d),n.add(h)}const s=[];let o;for(;n.size>0;){const l=n.values().next().value;let[u,d,h,p,v]=l;n.delete(l);let y=u,A=d;for(o=[u,h],s.push(o);;){let w;if(n.has(p))w=p;else if(n.has(v))w=v;else break;n.delete(w),[u,d,h,p,v]=w,y!==u&&(o.push(y,A,u,A===d?d:h),y=u),A=A===d?h:d}o.push(y,A)}return new hT(s,this.#e)}#r(e){const t=this.#n;let n=0,s=t.length-1;for(;n<=s;){const o=n+s>>1,l=t[o][0];if(l===e)return o;l<e?n=o+1:s=o-1}return s+1}#i([,e,t]){const n=this.#r(e);this.#n.splice(n,0,[e,t])}#o([,e,t]){const n=this.#r(e);for(let s=n;s<this.#n.length;s++){const[o,l]=this.#n[s];if(o!==e)break;if(o===e&&l===t){this.#n.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[o,l]=this.#n[s];if(o!==e)break;if(o===e&&l===t){this.#n.splice(s,1);return}}}#l(e){const[t,n,s]=e,o=[[t,n,s]],l=this.#r(s);for(let u=0;u<l;u++){const[d,h]=this.#n[u];for(let p=0,v=o.length;p<v;p++){const[,y,A]=o[p];if(!(h<=y||A<=d)){if(y>=d){if(A>h)o[p][1]=h;else{if(v===1)return[];o.splice(p,1),p--,v--}continue}o[p][2]=d,A>h&&o.push([t,h,A])}}}return o}}class um{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(e,t){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof Lu}}class hT extends um{#e;#t;constructor(e,t){super(),this.#t=e,this.#e=t}toSVGPath(){const e=[];for(const t of this.#t){let[n,s]=t;e.push(`M${n} ${s}`);for(let o=2;o<t.length;o+=2){const l=t[o],u=t[o+1];l===n?(e.push(`V${u}`),s=u):u===s&&(e.push(`H${l}`),n=l)}e.push("Z")}return e.join(" ")}serialize([e,t,n,s],o){const l=[],u=n-e,d=s-t;for(const h of this.#t){const p=new Array(h.length);for(let v=0;v<h.length;v+=2)p[v]=e+h[v]*u,p[v+1]=s-h[v+1]*d;l.push(p)}return l}get box(){return this.#e}}class vi{#e;#t=[];#n;#s;#r=[];#i=new Float64Array(18);#o;#l;#c;#d;#h;#u;#a=[];static#p=8;static#g=2;static#f=vi.#p+vi.#g;constructor({x:e,y:t},n,s,o,l,u=0){this.#e=n,this.#u=o*s,this.#s=l,this.#i.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=u,this.#d=vi.#p*s,this.#c=vi.#f*s,this.#h=s,this.#a.push(e,t)}get free(){return!0}isEmpty(){return isNaN(this.#i[8])}#m(){const e=this.#i.subarray(4,6),t=this.#i.subarray(16,18),[n,s,o,l]=this.#e;return[(this.#o+(e[0]-t[0])/2-n)/o,(this.#l+(e[1]-t[1])/2-s)/l,(this.#o+(t[0]-e[0])/2-n)/o,(this.#l+(t[1]-e[1])/2-s)/l]}add({x:e,y:t}){this.#o=e,this.#l=t;const[n,s,o,l]=this.#e;let[u,d,h,p]=this.#i.subarray(8,12);const v=e-h,y=t-p,A=Math.hypot(v,y);if(A<this.#c)return!1;const w=A-this.#d,C=w/A,T=C*v,x=C*y;let I=u,P=d;u=h,d=p,h+=T,p+=x,this.#a?.push(e,t);const M=-x/w,F=T/w,H=M*this.#u,O=F*this.#u;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([h+H,p+O],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([h-H,p-O],16),isNaN(this.#i[6])?(this.#r.length===0&&(this.#i.set([u+H,d+O],2),this.#r.push(NaN,NaN,NaN,NaN,(u+H-n)/o,(d+O-s)/l),this.#i.set([u-H,d-O],14),this.#t.push(NaN,NaN,NaN,NaN,(u-H-n)/o,(d-O-s)/l)),this.#i.set([I,P,u,d,h,p],6),!this.isEmpty()):(this.#i.set([I,P,u,d,h,p],6),Math.abs(Math.atan2(P-d,I-u)-Math.atan2(x,T))<Math.PI/2?([u,d,h,p]=this.#i.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+h)/2-n)/o,((d+p)/2-s)/l),[u,d,I,P]=this.#i.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((I+u)/2-n)/o,((P+d)/2-s)/l),!0):([I,P,u,d,h,p]=this.#i.subarray(0,6),this.#r.push(((I+5*u)/6-n)/o,((P+5*d)/6-s)/l,((5*u+h)/6-n)/o,((5*d+p)/6-s)/l,((u+h)/2-n)/o,((d+p)/2-s)/l),[h,p,u,d,I,P]=this.#i.subarray(12,18),this.#t.push(((I+5*u)/6-n)/o,((P+5*d)/6-s)/l,((5*u+h)/6-n)/o,((5*d+p)/6-s)/l,((u+h)/2-n)/o,((d+p)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#r,t=this.#t,n=this.#i.subarray(4,6),s=this.#i.subarray(16,18),[o,l,u,d]=this.#e,[h,p,v,y]=this.#m();if(isNaN(this.#i[6])&&!this.isEmpty())return`M${(this.#i[2]-o)/u} ${(this.#i[3]-l)/d} L${(this.#i[4]-o)/u} ${(this.#i[5]-l)/d} L${h} ${p} L${v} ${y} L${(this.#i[16]-o)/u} ${(this.#i[17]-l)/d} L${(this.#i[14]-o)/u} ${(this.#i[15]-l)/d} Z`;const A=[];A.push(`M${e[4]} ${e[5]}`);for(let w=6;w<e.length;w+=6)isNaN(e[w])?A.push(`L${e[w+4]} ${e[w+5]}`):A.push(`C${e[w]} ${e[w+1]} ${e[w+2]} ${e[w+3]} ${e[w+4]} ${e[w+5]}`);A.push(`L${(n[0]-o)/u} ${(n[1]-l)/d} L${h} ${p} L${v} ${y} L${(s[0]-o)/u} ${(s[1]-l)/d}`);for(let w=t.length-6;w>=6;w-=6)isNaN(t[w])?A.push(`L${t[w+4]} ${t[w+5]}`):A.push(`C${t[w]} ${t[w+1]} ${t[w+2]} ${t[w+3]} ${t[w+4]} ${t[w+5]}`);return A.push(`L${t[4]} ${t[5]} Z`),A.join(" ")}getOutlines(){const e=this.#r,t=this.#t,n=this.#i,s=n.subarray(4,6),o=n.subarray(16,18),[l,u,d,h]=this.#e,p=new Float64Array((this.#a?.length??0)+2);for(let x=0,I=p.length-2;x<I;x+=2)p[x]=(this.#a[x]-l)/d,p[x+1]=(this.#a[x+1]-u)/h;p[p.length-2]=(this.#o-l)/d,p[p.length-1]=(this.#l-u)/h;const[v,y,A,w]=this.#m();if(isNaN(n[6])&&!this.isEmpty()){const x=new Float64Array(36);return x.set([NaN,NaN,NaN,NaN,(n[2]-l)/d,(n[3]-u)/h,NaN,NaN,NaN,NaN,(n[4]-l)/d,(n[5]-u)/h,NaN,NaN,NaN,NaN,v,y,NaN,NaN,NaN,NaN,A,w,NaN,NaN,NaN,NaN,(n[16]-l)/d,(n[17]-u)/h,NaN,NaN,NaN,NaN,(n[14]-l)/d,(n[15]-u)/h],0),new Lu(x,p,this.#e,this.#h,this.#n,this.#s)}const C=new Float64Array(this.#r.length+24+this.#t.length);let T=e.length;for(let x=0;x<T;x+=2){if(isNaN(e[x])){C[x]=C[x+1]=NaN;continue}C[x]=e[x],C[x+1]=e[x+1]}C.set([NaN,NaN,NaN,NaN,(s[0]-l)/d,(s[1]-u)/h,NaN,NaN,NaN,NaN,v,y,NaN,NaN,NaN,NaN,A,w,NaN,NaN,NaN,NaN,(o[0]-l)/d,(o[1]-u)/h],T),T+=24;for(let x=t.length-6;x>=6;x-=6)for(let I=0;I<6;I+=2){if(isNaN(t[x+I])){C[T]=C[T+1]=NaN,T+=2;continue}C[T]=t[x+I],C[T+1]=t[x+I+1],T+=2}return C.set([NaN,NaN,NaN,NaN,t[4],t[5]],T),new Lu(C,p,this.#e,this.#h,this.#n,this.#s)}}class Lu extends um{#e;#t=null;#n;#s;#r;#i;#o;constructor(e,t,n,s,o,l){super(),this.#o=e,this.#r=t,this.#e=n,this.#i=s,this.#n=o,this.#s=l,this.#d(l);const{x:u,y:d,width:h,height:p}=this.#t;for(let v=0,y=e.length;v<y;v+=2)e[v]=(e[v]-u)/h,e[v+1]=(e[v+1]-d)/p;for(let v=0,y=t.length;v<y;v+=2)t[v]=(t[v]-u)/h,t[v+1]=(t[v+1]-d)/p}toSVGPath(){const e=[`M${this.#o[4]} ${this.#o[5]}`];for(let t=6,n=this.#o.length;t<n;t+=6){if(isNaN(this.#o[t])){e.push(`L${this.#o[t+4]} ${this.#o[t+5]}`);continue}e.push(`C${this.#o[t]} ${this.#o[t+1]} ${this.#o[t+2]} ${this.#o[t+3]} ${this.#o[t+4]} ${this.#o[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,s],o){const l=n-e,u=s-t;let d,h;switch(o){case 0:d=this.#l(this.#o,e,s,l,-u),h=this.#l(this.#r,e,s,l,-u);break;case 90:d=this.#c(this.#o,e,t,l,u),h=this.#c(this.#r,e,t,l,u);break;case 180:d=this.#l(this.#o,n,t,-l,u),h=this.#l(this.#r,n,t,-l,u);break;case 270:d=this.#c(this.#o,n,s,-l,-u),h=this.#c(this.#r,n,s,-l,-u);break}return{outline:Array.from(d),points:[Array.from(h)]}}#l(e,t,n,s,o){const l=new Float64Array(e.length);for(let u=0,d=e.length;u<d;u+=2)l[u]=t+e[u]*s,l[u+1]=n+e[u+1]*o;return l}#c(e,t,n,s,o){const l=new Float64Array(e.length);for(let u=0,d=e.length;u<d;u+=2)l[u]=t+e[u+1]*s,l[u+1]=n+e[u]*o;return l}#d(e){const t=this.#o;let n=t[4],s=t[5],o=n,l=s,u=n,d=s,h=n,p=s;const v=e?Math.max:Math.min;for(let T=6,x=t.length;T<x;T+=6){if(isNaN(t[T]))o=Math.min(o,t[T+4]),l=Math.min(l,t[T+5]),u=Math.max(u,t[T+4]),d=Math.max(d,t[T+5]),p<t[T+5]?(h=t[T+4],p=t[T+5]):p===t[T+5]&&(h=v(h,t[T+4]));else{const I=re.bezierBoundingBox(n,s,...t.slice(T,T+6));o=Math.min(o,I[0]),l=Math.min(l,I[1]),u=Math.max(u,I[2]),d=Math.max(d,I[3]),p<I[3]?(h=I[2],p=I[3]):p===I[3]&&(h=v(h,I[2]))}n=t[T+4],s=t[T+5]}const y=o-this.#n,A=l-this.#n,w=u-o+2*this.#n,C=d-l+2*this.#n;this.#t={x:y,y:A,width:w,height:C,lastPoint:[h,p]}}get box(){return this.#t}getNewOutline(e,t){const{x:n,y:s,width:o,height:l}=this.#t,[u,d,h,p]=this.#e,v=o*h,y=l*p,A=n*h+u,w=s*p+d,C=new vi({x:this.#r[0]*v+A,y:this.#r[1]*y+w},this.#e,this.#i,e,this.#s,t??this.#n);for(let T=2;T<this.#r.length;T+=2)C.add({x:this.#r[T]*v+A,y:this.#r[T+1]*y+w});return C.getOutlines()}}class gn{#e=this.#g.bind(this);#t=this.#m.bind(this);#n=null;#s=null;#r;#i=null;#o=!1;#l=!1;#c=null;#d;#h=null;#u;static get _keyboardManager(){return xe(this,"_keyboardManager",new cr([[["Escape","mac+Escape"],gn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],gn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],gn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],gn.prototype._moveToPrevious],[["Home","mac+Home"],gn.prototype._moveToBeginning],[["End","mac+End"],gn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#l=!1,this.#u=pe.HIGHLIGHT_COLOR,this.#c=e):(this.#l=!0,this.#u=pe.HIGHLIGHT_DEFAULT_COLOR),this.#h=e?._uiManager||t,this.#d=this.#h._eventBus,this.#r=e?.color||this.#h?.highlightColors.values().next().value||"#FFFF98"}renderButton(){const e=this.#n=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#h._signal;e.addEventListener("click",this.#f.bind(this),{signal:t}),e.addEventListener("keydown",this.#e,{signal:t});const n=this.#s=document.createElement("span");return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=this.#r,e.append(n),e}renderMainDropdown(){const e=this.#i=this.#a();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#a(){const e=document.createElement("div"),t=this.#h._signal;e.addEventListener("contextmenu",bt,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,s]of this.#h.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",s),o.title=n,o.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${n}`);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=s,o.setAttribute("aria-selected",s===this.#r),o.addEventListener("click",this.#p.bind(this,s),{signal:t}),e.append(o)}return e.addEventListener("keydown",this.#e,{signal:t}),e}#p(e,t){t.stopPropagation(),this.#d.dispatch("switchannotationeditorparams",{source:this,type:this.#u,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#n){this.#f(e);return}const t=e.target.getAttribute("data-color");t&&this.#p(t,e)}_moveToNext(e){if(!this.#v){this.#f(e);return}if(e.target===this.#n){this.#i.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#i?.firstChild||e.target===this.#n){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#f(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#v){this.#f(e);return}this.#i.firstChild?.focus()}_moveToEnd(e){if(!this.#v){this.#f(e);return}this.#i.lastChild?.focus()}#g(e){gn._keyboardManager.exec(this,e)}#f(e){if(this.#v){this.hideDropdown();return}if(this.#o=e.detail===0,window.addEventListener("pointerdown",this.#t,{signal:this.#h._signal}),this.#i){this.#i.classList.remove("hidden");return}const t=this.#i=this.#a();this.#n.append(t)}#m(e){this.#i?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),window.removeEventListener("pointerdown",this.#t)}get#v(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#l){if(!this.#v){this.#c?.unselect();return}this.hideDropdown(),this.#n.focus({preventScroll:!0,focusVisible:this.#o})}}updateColor(e){if(this.#s&&(this.#s.style.backgroundColor=e),!this.#i)return;const t=this.#h.highlightColors.values();for(const n of this.#i.children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#n?.remove(),this.#n=null,this.#s=null,this.#i?.remove(),this.#i=null}}class Xe extends he{#e=null;#t=0;#n;#s=null;#r=null;#i=null;#o=null;#l=0;#c=null;#d=null;#h=null;#u=!1;#a=this.#y.bind(this);#p=null;#g;#f=null;#m="";#v;#_="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _l10nPromise;static _type="highlight";static _editorType=Ce.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Xe.prototype;return xe(this,"_keyboardManager",new cr([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Xe._defaultColor,this.#v=e.thickness||Xe._defaultThickness,this.#g=e.opacity||Xe._defaultOpacity,this.#n=e.boxes||null,this.#_=e.methodOfCreation||"",this.#m=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#u=!0,this.#w(e),this.#C()):(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#o=e.focusNode,this.#l=e.focusOffset,this.#E(),this.#C(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#v,methodOfCreation:this.#_}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#E(){const e=new sg(this.#n,.001);this.#d=e.getOutlines(),{x:this.x,y:this.y,width:this.width,height:this.height}=this.#d.box;const t=new sg(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#i=t.getOutlines();const{lastPoint:n}=this.#i.box;this.#p=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#w({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#d=e;const s=1.5;if(this.#i=e.getNewOutline(this.#v/2+s,.0025),t>=0)this.#h=t,this.#s=n,this.parent.drawLayer.finalizeLine(t,e),this.#f=this.parent.drawLayer.highlightOutline(this.#i);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#h,e),this.parent.drawLayer.updateBox(this.#h,Xe.#A(this.#d.box,(p-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#f,this.#i),this.parent.drawLayer.updateBox(this.#f,Xe.#A(this.#i.box,p))}const{x:o,y:l,width:u,height:d}=e.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=u,this.height=d;break;case 90:{const[p,v]=this.parentDimensions;this.x=l,this.y=1-o,this.width=u*v/p,this.height=d*p/v;break}case 180:this.x=1-o,this.y=1-l,this.width=u,this.height=d;break;case 270:{const[p,v]=this.parentDimensions;this.x=1-l,this.y=o,this.width=u*v/p,this.height=d*p/v;break}}const{lastPoint:h}=this.#i.box;this.#p=[(h[0]-o)/u,(h[1]-l)/d]}static initialize(e,t){he.initialize(e,t),Xe._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case pe.HIGHLIGHT_DEFAULT_COLOR:Xe._defaultColor=t;break;case pe.HIGHLIGHT_THICKNESS:Xe._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#p}updateParams(e,t){switch(e){case pe.HIGHLIGHT_COLOR:this.#S(t);break;case pe.HIGHLIGHT_THICKNESS:this.#b(t);break}}static get defaultPropertiesToUpdate(){return[[pe.HIGHLIGHT_DEFAULT_COLOR,Xe._defaultColor],[pe.HIGHLIGHT_THICKNESS,Xe._defaultThickness]]}get propertiesToUpdate(){return[[pe.HIGHLIGHT_COLOR,this.color||Xe._defaultColor],[pe.HIGHLIGHT_THICKNESS,this.#v||Xe._defaultThickness],[pe.HIGHLIGHT_FREE,this.#u]]}#S(e){const t=s=>{this.color=s,this.parent?.drawLayer.changeColor(this.#h,s),this.#r?.updateColor(s)},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#b(e){const t=this.#v,n=s=>{this.#v=s,this.#k(s)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#r=new gn({editor:this}),e.addColorPicker(this.#r)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#x())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#x())}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#I(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#C(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#I():e&&(this.#C(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#k(e){if(!this.#u)return;this.#w({highlightOutlines:this.#d.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}#I(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#f),this.#f=null)}#C(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#s}=e.drawLayer.highlight(this.#d,this.color,this.#g),this.#f=e.drawLayer.highlightOutline(this.#i),this.#c&&(this.#c.style.clipPath=this.#s))}static#A({x:e,y:t,width:n,height:s},o){switch(o){case 90:return{x:1-t-s,y:e,width:s,height:n};case 180:return{x:1-e-n,y:1-t-s,width:n,height:s};case 270:return{x:t,y:1-e-n,width:s,height:n}}return{x:e,y:t,width:n,height:s}}rotate(e){const{drawLayer:t}=this.parent;let n;this.#u?(e=(e-this.rotation+360)%360,n=Xe.#A(this.#d.box,e)):n=Xe.#A(this,e),t.rotate(this.#h,e),t.rotate(this.#f,e),t.updateBox(this.#h,n),t.updateBox(this.#f,Xe.#A(this.#i.box,e))}render(){if(this.div)return this.div;const e=super.render();this.#m&&(e.setAttribute("aria-label",this.#m),e.setAttribute("role","mark")),this.#u?e.classList.add("free"):this.div.addEventListener("keydown",this.#a,{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#s;const[n,s]=this.parentDimensions;return this.setDims(this.width*n,this.height*s),Bo(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.parent.drawLayer.addClass(this.#f,"hovered")}pointerleave(){this.parent.drawLayer.removeClass(this.#f,"hovered")}#y(e){Xe._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#T(!0);break;case 1:case 3:this.#T(!1);break}}#T(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#o,this.#l)}select(){super.select(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"hovered"),this.parent?.drawLayer.addClass(this.#f,"selected"))}unselect(){super.unselect(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"selected"),this.#u||this.#T(!1))}get _mustFixPosition(){return!this.#u}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(this.#h,e),this.parent.drawLayer.show(this.#f,e))}#x(){return this.#u?this.rotation:0}#M(){if(this.#u)return null;const[e,t]=this.pageDimensions,[n,s]=this.pageTranslation,o=this.#n,l=new Float32Array(o.length*8);let u=0;for(const{x:d,y:h,width:p,height:v}of o){const y=d*e+n,A=(1-h-v)*t+s;l[u]=l[u+4]=y,l[u+1]=l[u+3]=A,l[u+2]=l[u+6]=y+p*e,l[u+5]=l[u+7]=A+v*t,u+=8}return l}#P(e){return this.#d.serialize(e,this.#x())}static startHighlighting(e,t,{target:n,x:s,y:o}){const{x:l,y:u,width:d,height:h}=n.getBoundingClientRect(),p=C=>{this.#D(e,C)},v=e._signal,y={capture:!0,passive:!1,signal:v},A=C=>{C.preventDefault(),C.stopPropagation()},w=C=>{n.removeEventListener("pointermove",p),window.removeEventListener("blur",w),window.removeEventListener("pointerup",w),window.removeEventListener("pointerdown",A,y),window.removeEventListener("contextmenu",bt),this.#N(e,C)};window.addEventListener("blur",w,{signal:v}),window.addEventListener("pointerup",w,{signal:v}),window.addEventListener("pointerdown",A,y),window.addEventListener("contextmenu",bt,{signal:v}),n.addEventListener("pointermove",p,{signal:v}),this._freeHighlight=new vi({x:s,y:o},[l,u,d,h],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static#D(e,t){this._freeHighlight.add(t)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#N(e,t){this._freeHighlight.isEmpty()?e.drawLayer.removeFreeHighlight(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static deserialize(e,t,n){const s=super.deserialize(e,t,n),{rect:[o,l,u,d],color:h,quadPoints:p}=e;s.color=re.makeHexColor(...h),s.#g=e.opacity;const[v,y]=s.pageDimensions;s.width=(u-o)/v,s.height=(d-l)/y;const A=s.#n=[];for(let w=0;w<p.length;w+=8)A.push({x:(p[4]-u)/v,y:(d-(1-p[w+5]))/y,width:(p[w+2]-p[w])/v,height:(p[w+5]-p[w+1])/y});return s.#E(),s}serialize(e=!1){if(this.isEmpty()||e)return null;const t=this.getRect(0,0),n=he._colorManager.convert(this.color);return{annotationType:Ce.HIGHLIGHT,color:n,opacity:this.#g,thickness:this.#v,quadPoints:this.#M(),outlines:this.#P(t),pageIndex:this.pageIndex,rect:t,rotation:this.#x(),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}}class at extends he{#e=0;#t=0;#n=this.canvasPointermove.bind(this);#s=this.canvasPointerleave.bind(this);#r=this.canvasPointerup.bind(this);#i=this.canvasPointerdown.bind(this);#o=null;#l=new Path2D;#c=!1;#d=!1;#h=!1;#u=null;#a=0;#p=0;#g=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=Ce.INK;constructor(e){super({...e,name:"inkEditor"}),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,t){he.initialize(e,t)}static updateDefaultParams(e,t){switch(e){case pe.INK_THICKNESS:at._defaultThickness=t;break;case pe.INK_COLOR:at._defaultColor=t;break;case pe.INK_OPACITY:at._defaultOpacity=t/100;break}}updateParams(e,t){switch(e){case pe.INK_THICKNESS:this.#f(t);break;case pe.INK_COLOR:this.#m(t);break;case pe.INK_OPACITY:this.#v(t);break}}static get defaultPropertiesToUpdate(){return[[pe.INK_THICKNESS,at._defaultThickness],[pe.INK_COLOR,at._defaultColor||he._defaultLineColor],[pe.INK_OPACITY,Math.round(at._defaultOpacity*100)]]}get propertiesToUpdate(){return[[pe.INK_THICKNESS,this.thickness||at._defaultThickness],[pe.INK_COLOR,this.color||at._defaultColor||he._defaultLineColor],[pe.INK_OPACITY,Math.round(100*(this.opacity??at._defaultOpacity))]]}#f(e){const t=s=>{this.thickness=s,this.#U()},n=this.thickness;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#m(e){const t=s=>{this.color=s,this.#y()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#v(e){const t=s=>{this.opacity=s,this.#y()};e/=100;const n=this.opacity;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:pe.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#x(),this.#M()),this.isAttachedToDOM||(this.parent.add(this),this.#P()),this.#U()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#o&&(clearTimeout(this.#o),this.#o=null),this.#u?.disconnect(),this.#u=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,t]=this.parentDimensions,n=this.width*e,s=this.height*t;this.setDimensions(n,s)}enableEditMode(){this.#c||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#i,{signal:this._uiManager._signal}))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#i))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#_(){const{parentRotation:e,parentDimensions:[t,n]}=this;switch(e){case 90:return[0,n,n,t];case 180:return[t,n,t,n];case 270:return[t,0,n,t];default:return[0,0,t,n]}}#E(){const{ctx:e,color:t,opacity:n,thickness:s,parentScale:o,scaleFactor:l}=this;e.lineWidth=s*o/l,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${t}${HS(n)}`}#w(e,t){const n=this._uiManager._signal;this.canvas.addEventListener("contextmenu",bt,{signal:n}),this.canvas.addEventListener("pointerleave",this.#s,{signal:n}),this.canvas.addEventListener("pointermove",this.#n,{signal:n}),this.canvas.addEventListener("pointerup",this.#r,{signal:n}),this.canvas.removeEventListener("pointerdown",this.#i),this.isEditing=!0,this.#h||(this.#h=!0,this.#P(),this.thickness||=at._defaultThickness,this.color||=at._defaultColor||he._defaultLineColor,this.opacity??=at._defaultOpacity),this.currentPath.push([e,t]),this.#d=!1,this.#E(),this.#g=()=>{this.#I(),this.#g&&window.requestAnimationFrame(this.#g)},window.requestAnimationFrame(this.#g)}#S(e,t){const[n,s]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===n&&t===s)return;const o=this.currentPath;let l=this.#l;if(o.push([e,t]),this.#d=!0,o.length<=2){l.moveTo(...o[0]),l.lineTo(e,t);return}o.length===3&&(this.#l=l=new Path2D,l.moveTo(...o[0])),this.#C(l,...o.at(-3),...o.at(-2),e,t)}#b(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);this.#l.lineTo(...e)}#k(e,t){this.#g=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),this.#S(e,t),this.#b();let n;if(this.currentPath.length!==1)n=this.#A();else{const d=[e,t];n=[[d,d.slice(),d.slice(),d]]}const s=this.#l,o=this.currentPath;this.currentPath=[],this.#l=new Path2D;const l=()=>{this.allRawPaths.push(o),this.paths.push(n),this.bezierPath2D.push(s),this._uiManager.rebuild(this)},u=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#x(),this.#M()),this.#U())};this.addCommands({cmd:l,undo:u,mustExec:!0})}#I(){if(!this.#d)return;this.#d=!1;const e=Math.ceil(this.thickness*this.parentScale),t=this.currentPath.slice(-3),n=t.map(l=>l[0]),s=t.map(l=>l[1]);Math.min(...n)-e,Math.max(...n)+e,Math.min(...s)-e,Math.max(...s)+e;const{ctx:o}=this;o.save(),o.clearRect(0,0,this.canvas.width,this.canvas.height);for(const l of this.bezierPath2D)o.stroke(l);o.stroke(this.#l),o.restore()}#C(e,t,n,s,o,l,u){const d=(t+s)/2,h=(n+o)/2,p=(s+l)/2,v=(o+u)/2;e.bezierCurveTo(d+2*(s-d)/3,h+2*(o-h)/3,p+2*(s-p)/3,v+2*(o-v)/3,p,v)}#A(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const t=[];let n,[s,o]=e[0];for(n=1;n<e.length-2;n++){const[y,A]=e[n],[w,C]=e[n+1],T=(y+w)/2,x=(A+C)/2,I=[s+2*(y-s)/3,o+2*(A-o)/3],P=[T+2*(y-T)/3,x+2*(A-x)/3];t.push([[s,o],I,P,[T,x]]),[s,o]=[T,x]}const[l,u]=e[n],[d,h]=e[n+1],p=[s+2*(l-s)/3,o+2*(u-o)/3],v=[d+2*(l-d)/3,h+2*(u-h)/3];return t.push([[s,o],p,v,[d,h]]),t}#y(){if(this.isEmpty()){this.#N();return}this.#E();const{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),this.#N();for(const n of this.bezierPath2D)t.stroke(n)}commit(){this.#c||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#c=!0,this.div.classList.add("disabled"),this.#U(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||this.#c||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#w(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#S(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#T(e)}canvasPointerleave(e){this.#T(e)}#T(e){this.canvas.removeEventListener("pointerleave",this.#s),this.canvas.removeEventListener("pointermove",this.#n),this.canvas.removeEventListener("pointerup",this.#r),this.canvas.addEventListener("pointerdown",this.#i,{signal:this._uiManager._signal}),this.#o&&clearTimeout(this.#o),this.#o=setTimeout(()=>{this.#o=null,this.canvas.removeEventListener("contextmenu",bt)},10),this.#k(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#x(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#M(){this.#u=new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)}),this.#u.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#u?.disconnect(),this.#u=null},{once:!0})}get isResizable(){return!this.isEmpty()&&this.#c}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[n,s,o,l]=this.#_();if(this.setAt(n,s,0,0),this.setDims(o,l),this.#x(),this.width){const[u,d]=this.parentDimensions;this.setAspectRatio(this.width*u,this.height*d),this.setAt(e*u,t*d,this.width*u,this.height*d),this.#h=!0,this.#P(),this.setDims(this.width*u,this.height*d),this.#y(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#M(),this.div}#P(){if(!this.#h)return;const[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),this.#N()}setDimensions(e,t){const n=Math.round(e),s=Math.round(t);if(this.#a===n&&this.#p===s)return;this.#a=n,this.#p=s,this.canvas.style.visibility="hidden";const[o,l]=this.parentDimensions;this.width=e/o,this.height=t/l,this.fixAndSetPosition(),this.#c&&this.#D(e,t),this.#P(),this.#y(),this.canvas.style.visibility="visible",this.fixDims()}#D(e,t){const n=this.#O(),s=(e-n)/this.#t,o=(t-n)/this.#e;this.scaleFactor=Math.min(s,o)}#N(){const e=this.#O()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#F(e){const t=new Path2D;for(let n=0,s=e.length;n<s;n++){const[o,l,u,d]=e[n];n===0&&t.moveTo(...o),t.bezierCurveTo(l[0],l[1],u[0],u[1],d[0],d[1])}return t}static#L(e,t,n){const[s,o,l,u]=t;switch(n){case 0:for(let d=0,h=e.length;d<h;d+=2)e[d]+=s,e[d+1]=u-e[d+1];break;case 90:for(let d=0,h=e.length;d<h;d+=2){const p=e[d];e[d]=e[d+1]+s,e[d+1]=p+o}break;case 180:for(let d=0,h=e.length;d<h;d+=2)e[d]=l-e[d],e[d+1]+=o;break;case 270:for(let d=0,h=e.length;d<h;d+=2){const p=e[d];e[d]=l-e[d+1],e[d+1]=u-p}break;default:throw new Error("Invalid rotation")}return e}static#q(e,t,n){const[s,o,l,u]=t;switch(n){case 0:for(let d=0,h=e.length;d<h;d+=2)e[d]-=s,e[d+1]=u-e[d+1];break;case 90:for(let d=0,h=e.length;d<h;d+=2){const p=e[d];e[d]=e[d+1]-o,e[d+1]=p-s}break;case 180:for(let d=0,h=e.length;d<h;d+=2)e[d]=l-e[d],e[d+1]-=o;break;case 270:for(let d=0,h=e.length;d<h;d+=2){const p=e[d];e[d]=u-e[d+1],e[d+1]=l-p}break;default:throw new Error("Invalid rotation")}return e}#$(e,t,n,s){const o=[],l=this.thickness/2,u=e*t+l,d=e*n+l;for(const h of this.paths){const p=[],v=[];for(let y=0,A=h.length;y<A;y++){const[w,C,T,x]=h[y];if(w[0]===x[0]&&w[1]===x[1]&&A===1){const J=e*w[0]+u,j=e*w[1]+d;p.push(J,j),v.push(J,j);break}const I=e*w[0]+u,P=e*w[1]+d,M=e*C[0]+u,F=e*C[1]+d,H=e*T[0]+u,O=e*T[1]+d,K=e*x[0]+u,q=e*x[1]+d;y===0&&(p.push(I,P),v.push(I,P)),p.push(M,F,H,O,K,q),v.push(M,F),y===A-1&&v.push(K,q)}o.push({bezier:at.#L(p,s,this.rotation),points:at.#L(v,s,this.rotation)})}return o}#G(){let e=1/0,t=-1/0,n=1/0,s=-1/0;for(const o of this.paths)for(const[l,u,d,h]of o){const p=re.bezierBoundingBox(...l,...u,...d,...h);e=Math.min(e,p[0]),n=Math.min(n,p[1]),t=Math.max(t,p[2]),s=Math.max(s,p[3])}return[e,n,t,s]}#O(){return this.#c?Math.ceil(this.thickness*this.parentScale):0}#U(e=!1){if(this.isEmpty())return;if(!this.#c){this.#y();return}const t=this.#G(),n=this.#O();this.#t=Math.max(he.MIN_SIZE,t[2]-t[0]),this.#e=Math.max(he.MIN_SIZE,t[3]-t[1]);const s=Math.ceil(n+this.#t*this.scaleFactor),o=Math.ceil(n+this.#e*this.scaleFactor),[l,u]=this.parentDimensions;this.width=s/l,this.height=o/u,this.setAspectRatio(s,o);const d=this.translationX,h=this.translationY;this.translationX=-t[0],this.translationY=-t[1],this.#P(),this.#y(),this.#a=s,this.#p=o,this.setDims(s,o);const p=e?n/this.scaleFactor/2:0;this.translate(d-this.translationX-p,h-this.translationY-p)}static deserialize(e,t,n){if(e instanceof am)return null;const s=super.deserialize(e,t,n);s.thickness=e.thickness,s.color=re.makeHexColor(...e.color),s.opacity=e.opacity;const[o,l]=s.pageDimensions,u=s.width*o,d=s.height*l,h=s.parentScale,p=e.thickness/2;s.#c=!0,s.#a=Math.round(u),s.#p=Math.round(d);const{paths:v,rect:y,rotation:A}=e;for(let{bezier:C}of v){C=at.#q(C,y,A);const T=[];s.paths.push(T);let x=h*(C[0]-p),I=h*(C[1]-p);for(let M=2,F=C.length;M<F;M+=6){const H=h*(C[M]-p),O=h*(C[M+1]-p),K=h*(C[M+2]-p),q=h*(C[M+3]-p),J=h*(C[M+4]-p),j=h*(C[M+5]-p);T.push([[x,I],[H,O],[K,q],[J,j]]),x=J,I=j}const P=this.#F(T);s.bezierPath2D.push(P)}const w=s.#G();return s.#t=Math.max(he.MIN_SIZE,w[2]-w[0]),s.#e=Math.max(he.MIN_SIZE,w[3]-w[1]),s.#D(u,d),s}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),t=he._colorManager.convert(this.ctx.strokeStyle);return{annotationType:Ce.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:this.#$(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}class rc extends he{#e=null;#t=null;#n=null;#s=null;#r=null;#i="";#o=null;#l=!1;#c=null;#d=null;#h=!1;#u=!1;static _type="stamp";static _editorType=Ce.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#s=e.bitmapUrl,this.#r=e.bitmapFile}static initialize(e,t){he.initialize(e,t)}static get supportedTypes(){return xe(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return xe(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(Ce.STAMP,{bitmapFile:e.getAsFile()})}#a(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#h=e.isSvg),e.file&&(this.#i=e.file.name),this.#f()}#p(){this.#n=null,this._uiManager.enableWaiting(!1),this.#o&&this.div.focus()}#g(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#a(n,!0)).finally(()=>this.#p());return}if(this.#s){const n=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#a(s)).finally(()=>this.#p());return}if(this.#r){const n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(s=>this.#a(s)).finally(()=>this.#p());return}const e=document.createElement("input");e.type="file",e.accept=rc.supportedTypesStr;const t=this._uiManager._signal;this.#n=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this.#a(s)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#p()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#o?.remove(),this.#o=null,this.#c?.disconnect(),this.#c=null,this.#d&&(clearTimeout(this.#d),this.#d=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#g();return}super.rebuild(),this.div!==null&&(this.#t&&this.#o===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#s||this.#r||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),this.#e?this.#f():this.#g(),this.width){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s)}return this.div}#f(){const{div:e}=this;let{width:t,height:n}=this.#e;const[s,o]=this.pageDimensions,l=.75;if(this.width)t=this.width*s,n=this.height*o;else if(t>l*s||n>l*o){const p=Math.min(l*s/t,l*o/n);t*=p,n*=p}const[u,d]=this.parentDimensions;this.setDims(t*u/s,n*d/o),this._uiManager.enableWaiting(!1);const h=this.#o=document.createElement("canvas");e.append(h),e.hidden=!1,this.#E(t,n),this.#S(),this.#u||(this.parent.addUndoableEditor(this),this.#u=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&h.setAttribute("aria-label",this.#i)}#m(e,t){const[n,s]=this.parentDimensions;this.width=e/n,this.height=t/s,this.setDims(e,t),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#d!==null&&clearTimeout(this.#d);const o=200;this.#d=setTimeout(()=>{this.#d=null,this.#E(e,t)},o)}#v(e,t){const{width:n,height:s}=this.#e;let o=n,l=s,u=this.#e;for(;o>2*e||l>2*t;){const d=o,h=l;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(o,l);p.getContext("2d").drawImage(u,0,0,d,h,0,0,o,l),u=p.transferToImageBitmap()}return u}async#_(e,t,n){if(this.#l||(this.#l=!0,!await this._uiManager.isMLEnabledFor("altText")||this.hasAltText()))return;const l=new OffscreenCanvas(t,n).getContext("2d",{willReadFrequently:!0});l.drawImage(e,0,0,e.width,e.height,0,0,t,n);const d=(await this._uiManager.mlGuess({service:"moz-image-to-text",request:{data:l.getImageData(0,0,t,n).data,width:t,height:n,channels:4}}))?.output||"";this.parent&&d&&!this.hasAltText()&&(this.altTextData={altText:d,decorative:!1})}#E(e,t){e=Math.ceil(e),t=Math.ceil(t);const n=this.#o;if(!n||n.width===e&&n.height===t)return;n.width=e,n.height=t;const s=this.#h?this.#e:this.#v(e,t);this.#_(s,e,t);const o=n.getContext("2d");o.filter=this._uiManager.hcmFilter,o.drawImage(s,0,0,s.width,s.height,0,0,e,t)}getImageForAltText(){return this.#o}#w(e){if(e){if(this.#h){const s=this._uiManager.imageManager.getSvgUrl(this.#t);if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#h){const[t,n]=this.pageDimensions,s=Math.round(this.width*t*ss.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*ss.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,o);return l.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,s,o),l.transferToImageBitmap()}return structuredClone(this.#e)}#S(){this._uiManager._signal&&(this.#c=new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.#m(t.width,t.height)}),this.#c.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#c?.disconnect(),this.#c=null},{once:!0}))}static deserialize(e,t,n){if(e instanceof lm)return null;const s=super.deserialize(e,t,n),{rect:o,bitmapUrl:l,bitmapId:u,isSvg:d,accessibilityData:h}=e;u&&n.imageManager.isValidId(u)?s.#t=u:s.#s=l,s.#h=d;const[p,v]=s.pageDimensions;return s.width=(o[2]-o[0])/p,s.height=(o[3]-o[1])/v,h&&(s.altTextData=h),s}serialize(e=!1,t=null){if(this.isEmpty())return null;const n={annotationType:Ce.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#h,structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=this.#w(!0),n.accessibilityData=this.altTextData,n;const{decorative:s,altText:o}=this.altTextData;if(!s&&o&&(n.accessibilityData={type:"Figure",alt:o}),t===null)return n;t.stamps||=new Map;const l=this.#h?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:l,serialized:n}),n.bitmap=this.#w(!1);else if(this.#h){const u=t.stamps.get(this.#t);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#w(!1))}return n}}class In{#e;#t=!1;#n=null;#s=null;#r=null;#i=null;#o=null;#l=new Map;#c=!1;#d=!1;#h=!1;#u=null;#a;static _initialized=!1;static#p=new Map([et,at,rc,Xe].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,accessibilityManager:s,annotationLayer:o,drawLayer:l,textLayer:u,viewport:d,l10n:h}){const p=[...In.#p.values()];if(!In._initialized){In._initialized=!0;for(const v of p)v.initialize(h,e)}e.registerEditorTypes(p),this.#a=e,this.pageIndex=t,this.div=n,this.#e=s,this.#n=o,this.viewport=d,this.#u=u,this.drawLayer=l,this.#a.addLayer(this)}get isEmpty(){return this.#l.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===Ce.NONE}updateToolbar(e){this.#a.updateToolbar(e)}updateMode(e=this.#a.getMode()){switch(this.#_(),e){case Ce.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ce.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case Ce.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of In.#p.values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#u?.div}addInkEditorIfNeeded(e){if(this.#a.getMode()!==Ce.INK)return;if(!e){for(const n of this.#l.values())if(n.isEmpty()){n.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(e){this.#a.setEditingState(e)}addCommands(e){this.#a.addCommands(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.div.classList.toggle("disabled",!e)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const n of this.#l.values())n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#a.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!this.#n)return;const t=this.#n.getEditableAnnotations();for(const n of t){if(n.hide(),this.#a.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const s=this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}}disable(){this.#h=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const s of this.#l.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){e.set(s.annotationElementId,s);continue}else t.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){const s=this.#n.getEditableAnnotations();for(const o of s){const{id:l}=o.data;if(this.#a.isDeletedAnnotationElement(l))continue;let u=t.get(l);if(u){u.resetAnnotationElement(o),u.show(!1),o.show();continue}u=e.get(l),u&&(this.#a.addChangedExistingAnnotation(u),u.renderAnnotationElement(o),u.show(!1)),o.show()}}this.#_(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of In.#p.values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#h=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#a.getActive()!==e&&this.#a.setActiveEditor(e)}enableTextSelection(){this.div.tabIndex=-1,this.#u?.div&&!this.#i&&(this.#i=this.#g.bind(this),this.#u.div.addEventListener("pointerdown",this.#i,{signal:this.#a._signal}),this.#u.div.classList.add("highlighting"))}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#i&&(this.#u.div.removeEventListener("pointerdown",this.#i),this.#i=null,this.#u.div.classList.remove("highlighting"))}#g(e){this.#a.unselectAll();const{target:t}=e;if(t===this.#u.div||t.classList.contains("endOfContent")&&this.#u.div.contains(t)){const{isMac:n}=Rt.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#a.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Xe.startHighlighting(this,this.#a.direction==="ltr",e),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),e.preventDefault()}}enableClick(){if(this.#r)return;const e=this.#a._signal;this.#r=this.pointerdown.bind(this),this.#s=this.pointerup.bind(this),this.div.addEventListener("pointerdown",this.#r,{signal:e}),this.div.addEventListener("pointerup",this.#s,{signal:e})}disableClick(){this.#r&&(this.div.removeEventListener("pointerdown",this.#r),this.div.removeEventListener("pointerup",this.#s),this.#r=null,this.#s=null)}attach(e){this.#l.set(e.id,e);const{annotationElementId:t}=e;t&&this.#a.isDeletedAnnotationElement(t)&&this.#a.removeDeletedAnnotationElement(e)}detach(e){this.#l.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#h&&e.annotationElementId&&this.#a.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#a.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1,this.#d||this.addInkEditorIfNeeded(!1)}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#a.addDeletedAnnotationElement(e.annotationElementId),he.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#a.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),this.#a.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#o&&(e._focusEventsAllowed=!1,this.#o=setTimeout(()=>{this.#o=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return this.#a.getId()}get#f(){return In.#p.get(this.#a.getMode())}get _signal(){return this.#a._signal}#m(e){const t=this.#f;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#f?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#a.updateToolbar(e),this.#a.updateMode(e);const{offsetX:n,offsetY:s}=this.#v(),o=this.getNextId(),l=this.#m({parent:this,id:o,x:n,y:s,uiManager:this.#a,isCentered:!0,...t});l&&this.add(l)}deserialize(e){return In.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#a)||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),o=this.#m({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:this.#a,isCentered:t,...n});return o&&this.add(o),o}#v(){const{x:e,y:t,width:n,height:s}=this.div.getBoundingClientRect(),o=Math.max(0,e),l=Math.max(0,t),u=Math.min(window.innerWidth,e+n),d=Math.min(window.innerHeight,t+s),h=(o+u)/2-e,p=(l+d)/2-t,[v,y]=this.viewport.rotation%180===0?[h,p]:[p,h];return{offsetX:v,offsetY:y}}addNewEditor(){this.createAndAddNewEditor(this.#v(),!0)}setSelected(e){this.#a.setSelected(e)}toggleSelected(e){this.#a.toggleSelected(e)}isSelected(e){return this.#a.isSelected(e)}unselect(e){this.#a.unselect(e)}pointerup(e){const{isMac:t}=Rt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&this.#c){if(this.#c=!1,!this.#t){this.#t=!0;return}if(this.#a.getMode()===Ce.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(this.#a.getMode()===Ce.HIGHLIGHT&&this.enableTextSelection(),this.#c){this.#c=!1;return}const{isMac:t}=Rt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;this.#c=!0;const n=this.#a.getActive();this.#t=!n||n.isEmpty()}findNewParent(e,t,n){const s=this.#a.findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}destroy(){this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#o&&(clearTimeout(this.#o),this.#o=null);for(const e of this.#l.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#l.clear(),this.#a.removeLayer(this)}#_(){this.#d=!0;for(const e of this.#l.values())e.isEmpty()&&e.remove();this.#d=!1}render({viewport:e}){this.viewport=e,_i(this.div,e);for(const t of this.#a.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#a.commitOrRemove(),this.#_();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,_i(this.div,{rotation:n}),t!==n)for(const s of this.#l.values())s.rotate(n);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#a.viewParameters.realScale}}class ft{#e=null;#t=0;#n=new Map;#s=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#n.size>0)for(const t of this.#n.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return xe(this,"_svgFactory",new Yu)}static#r(e,{x:t=0,y:n=0,width:s=1,height:o=1}={}){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*s}%`,l.height=`${100*o}%`}#i(e){const t=ft._svgFactory.create(1,1,!0);return this.#e.append(t),t.setAttribute("aria-hidden",!0),ft.#r(t,e),t}#o(e,t){const n=ft._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const o=ft._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),s}highlight(e,t,n,s=!1){const o=this.#t++,l=this.#i(e.box);l.classList.add("highlight"),e.free&&l.classList.add("free");const u=ft._svgFactory.createElement("defs");l.append(u);const d=ft._svgFactory.createElement("path");u.append(d);const h=`path_p${this.pageIndex}_${o}`;d.setAttribute("id",h),d.setAttribute("d",e.toSVGPath()),s&&this.#s.set(o,d);const p=this.#o(u,h),v=ft._svgFactory.createElement("use");return l.append(v),l.setAttribute("fill",t),l.setAttribute("fill-opacity",n),v.setAttribute("href",`#${h}`),this.#n.set(o,l),{id:o,clipPathId:`url(#${p})`}}highlightOutline(e){const t=this.#t++,n=this.#i(e.box);n.classList.add("highlightOutline");const s=ft._svgFactory.createElement("defs");n.append(s);const o=ft._svgFactory.createElement("path");s.append(o);const l=`path_p${this.pageIndex}_${t}`;o.setAttribute("id",l),o.setAttribute("d",e.toSVGPath()),o.setAttribute("vector-effect","non-scaling-stroke");let u;if(e.free){n.classList.add("free");const p=ft._svgFactory.createElement("mask");s.append(p),u=`mask_p${this.pageIndex}_${t}`,p.setAttribute("id",u),p.setAttribute("maskUnits","objectBoundingBox");const v=ft._svgFactory.createElement("rect");p.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const y=ft._svgFactory.createElement("use");p.append(y),y.setAttribute("href",`#${l}`),y.setAttribute("stroke","none"),y.setAttribute("fill","black"),y.setAttribute("fill-rule","nonzero"),y.classList.add("mask")}const d=ft._svgFactory.createElement("use");n.append(d),d.setAttribute("href",`#${l}`),u&&d.setAttribute("mask",`url(#${u})`);const h=d.cloneNode();return n.append(h),d.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.#n.set(t,n),t}finalizeLine(e,t){const n=this.#s.get(e);this.#s.delete(e),this.updateBox(e,t.box),n.setAttribute("d",t.toSVGPath())}updateLine(e,t){this.#n.get(e).firstChild.firstChild.setAttribute("d",t.toSVGPath())}removeFreeHighlight(e){this.remove(e),this.#s.delete(e)}updatePath(e,t){this.#s.get(e).setAttribute("d",t.toSVGPath())}updateBox(e,t){ft.#r(this.#n.get(e),t)}show(e,t){this.#n.get(e).classList.toggle("hidden",!t)}rotate(e,t){this.#n.get(e).setAttribute("data-main-rotation",t)}changeColor(e,t){this.#n.get(e).setAttribute("fill",t)}changeOpacity(e,t){this.#n.get(e).setAttribute("fill-opacity",t)}addClass(e,t){this.#n.get(e).classList.add(t)}removeClass(e,t){this.#n.get(e).classList.remove(t)}remove(e){this.#e!==null&&(this.#n.get(e).remove(),this.#n.delete(e))}destroy(){this.#e=null;for(const e of this.#n.values())e.remove();this.#n.clear()}}me.AbortException;me.AnnotationEditorLayer;me.AnnotationEditorParamsType;me.AnnotationEditorType;me.AnnotationEditorUIManager;me.AnnotationLayer;me.AnnotationMode;me.CMapCompressionType;me.ColorPicker;me.DOMSVGFactory;me.DrawLayer;me.FeatureTest;var fT=me.GlobalWorkerOptions;me.ImageKind;me.InvalidPDFException;me.MissingPDFException;me.OPS;me.PDFDataRangeTransport;me.PDFDateString;me.PDFWorker;me.PasswordResponses;me.PermissionFlag;me.PixelsPerInch;me.RenderingCancelledException;me.TextLayer;me.UnexpectedResponseException;me.Util;me.VerbosityLevel;me.XfaLayer;me.build;me.createValidAbsoluteUrl;me.fetchData;var pT=me.getDocument;me.getFilenameFromUrl;me.getPdfFilenameFromUrl;me.getXfaPageViewport;me.isDataScheme;me.isPdfFile;me.noContextMenu;me.normalizeUnicode;me.setLayerDimensions;me.shadow;var gT=me.version,gi=(i=>(i.USER="user",i.AGENT="agent",i))(gi||{}),fn=(i=>(i.IDLE="idle",i.LOADING="loading",i))(fn||{}),Vo=(i=>(i.KNOWLEDGE_BASE="Knowledge Base",i.WEB_SEARCH="Web Search",i))(Vo||{});const cm=`You are a world-class mathematics professor. Your goal is to help students by providing clear, concise, and simplified step-by-step solutions to their math problems. 
Imagine you are explaining this to a high school student who is finding the topic difficult.
Focus exclusively on educational content related to mathematics.
Politely decline any request that is not related to math, explaining that your purpose is to assist with mathematics.
When providing a solution, break it down into logical, easy-to-follow steps.
If a concept is complex, explain it in simpler terms before using it in the solution.`;async function aa(i,e=3,t=1e3){let n;for(let s=0;s<e;s++)try{return await i()}catch(o){if(n=o,!(o?.message?.includes("503")||o?.message?.includes("overloaded")||o?.message?.includes("UNAVAILABLE")||o?.message?.includes("429")||o?.message?.includes("rate limit"))||s===e-1)throw o;const u=t*Math.pow(2,s);console.log(`Retry attempt ${s+1}/${e} after ${u}ms...`),await new Promise(d=>setTimeout(d,u))}throw n}function oc(i){return i?.message?.includes("503")||i?.message?.includes("overloaded")?"🔄 The AI service is currently experiencing high demand. I've tried multiple times but it's still busy. Please try again in a few moments.":i?.message?.includes("429")||i?.message?.includes("rate limit")?"⏱️ Rate limit reached. Please wait a moment before trying again.":i?.message?.includes("API key")?"🔑 There seems to be an issue with the API key. Please check your configuration.":i?.message?.includes("network")||i?.message?.includes("fetch")?"🌐 Network connection issue. Please check your internet connection and try again.":"❌ An unexpected error occurred. Please try again or check your API key."}const mT=async(i,e)=>{const t=`Is the following user query a mathematical question or directly related to a mathematical concept? Answer with only "yes" or "no".

Query: "${e}"`;try{return((await aa(async()=>await i.models.generateContent({model:"gemini-2.5-flash",contents:t}))).text||"").trim().toLowerCase().includes("yes")}catch(n){return console.error("Guardrail check failed:",n),!0}},vT=async(i,e,t)=>{let n=`User's question: "${e}". Provide a simplified, step-by-step solution.`;t&&(n=`Based on the following known information, answer the user's question.
Known Information: "${t}"
${n}`);try{const s=await aa(async()=>await i.models.generateContent({model:"gemini-2.5-pro",contents:n,config:{systemInstruction:cm,tools:t?[]:[{googleSearch:{}}]}})),o=s.text||"",l=s.candidates?.[0]?.groundingMetadata;let u=[];return l?.groundingChunks&&(u=l.groundingChunks.map(d=>({uri:d.web?.uri||"",title:d.web?.title||"Untitled"})).filter(d=>d.uri)),{answer:o,sources:u}}catch(s){throw console.error("Error generating solution:",s),new Error(oc(s))}},yT=async(i,e,t,n)=>{const s=`A student was given the following question and answer, and then provided feedback. Refine the original answer based on the feedback.

Original Question: "${e}"

Original Answer:
"${t}"

Student Feedback: "${n}"

Provide a new, refined, step-by-step solution that incorporates the feedback. If the feedback suggests the answer is wrong, provide the correct solution.`;try{return(await aa(async()=>await i.models.generateContent({model:"gemini-2.5-pro",contents:s,config:{systemInstruction:cm}}))).text||""}catch(o){throw console.error("Error refining solution:",o),new Error(oc(o))}},_T=async(i,e)=>{const t=`From the following text, identify and extract all the mathematical questions. Present them as a JSON array of strings. If no questions are found, return an empty array. Text: """${e}"""`;try{const n=await aa(async()=>await i.models.generateContent({model:"gemini-2.5-flash",contents:t,config:{responseMimeType:"application/json",responseSchema:{type:rn.OBJECT,properties:{questions:{type:rn.ARRAY,items:{type:rn.STRING}}}}}}));try{const s=(n.text||"").trim(),o=JSON.parse(s);return o&&Array.isArray(o.questions)?o.questions:[]}catch(s){return console.error("Failed to parse questions from model response:",s),[]}}catch(n){throw console.error("Error extracting questions:",n),new Error(oc(n))}},ET=[{question:"What is the Pythagorean theorem?",keywords:["pythagorean","theorem","a^2","b^2","c^2","right triangle"],answer:"The Pythagorean theorem states that in a right-angled triangle, the square of the length of the hypotenuse (the side opposite the right angle) is equal to the sum of the squares of the lengths of the other two sides. The formula is a² + b² = c²."},{question:"How do you find the area of a circle?",keywords:["area","circle","pi","radius","πr²"],answer:"The area of a circle is calculated using the formula A = πr², where 'A' is the area, 'π' (pi) is a constant approximately equal to 3.14159, and 'r' is the radius of the circle."},{question:"What is the quadratic formula?",keywords:["quadratic","formula","ax^2","bx","roots","equation"],answer:"The quadratic formula is used to find the roots (or solutions) of a quadratic equation in the form ax² + bx + c = 0. The formula is x = [-b ± sqrt(b² - 4ac)] / 2a."}],AT=()=>({searchKB:pt.useCallback(e=>{const t=e.toLowerCase();for(const n of ET)if(n.keywords.some(s=>t.includes(s)))return n.answer;return null},[])}),wT=({className:i="w-6 h-6"})=>U.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:i,children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),ST=({className:i="w-6 h-6"})=>U.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:i,children:U.jsx("path",{d:"M2.002 21.004l20-9-20-9-1.002 7.004h11.002v4H1.002l1 7.004Z",fill:"currentColor"})}),CT=({className:i="w-6 h-6"})=>U.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:i,children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z"})}),TT=({className:i="w-5 h-5"})=>U.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:i,children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H5.904c-.66 0-1.174.544-1.174 1.215v4.154c0 .671.514 1.215 1.174 1.215h1.305c.162 0 .315.031.465.09L8.21 15.307c.553.185 1.12.348 1.688.483a18.75 18.75 0 0 0 5.483-3.884c.253-.332.48-.682.682-1.051a3.397 3.397 0 0 0 .23-1.12c0-.166-.017-.332-.051-.49a1.44 1.44 0 0 0-.42-1.07Z"})}),xT=({className:i="w-5 h-5"})=>U.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:i,children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.864 4.243A7.5 7.5 0 0 1 19.5 10.5c0 2.92-.556 5.709-1.587 8.188a11.953 11.953 0 0 1-1.043 2.268c-.294.424-.904.683-1.465.683H12.25c-.47 0-.91-.121-1.308-.34L5.58 14.55a4.502 4.502 0 0 1-2.433-4.084V8.625a4.5 4.5 0 0 1 4.5-4.5h.633Z"})}),kT=({className:i})=>U.jsxs("svg",{viewBox:"0 0 200 200",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:i,children:[U.jsxs("defs",{children:[U.jsxs("linearGradient",{id:"math-icon-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[U.jsx("stop",{offset:"0%",style:{stopColor:"rgb(56, 189, 248)",stopOpacity:1}}),U.jsx("stop",{offset:"100%",style:{stopColor:"rgb(34, 211, 238)",stopOpacity:1}})]}),U.jsx("style",{children:`
                    @keyframes rotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
                    @keyframes rotate-reverse { 0% { transform: rotate(0deg); } 100% { transform: rotate(-360deg); } }
                    .orbit-1 { animation: rotate 20s linear infinite; transform-origin: 100px 100px; }
                    .orbit-2 { animation: rotate-reverse 30s linear infinite; transform-origin: 100px 100px; }
                    .orbit-3 { animation: rotate 40s linear infinite; transform-origin: 100px 100px; }
                `})]}),U.jsx("path",{d:"M100 20C144.183 20 180 55.8172 180 100C180 144.183 144.183 180 100 180C55.8172 180 20 144.183 20 100C20 55.8172 55.8172 20 100 20Z",stroke:"url(#math-icon-gradient)",strokeWidth:"4",strokeOpacity:"0.3"}),U.jsx("g",{className:"orbit-1",children:U.jsx("circle",{cx:"100",cy:"35",r:"8",fill:"url(#math-icon-gradient)"})}),U.jsx("g",{className:"orbit-2",children:U.jsx("path",{d:"M155 70L165 80L155 90",stroke:"url(#math-icon-gradient)",strokeWidth:"6",strokeLinecap:"round",strokeLinejoin:"round"})}),U.jsx("g",{className:"orbit-3",children:U.jsx("rect",{x:"40",y:"140",width:"16",height:"16",fill:"url(#math-icon-gradient)",fillOpacity:"0.8",rx:"4"})}),U.jsx("text",{x:"100",y:"112",textAnchor:"middle",fontSize:"60",fontWeight:"bold",fill:"white",children:"Σ"})]}),IT=({className:i="w-6 h-6"})=>U.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:i,children:[U.jsx("path",{d:"M12 8V4H8"}),U.jsx("rect",{width:"16",height:"12",x:"4",y:"8",rx:"2"}),U.jsx("path",{d:"M2 14h2"}),U.jsx("path",{d:"M20 14h2"}),U.jsx("path",{d:"M15 13v2"}),U.jsx("path",{d:"M9 13v2"})]}),RT=({onSendMessage:i,disabled:e,children:t})=>{const[n,s]=pt.useState(""),o=l=>{l.preventDefault(),n.trim()&&!e&&(i(n),s(""))};return U.jsxs("form",{onSubmit:o,className:"flex items-center space-x-3 p-4",children:[t,U.jsxs("div",{className:"flex-grow relative",children:[U.jsx("input",{type:"text",value:n,onChange:l=>s(l.target.value),placeholder:"Ask me anything about mathematics...",disabled:e,className:"w-full px-6 py-4 bg-white/5 text-gray-100 placeholder-gray-500 focus:outline-none transition-all duration-300 rounded-2xl border-2 border-transparent focus:border-blue-400/50 focus:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed"}),n&&U.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500",children:n.length})]}),U.jsxs("button",{type:"submit",disabled:e||!n.trim(),className:"relative p-4 rounded-2xl text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105 active:scale-95 focus:outline-none focus:ring-2 focus:ring-blue-400 shadow-lg hover:shadow-xl btn-hover-lift group","aria-label":"Send message",children:[U.jsx(ST,{className:"w-6 h-6 transform group-hover:translate-x-0.5 transition-transform"}),!e&&n.trim()&&U.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-pulse"})]})]})};function ac(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var xi=ac();function dm(i){xi=i}var rr={exec:()=>null};function be(i,e=""){let t=typeof i=="string"?i:i.source,n={replace:(s,o)=>{let l=typeof o=="string"?o:o.source;return l=l.replace(Et.caret,"$1"),t=t.replace(s,l),n},getRegex:()=>new RegExp(t,e)};return n}var Et={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:i=>new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}#`),htmlBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}<(?:[a-z].*>|!--)`,"i")},bT=/^(?:[ \t]*(?:\n|$))+/,PT=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,MT=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,fr=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,NT=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,lc=/(?:[*+-]|\d{1,9}[.)])/,hm=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,fm=be(hm).replace(/bull/g,lc).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),LT=be(hm).replace(/bull/g,lc).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),uc=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,DT=/^[^\n]+/,cc=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,FT=be(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",cc).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),UT=be(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,lc).getRegex(),la="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",dc=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,HT=be("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",dc).replace("tag",la).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),pm=be(uc).replace("hr",fr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",la).getRegex(),BT=be(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",pm).getRegex(),hc={blockquote:BT,code:PT,def:FT,fences:MT,heading:NT,hr:fr,html:HT,lheading:fm,list:UT,newline:bT,paragraph:pm,table:rr,text:DT},rg=be("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",fr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",la).getRegex(),OT={...hc,lheading:LT,table:rg,paragraph:be(uc).replace("hr",fr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",rg).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",la).getRegex()},VT={...hc,html:be(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",dc).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:rr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:be(uc).replace("hr",fr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",fm).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},GT=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,zT=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,gm=/^( {2,}|\\)\n(?!\s*$)/,qT=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ua=/[\p{P}\p{S}]/u,fc=/[\s\p{P}\p{S}]/u,mm=/[^\s\p{P}\p{S}]/u,$T=be(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,fc).getRegex(),vm=/(?!~)[\p{P}\p{S}]/u,WT=/(?!~)[\s\p{P}\p{S}]/u,YT=/(?:[^\s\p{P}\p{S}]|~)/u,KT=be(/link|code|html/,"g").replace("link",new RegExp("\\[(?:[^\\[\\]`]|(?<!`)(?<a>`+)[^`]+\\k<a>(?!`))*?\\]\\((?:\\\\[\\s\\S]|[^\\\\\\(\\)]|\\((?:\\\\[\\s\\S]|[^\\\\\\(\\)])*\\))*\\)")).replace("code",new RegExp("(?<!`)(?<b>`+)[^`]+\\k<b>(?!`)")).replace("html",/<(?! )[^<>]*?>/).getRegex(),ym=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,JT=be(ym,"u").replace(/punct/g,ua).getRegex(),XT=be(ym,"u").replace(/punct/g,vm).getRegex(),_m="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",QT=be(_m,"gu").replace(/notPunctSpace/g,mm).replace(/punctSpace/g,fc).replace(/punct/g,ua).getRegex(),ZT=be(_m,"gu").replace(/notPunctSpace/g,YT).replace(/punctSpace/g,WT).replace(/punct/g,vm).getRegex(),jT=be("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,mm).replace(/punctSpace/g,fc).replace(/punct/g,ua).getRegex(),ex=be(/\\(punct)/,"gu").replace(/punct/g,ua).getRegex(),tx=be(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),nx=be(dc).replace("(?:-->|$)","-->").getRegex(),ix=be("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",nx).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Go=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,sx=be(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Go).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Em=be(/^!?\[(label)\]\[(ref)\]/).replace("label",Go).replace("ref",cc).getRegex(),Am=be(/^!?\[(ref)\](?:\[\])?/).replace("ref",cc).getRegex(),rx=be("reflink|nolink(?!\\()","g").replace("reflink",Em).replace("nolink",Am).getRegex(),og=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,pc={_backpedal:rr,anyPunctuation:ex,autolink:tx,blockSkip:KT,br:gm,code:zT,del:rr,emStrongLDelim:JT,emStrongRDelimAst:QT,emStrongRDelimUnd:jT,escape:GT,link:sx,nolink:Am,punctuation:$T,reflink:Em,reflinkSearch:rx,tag:ix,text:qT,url:rr},ox={...pc,link:be(/^!?\[(label)\]\((.*?)\)/).replace("label",Go).getRegex(),reflink:be(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Go).getRegex()},Du={...pc,emStrongRDelimAst:ZT,emStrongLDelim:XT,url:be(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",og).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:be(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",og).getRegex()},ax={...Du,br:be(gm).replace("{2,}","*").getRegex(),text:be(Du.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Mo={normal:hc,gfm:OT,pedantic:VT},Zs={normal:pc,gfm:Du,breaks:ax,pedantic:ox},lx={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ag=i=>lx[i];function pn(i,e){if(e){if(Et.escapeTest.test(i))return i.replace(Et.escapeReplace,ag)}else if(Et.escapeTestNoEncode.test(i))return i.replace(Et.escapeReplaceNoEncode,ag);return i}function lg(i){try{i=encodeURI(i).replace(Et.percentDecode,"%")}catch{return null}return i}function ug(i,e){let t=i.replace(Et.findPipe,(o,l,u)=>{let d=!1,h=l;for(;--h>=0&&u[h]==="\\";)d=!d;return d?"|":" |"}),n=t.split(Et.splitPipe),s=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;s<n.length;s++)n[s]=n[s].trim().replace(Et.slashPipe,"|");return n}function js(i,e,t){let n=i.length;if(n===0)return"";let s=0;for(;s<n&&i.charAt(n-s-1)===e;)s++;return i.slice(0,n-s)}function ux(i,e){if(i.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<i.length;n++)if(i[n]==="\\")n++;else if(i[n]===e[0])t++;else if(i[n]===e[1]&&(t--,t<0))return n;return t>0?-2:-1}function cg(i,e,t,n,s){let o=e.href,l=e.title||null,u=i[1].replace(s.other.outputLinkReplace,"$1");n.state.inLink=!0;let d={type:i[0].charAt(0)==="!"?"image":"link",raw:t,href:o,title:l,text:u,tokens:n.inlineTokens(u)};return n.state.inLink=!1,d}function cx(i,e,t){let n=i.match(t.other.indentCodeCompensation);if(n===null)return e;let s=n[1];return e.split(`
`).map(o=>{let l=o.match(t.other.beginningSpace);if(l===null)return o;let[u]=l;return u.length>=s.length?o.slice(s.length):o}).join(`
`)}var zo=class{options;rules;lexer;constructor(i){this.options=i||xi}space(i){let e=this.rules.block.newline.exec(i);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(i){let e=this.rules.block.code.exec(i);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:js(t,`
`)}}}fences(i){let e=this.rules.block.fences.exec(i);if(e){let t=e[0],n=cx(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:n}}}heading(i){let e=this.rules.block.heading.exec(i);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let n=js(t,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(t=n.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(i){let e=this.rules.block.hr.exec(i);if(e)return{type:"hr",raw:js(e[0],`
`)}}blockquote(i){let e=this.rules.block.blockquote.exec(i);if(e){let t=js(e[0],`
`).split(`
`),n="",s="",o=[];for(;t.length>0;){let l=!1,u=[],d;for(d=0;d<t.length;d++)if(this.rules.other.blockquoteStart.test(t[d]))u.push(t[d]),l=!0;else if(!l)u.push(t[d]);else break;t=t.slice(d);let h=u.join(`
`),p=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${h}`:h,s=s?`${s}
${p}`:p;let v=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,o,!0),this.lexer.state.top=v,t.length===0)break;let y=o.at(-1);if(y?.type==="code")break;if(y?.type==="blockquote"){let A=y,w=A.raw+`
`+t.join(`
`),C=this.blockquote(w);o[o.length-1]=C,n=n.substring(0,n.length-A.raw.length)+C.raw,s=s.substring(0,s.length-A.text.length)+C.text;break}else if(y?.type==="list"){let A=y,w=A.raw+`
`+t.join(`
`),C=this.list(w);o[o.length-1]=C,n=n.substring(0,n.length-y.raw.length)+C.raw,s=s.substring(0,s.length-A.raw.length)+C.raw,t=w.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:o,text:s}}}list(i){let e=this.rules.block.list.exec(i);if(e){let t=e[1].trim(),n=t.length>1,s={type:"list",raw:"",ordered:n,start:n?+t.slice(0,-1):"",loose:!1,items:[]};t=n?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=n?t:"[*+-]");let o=this.rules.other.listItemRegex(t),l=!1;for(;i;){let d=!1,h="",p="";if(!(e=o.exec(i))||this.rules.block.hr.test(i))break;h=e[0],i=i.substring(h.length);let v=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,x=>" ".repeat(3*x.length)),y=i.split(`
`,1)[0],A=!v.trim(),w=0;if(this.options.pedantic?(w=2,p=v.trimStart()):A?w=e[1].length+1:(w=e[2].search(this.rules.other.nonSpaceChar),w=w>4?1:w,p=v.slice(w),w+=e[1].length),A&&this.rules.other.blankLine.test(y)&&(h+=y+`
`,i=i.substring(y.length+1),d=!0),!d){let x=this.rules.other.nextBulletRegex(w),I=this.rules.other.hrRegex(w),P=this.rules.other.fencesBeginRegex(w),M=this.rules.other.headingBeginRegex(w),F=this.rules.other.htmlBeginRegex(w);for(;i;){let H=i.split(`
`,1)[0],O;if(y=H,this.options.pedantic?(y=y.replace(this.rules.other.listReplaceNesting,"  "),O=y):O=y.replace(this.rules.other.tabCharGlobal,"    "),P.test(y)||M.test(y)||F.test(y)||x.test(y)||I.test(y))break;if(O.search(this.rules.other.nonSpaceChar)>=w||!y.trim())p+=`
`+O.slice(w);else{if(A||v.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||P.test(v)||M.test(v)||I.test(v))break;p+=`
`+y}!A&&!y.trim()&&(A=!0),h+=H+`
`,i=i.substring(H.length+1),v=O.slice(w)}}s.loose||(l?s.loose=!0:this.rules.other.doubleBlankLine.test(h)&&(l=!0));let C=null,T;this.options.gfm&&(C=this.rules.other.listIsTask.exec(p),C&&(T=C[0]!=="[ ] ",p=p.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:h,task:!!C,checked:T,loose:!1,text:p,tokens:[]}),s.raw+=h}let u=s.items.at(-1);if(u)u.raw=u.raw.trimEnd(),u.text=u.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let d=0;d<s.items.length;d++)if(this.lexer.state.top=!1,s.items[d].tokens=this.lexer.blockTokens(s.items[d].text,[]),!s.loose){let h=s.items[d].tokens.filter(v=>v.type==="space"),p=h.length>0&&h.some(v=>this.rules.other.anyLine.test(v.raw));s.loose=p}if(s.loose)for(let d=0;d<s.items.length;d++)s.items[d].loose=!0;return s}}html(i){let e=this.rules.block.html.exec(i);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(i){let e=this.rules.block.def.exec(i);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:n,title:s}}}table(i){let e=this.rules.block.table.exec(i);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=ug(e[1]),n=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===n.length){for(let l of n)this.rules.other.tableAlignRight.test(l)?o.align.push("right"):this.rules.other.tableAlignCenter.test(l)?o.align.push("center"):this.rules.other.tableAlignLeft.test(l)?o.align.push("left"):o.align.push(null);for(let l=0;l<t.length;l++)o.header.push({text:t[l],tokens:this.lexer.inline(t[l]),header:!0,align:o.align[l]});for(let l of s)o.rows.push(ug(l,o.header.length).map((u,d)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:o.align[d]})));return o}}lheading(i){let e=this.rules.block.lheading.exec(i);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(i){let e=this.rules.block.paragraph.exec(i);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(i){let e=this.rules.block.text.exec(i);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(i){let e=this.rules.inline.escape.exec(i);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(i){let e=this.rules.inline.tag.exec(i);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(i){let e=this.rules.inline.link.exec(i);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let o=js(t.slice(0,-1),"\\");if((t.length-o.length)%2===0)return}else{let o=ux(e[2],"()");if(o===-2)return;if(o>-1){let l=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,l).trim(),e[3]=""}}let n=e[2],s="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(n);o&&(n=o[1],s=o[3])}else s=e[3]?e[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?n=n.slice(1):n=n.slice(1,-1)),cg(e,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(i,e){let t;if((t=this.rules.inline.reflink.exec(i))||(t=this.rules.inline.nolink.exec(i))){let n=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=e[n.toLowerCase()];if(!s){let o=t[0].charAt(0);return{type:"text",raw:o,text:o}}return cg(t,s,t[0],this.lexer,this.rules)}}emStrong(i,e,t=""){let n=this.rules.inline.emStrongLDelim.exec(i);if(!(!n||n[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(n[1]||n[2])||!t||this.rules.inline.punctuation.exec(t))){let s=[...n[0]].length-1,o,l,u=s,d=0,h=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*i.length+s);(n=h.exec(e))!=null;){if(o=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!o)continue;if(l=[...o].length,n[3]||n[4]){u+=l;continue}else if((n[5]||n[6])&&s%3&&!((s+l)%3)){d+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+d);let p=[...n[0]][0].length,v=i.slice(0,s+n.index+p+l);if(Math.min(s,l)%2){let A=v.slice(1,-1);return{type:"em",raw:v,text:A,tokens:this.lexer.inlineTokens(A)}}let y=v.slice(2,-2);return{type:"strong",raw:v,text:y,tokens:this.lexer.inlineTokens(y)}}}}codespan(i){let e=this.rules.inline.code.exec(i);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),n=this.rules.other.nonSpaceChar.test(t),s=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return n&&s&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(i){let e=this.rules.inline.br.exec(i);if(e)return{type:"br",raw:e[0]}}del(i){let e=this.rules.inline.del.exec(i);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(i){let e=this.rules.inline.autolink.exec(i);if(e){let t,n;return e[2]==="@"?(t=e[1],n="mailto:"+t):(t=e[1],n=t),{type:"link",raw:e[0],text:t,href:n,tokens:[{type:"text",raw:t,text:t}]}}}url(i){let e;if(e=this.rules.inline.url.exec(i)){let t,n;if(e[2]==="@")t=e[0],n="mailto:"+t;else{let s;do s=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(s!==e[0]);t=e[0],e[1]==="www."?n="http://"+e[0]:n=e[0]}return{type:"link",raw:e[0],text:t,href:n,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(i){let e=this.rules.inline.text.exec(i);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},nn=class Fu{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||xi,this.options.tokenizer=this.options.tokenizer||new zo,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:Et,block:Mo.normal,inline:Zs.normal};this.options.pedantic?(t.block=Mo.pedantic,t.inline=Zs.pedantic):this.options.gfm&&(t.block=Mo.gfm,this.options.breaks?t.inline=Zs.breaks:t.inline=Zs.gfm),this.tokenizer.rules=t}static get rules(){return{block:Mo,inline:Zs}}static lex(e,t){return new Fu(t).lex(e)}static lexInline(e,t){return new Fu(t).inlineTokens(e)}lex(e){e=e.replace(Et.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(Et.tabCharGlobal,"    ").replace(Et.spaceLine,""));e;){let s;if(this.options.extensions?.block?.some(l=>(s=l.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);let l=t.at(-1);s.raw.length===1&&l!==void 0?l.raw+=`
`:t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);let l=t.at(-1);l?.type==="paragraph"||l?.type==="text"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+s.raw,l.text+=`
`+s.text,this.inlineQueue.at(-1).src=l.text):t.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);let l=t.at(-1);l?.type==="paragraph"||l?.type==="text"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+s.raw,l.text+=`
`+s.raw,this.inlineQueue.at(-1).src=l.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},t.push(s));continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),t.push(s);continue}let o=e;if(this.options.extensions?.startBlock){let l=1/0,u=e.slice(1),d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(l=Math.min(l,d))}),l<1/0&&l>=0&&(o=e.substring(0,l+1))}if(this.state.top&&(s=this.tokenizer.paragraph(o))){let l=t.at(-1);n&&l?.type==="paragraph"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+s.raw,l.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):t.push(s),n=o.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);let l=t.at(-1);l?.type==="text"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+s.raw,l.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):t.push(s);continue}if(e){let l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n=e,s=null;if(this.tokens.links){let u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,s.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);n=this.options.hooks?.emStrongMask?.call({lexer:this},n)??n;let o=!1,l="";for(;e;){o||(l=""),o=!1;let u;if(this.options.extensions?.inline?.some(h=>(u=h.call({lexer:this},e,t))?(e=e.substring(u.raw.length),t.push(u),!0):!1))continue;if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length);let h=t.at(-1);u.type==="text"&&h?.type==="text"?(h.raw+=u.raw,h.text+=u.text):t.push(u);continue}if(u=this.tokenizer.emStrong(e,n,l)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),t.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),t.push(u);continue}let d=e;if(this.options.extensions?.startInline){let h=1/0,p=e.slice(1),v;this.options.extensions.startInline.forEach(y=>{v=y.call({lexer:this},p),typeof v=="number"&&v>=0&&(h=Math.min(h,v))}),h<1/0&&h>=0&&(d=e.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(l=u.raw.slice(-1)),o=!0;let h=t.at(-1);h?.type==="text"?(h.raw+=u.raw,h.text+=u.text):t.push(u);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return t}},qo=class{options;parser;constructor(i){this.options=i||xi}space(i){return""}code({text:i,lang:e,escaped:t}){let n=(e||"").match(Et.notSpaceStart)?.[0],s=i.replace(Et.endingNewline,"")+`
`;return n?'<pre><code class="language-'+pn(n)+'">'+(t?s:pn(s,!0))+`</code></pre>
`:"<pre><code>"+(t?s:pn(s,!0))+`</code></pre>
`}blockquote({tokens:i}){return`<blockquote>
${this.parser.parse(i)}</blockquote>
`}html({text:i}){return i}def(i){return""}heading({tokens:i,depth:e}){return`<h${e}>${this.parser.parseInline(i)}</h${e}>
`}hr(i){return`<hr>
`}list(i){let e=i.ordered,t=i.start,n="";for(let l=0;l<i.items.length;l++){let u=i.items[l];n+=this.listitem(u)}let s=e?"ol":"ul",o=e&&t!==1?' start="'+t+'"':"";return"<"+s+o+`>
`+n+"</"+s+`>
`}listitem(i){let e="";if(i.task){let t=this.checkbox({checked:!!i.checked});i.loose?i.tokens[0]?.type==="paragraph"?(i.tokens[0].text=t+" "+i.tokens[0].text,i.tokens[0].tokens&&i.tokens[0].tokens.length>0&&i.tokens[0].tokens[0].type==="text"&&(i.tokens[0].tokens[0].text=t+" "+pn(i.tokens[0].tokens[0].text),i.tokens[0].tokens[0].escaped=!0)):i.tokens.unshift({type:"text",raw:t+" ",text:t+" ",escaped:!0}):e+=t+" "}return e+=this.parser.parse(i.tokens,!!i.loose),`<li>${e}</li>
`}checkbox({checked:i}){return"<input "+(i?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:i}){return`<p>${this.parser.parseInline(i)}</p>
`}table(i){let e="",t="";for(let s=0;s<i.header.length;s++)t+=this.tablecell(i.header[s]);e+=this.tablerow({text:t});let n="";for(let s=0;s<i.rows.length;s++){let o=i.rows[s];t="";for(let l=0;l<o.length;l++)t+=this.tablecell(o[l]);n+=this.tablerow({text:t})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+n+`</table>
`}tablerow({text:i}){return`<tr>
${i}</tr>
`}tablecell(i){let e=this.parser.parseInline(i.tokens),t=i.header?"th":"td";return(i.align?`<${t} align="${i.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:i}){return`<strong>${this.parser.parseInline(i)}</strong>`}em({tokens:i}){return`<em>${this.parser.parseInline(i)}</em>`}codespan({text:i}){return`<code>${pn(i,!0)}</code>`}br(i){return"<br>"}del({tokens:i}){return`<del>${this.parser.parseInline(i)}</del>`}link({href:i,title:e,tokens:t}){let n=this.parser.parseInline(t),s=lg(i);if(s===null)return n;i=s;let o='<a href="'+i+'"';return e&&(o+=' title="'+pn(e)+'"'),o+=">"+n+"</a>",o}image({href:i,title:e,text:t,tokens:n}){n&&(t=this.parser.parseInline(n,this.parser.textRenderer));let s=lg(i);if(s===null)return pn(t);i=s;let o=`<img src="${i}" alt="${t}"`;return e&&(o+=` title="${pn(e)}"`),o+=">",o}text(i){return"tokens"in i&&i.tokens?this.parser.parseInline(i.tokens):"escaped"in i&&i.escaped?i.text:pn(i.text)}},gc=class{strong({text:i}){return i}em({text:i}){return i}codespan({text:i}){return i}del({text:i}){return i}html({text:i}){return i}text({text:i}){return i}link({text:i}){return""+i}image({text:i}){return""+i}br(){return""}},sn=class Uu{options;renderer;textRenderer;constructor(e){this.options=e||xi,this.options.renderer=this.options.renderer||new qo,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new gc}static parse(e,t){return new Uu(t).parse(e)}static parseInline(e,t){return new Uu(t).parseInline(e)}parse(e,t=!0){let n="";for(let s=0;s<e.length;s++){let o=e[s];if(this.options.extensions?.renderers?.[o.type]){let u=o,d=this.options.extensions.renderers[u.type].call({parser:this},u);if(d!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(u.type)){n+=d||"";continue}}let l=o;switch(l.type){case"space":{n+=this.renderer.space(l);continue}case"hr":{n+=this.renderer.hr(l);continue}case"heading":{n+=this.renderer.heading(l);continue}case"code":{n+=this.renderer.code(l);continue}case"table":{n+=this.renderer.table(l);continue}case"blockquote":{n+=this.renderer.blockquote(l);continue}case"list":{n+=this.renderer.list(l);continue}case"html":{n+=this.renderer.html(l);continue}case"def":{n+=this.renderer.def(l);continue}case"paragraph":{n+=this.renderer.paragraph(l);continue}case"text":{let u=l,d=this.renderer.text(u);for(;s+1<e.length&&e[s+1].type==="text";)u=e[++s],d+=`
`+this.renderer.text(u);t?n+=this.renderer.paragraph({type:"paragraph",raw:d,text:d,tokens:[{type:"text",raw:d,text:d,escaped:!0}]}):n+=d;continue}default:{let u='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return n}parseInline(e,t=this.renderer){let n="";for(let s=0;s<e.length;s++){let o=e[s];if(this.options.extensions?.renderers?.[o.type]){let u=this.options.extensions.renderers[o.type].call({parser:this},o);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){n+=u||"";continue}}let l=o;switch(l.type){case"escape":{n+=t.text(l);break}case"html":{n+=t.html(l);break}case"link":{n+=t.link(l);break}case"image":{n+=t.image(l);break}case"strong":{n+=t.strong(l);break}case"em":{n+=t.em(l);break}case"codespan":{n+=t.codespan(l);break}case"br":{n+=t.br(l);break}case"del":{n+=t.del(l);break}case"text":{n+=t.text(l);break}default:{let u='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return n}},nr=class{options;block;constructor(i){this.options=i||xi}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(i){return i}postprocess(i){return i}processAllTokens(i){return i}emStrongMask(i){return i}provideLexer(){return this.block?nn.lex:nn.lexInline}provideParser(){return this.block?sn.parse:sn.parseInline}},dx=class{defaults=ac();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=sn;Renderer=qo;TextRenderer=gc;Lexer=nn;Tokenizer=zo;Hooks=nr;constructor(...i){this.use(...i)}walkTokens(i,e){let t=[];for(let n of i)switch(t=t.concat(e.call(this,n)),n.type){case"table":{let s=n;for(let o of s.header)t=t.concat(this.walkTokens(o.tokens,e));for(let o of s.rows)for(let l of o)t=t.concat(this.walkTokens(l.tokens,e));break}case"list":{let s=n;t=t.concat(this.walkTokens(s.items,e));break}default:{let s=n;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(o=>{let l=s[o].flat(1/0);t=t.concat(this.walkTokens(l,e))}):s.tokens&&(t=t.concat(this.walkTokens(s.tokens,e)))}}return t}use(...i){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return i.forEach(t=>{let n={...t};if(n.async=this.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let o=e.renderers[s.name];o?e.renderers[s.name]=function(...l){let u=s.renderer.apply(this,l);return u===!1&&(u=o.apply(this,l)),u}:e.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[s.level];o?o.unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&(s.level==="block"?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:s.level==="inline"&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),n.extensions=e),t.renderer){let s=this.defaults.renderer||new qo(this.defaults);for(let o in t.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let l=o,u=t.renderer[l],d=s[l];s[l]=(...h)=>{let p=u.apply(s,h);return p===!1&&(p=d.apply(s,h)),p||""}}n.renderer=s}if(t.tokenizer){let s=this.defaults.tokenizer||new zo(this.defaults);for(let o in t.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let l=o,u=t.tokenizer[l],d=s[l];s[l]=(...h)=>{let p=u.apply(s,h);return p===!1&&(p=d.apply(s,h)),p}}n.tokenizer=s}if(t.hooks){let s=this.defaults.hooks||new nr;for(let o in t.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let l=o,u=t.hooks[l],d=s[l];nr.passThroughHooks.has(o)?s[l]=h=>{if(this.defaults.async&&nr.passThroughHooksRespectAsync.has(o))return(async()=>{let v=await u.call(s,h);return d.call(s,v)})();let p=u.call(s,h);return d.call(s,p)}:s[l]=(...h)=>{if(this.defaults.async)return(async()=>{let v=await u.apply(s,h);return v===!1&&(v=await d.apply(s,h)),v})();let p=u.apply(s,h);return p===!1&&(p=d.apply(s,h)),p}}n.hooks=s}if(t.walkTokens){let s=this.defaults.walkTokens,o=t.walkTokens;n.walkTokens=function(l){let u=[];return u.push(o.call(this,l)),s&&(u=u.concat(s.call(this,l))),u}}this.defaults={...this.defaults,...n}}),this}setOptions(i){return this.defaults={...this.defaults,...i},this}lexer(i,e){return nn.lex(i,e??this.defaults)}parser(i,e){return sn.parse(i,e??this.defaults)}parseMarkdown(i){return(e,t)=>{let n={...t},s={...this.defaults,...n},o=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&n.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=i),s.async)return(async()=>{let l=s.hooks?await s.hooks.preprocess(e):e,u=await(s.hooks?await s.hooks.provideLexer():i?nn.lex:nn.lexInline)(l,s),d=s.hooks?await s.hooks.processAllTokens(u):u;s.walkTokens&&await Promise.all(this.walkTokens(d,s.walkTokens));let h=await(s.hooks?await s.hooks.provideParser():i?sn.parse:sn.parseInline)(d,s);return s.hooks?await s.hooks.postprocess(h):h})().catch(o);try{s.hooks&&(e=s.hooks.preprocess(e));let l=(s.hooks?s.hooks.provideLexer():i?nn.lex:nn.lexInline)(e,s);s.hooks&&(l=s.hooks.processAllTokens(l)),s.walkTokens&&this.walkTokens(l,s.walkTokens);let u=(s.hooks?s.hooks.provideParser():i?sn.parse:sn.parseInline)(l,s);return s.hooks&&(u=s.hooks.postprocess(u)),u}catch(l){return o(l)}}}onError(i,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,i){let n="<p>An error occurred:</p><pre>"+pn(t.message+"",!0)+"</pre>";return e?Promise.resolve(n):n}if(e)return Promise.reject(t);throw t}}},Ai=new dx;function Ne(i,e){return Ai.parse(i,e)}Ne.options=Ne.setOptions=function(i){return Ai.setOptions(i),Ne.defaults=Ai.defaults,dm(Ne.defaults),Ne};Ne.getDefaults=ac;Ne.defaults=xi;Ne.use=function(...i){return Ai.use(...i),Ne.defaults=Ai.defaults,dm(Ne.defaults),Ne};Ne.walkTokens=function(i,e){return Ai.walkTokens(i,e)};Ne.parseInline=Ai.parseInline;Ne.Parser=sn;Ne.parser=sn.parse;Ne.Renderer=qo;Ne.TextRenderer=gc;Ne.Lexer=nn;Ne.lexer=nn.lex;Ne.Tokenizer=zo;Ne.Hooks=nr;Ne.parse=Ne;Ne.options;Ne.setOptions;Ne.use;Ne.walkTokens;Ne.parseInline;sn.parse;nn.lex;const hx=({messageId:i,onFeedback:e})=>{const[t,n]=pt.useState(!1),[s,o]=pt.useState(""),[l,u]=pt.useState(!1),d=p=>{p?(e(i,"The answer was correct and helpful."),u(!0)):n(!0)},h=()=>{s.trim()&&(e(i,s),n(!1),o(""),u(!0))};return l?U.jsx("div",{className:"p-3 bg-green-500/10 border-2 border-green-400/30 rounded-xl",children:U.jsxs("p",{className:"text-xs text-green-300 font-semibold flex items-center gap-2",children:[U.jsx("span",{children:"🎉"}),"Thank you for your feedback!"]})}):U.jsxs("div",{className:"mt-4",children:[!t&&U.jsxs("div",{className:"flex items-center gap-3 p-4 glass-strong rounded-2xl border-2 border-white/20",children:[U.jsx("span",{className:"text-sm text-gray-300 font-semibold",children:"Was this helpful?"}),U.jsxs("div",{className:"flex gap-2 ml-auto",children:[U.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 text-gray-300 hover:text-white bg-green-600/20 hover:bg-green-600/40 border-2 border-green-500/30 hover:border-green-400/60 rounded-xl transition-all duration-300 transform hover:scale-105 group shadow-lg hover:shadow-green-500/20","aria-label":"Good answer",children:[U.jsx(TT,{className:"w-5 h-5 group-hover:animate-bounce"}),U.jsx("span",{className:"text-sm font-medium",children:"Helpful"})]}),U.jsxs("button",{onClick:()=>d(!1),className:"flex items-center gap-2 px-4 py-2 text-gray-300 hover:text-white bg-red-600/20 hover:bg-red-600/40 border-2 border-red-500/30 hover:border-red-400/60 rounded-xl transition-all duration-300 transform hover:scale-105 group shadow-lg hover:shadow-red-500/20","aria-label":"Bad answer",children:[U.jsx(xT,{className:"w-5 h-5 group-hover:animate-bounce"}),U.jsx("span",{className:"text-sm font-medium",children:"Not Helpful"})]})]})]}),t&&U.jsxs("div",{className:"space-y-3 p-4 glass-strong rounded-2xl border-2 border-blue-400/30",children:[U.jsx("textarea",{value:s,onChange:p=>o(p.target.value),placeholder:"Tell me how I can improve this answer...",rows:3,className:"w-full p-3 border-2 border-white/10 rounded-xl bg-white/5 text-gray-300 placeholder-gray-500 focus:outline-none focus:border-blue-400/50 transition-all duration-300 resize-none"}),U.jsx("button",{onClick:h,className:"w-full px-4 py-3 font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl hover:from-blue-500 hover:to-purple-500 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-[1.02] active:scale-95 shadow-lg",disabled:!s.trim(),children:"✨ Refine Answer"})]})]})},fx=({source:i})=>U.jsxs("a",{href:i.uri,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 glass text-blue-300 text-xs font-medium px-3 py-2 rounded-xl hover:glass-strong hover:text-blue-200 transition-all duration-300 truncate max-w-xs border-2 border-blue-400/30 hover:border-blue-400/50 transform hover:scale-105 group",title:i.title,children:[U.jsx("span",{className:"text-sm",children:"🔗"}),U.jsx("span",{className:"group-hover:underline",children:i.title||new URL(i.uri).hostname}),U.jsx("svg",{className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),px=({questions:i,onQuestionSelect:e})=>i.length===0?null:U.jsxs("div",{className:"mt-6 flex flex-col space-y-3",children:[U.jsxs("h4",{className:"text-sm font-semibold text-gray-300 flex items-center gap-2",children:[U.jsx("span",{children:"📋"}),U.jsx("span",{children:"Extracted Questions"})]}),i.map((t,n)=>U.jsx("button",{onClick:()=>e(t),className:"group w-full text-left p-4 glass rounded-xl hover:glass-strong border-2 border-white/10 hover:border-blue-400/50 transition-all duration-300 card-hover",children:U.jsxs("div",{className:"flex items-start gap-3",children:[U.jsxs("span",{className:"text-blue-400 font-bold text-sm mt-0.5",children:[n+1,"."]}),U.jsx("p",{className:"text-sm text-gray-300 group-hover:text-white transition-colors flex-1",children:t}),U.jsx("svg",{className:"w-5 h-5 text-blue-400 opacity-0 group-hover:opacity-100 transition-all transform group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},n))]}),gx=()=>U.jsxs("div",{className:"flex items-center space-x-2 p-3",children:[U.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-blue-400 to-cyan-400 rounded-full typing-dot",style:{animationDelay:"0s"}}),U.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-blue-400 to-cyan-400 rounded-full typing-dot",style:{animationDelay:"0.2s"}}),U.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-blue-400 to-cyan-400 rounded-full typing-dot",style:{animationDelay:"0.4s"}}),U.jsx("span",{className:"text-sm text-gray-400 ml-2",children:"Thinking..."})]}),mx=({message:i,onFeedback:e,onQuestionSelect:t})=>{const n=i.role===gi.USER,s=()=>{const u=`
# Math Agent Solution

---

**Answer:**
${i.text}

---
**Source:** ${i.knowledgeSource||"N/A"}
${i.sources&&i.sources.length>0?`
**Web Sources:**
${i.sources.map(v=>`- [${v.title}](${v.uri})`).join(`
`)}
`:""}
    `,d=new Blob([u.trim()],{type:"text/markdown"}),h=URL.createObjectURL(d),p=document.createElement("a");p.href=h,p.download=`math_agent_solution_${i.id}.md`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(h)},o=()=>{if(i.isLoading)return U.jsx(gx,{});const u=Ne.parse(i.text.replace(/<script.*?>.*?<\/script>/gi,""));return U.jsx("div",{className:"prose prose-sm prose-invert max-w-none prose-p:text-gray-300 prose-headings:text-white prose-strong:text-white prose-code:text-cyan-300 prose-a:text-blue-400",dangerouslySetInnerHTML:{__html:u}})};return U.jsxs("div",{className:`flex items-start gap-4 ${n?"flex-row-reverse":""} ${n?"message-bubble-user":"message-bubble-agent"}`,children:[!n&&U.jsx("div",{className:"w-12 h-12 flex-shrink-0 flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl shadow-lg glow-blue",children:U.jsx(IT,{className:"w-7 h-7 text-white"})}),n&&U.jsx("div",{className:"w-12 h-12 flex-shrink-0 flex items-center justify-center bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl shadow-lg",children:U.jsx("span",{className:"text-2xl",children:"👤"})}),U.jsx("div",{className:`max-w-3xl ${n?"ml-auto":"mr-auto"}`,children:U.jsxs("div",{className:`w-full p-6 rounded-3xl shadow-2xl transition-all duration-300 ${n?"bg-gradient-to-br from-blue-600/80 to-blue-500/80 text-white glass-strong border-2 border-blue-400/30 rounded-br-md":i.isError?"bg-gradient-to-br from-red-600/50 to-red-500/50 text-red-100 glass-strong border-2 border-red-400/50 rounded-bl-md":"glass-strong text-gray-100 rounded-bl-md border-2 border-white/10 relative overflow-hidden hover:border-blue-400/30"}`,children:[!n&&!i.isError&&!i.isLoading&&U.jsx("div",{className:"absolute top-0 left-0 h-full w-1.5 bg-gradient-to-b from-blue-400 via-purple-500 to-cyan-400"}),U.jsx("div",{className:"whitespace-pre-wrap pl-2",children:o()}),i.extractedQuestions&&t&&U.jsx(px,{questions:i.extractedQuestions,onQuestionSelect:t}),!n&&!i.isError&&!i.isLoading&&i.text&&U.jsxs("div",{className:"mt-6 pt-4 border-t border-white/20 pl-2",children:[i.knowledgeSource&&U.jsxs("div",{className:"flex items-center justify-between mb-4",children:[U.jsxs("span",{className:`text-xs font-bold px-3 py-1.5 rounded-full border-2 ${i.knowledgeSource===Vo.KNOWLEDGE_BASE?"bg-gradient-to-r from-green-500/20 to-emerald-500/20 text-green-300 border-green-400/50":"bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border-purple-400/50"}`,children:["🔍 ",i.knowledgeSource]}),U.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-blue-400 transition-all duration-300 hover:scale-110 btn-hover-lift glass rounded-xl","aria-label":"Download answer as Markdown",children:U.jsx(wT,{className:"w-5 h-5"})})]}),i.isRefined&&U.jsx("div",{className:"mb-3 p-3 bg-green-500/10 border-2 border-green-400/30 rounded-xl",children:U.jsxs("p",{className:"text-xs text-green-300 font-semibold flex items-center gap-2",children:[U.jsx("span",{children:"✨"}),"This answer has been refined based on your feedback"]})}),i.sources&&i.sources.length>0&&U.jsxs("div",{className:"mt-2",children:[U.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-2",children:"Web Sources:"}),U.jsx("div",{className:"flex flex-wrap gap-2",children:i.sources.map((u,d)=>U.jsx(fx,{source:u},d))})]}),e&&!i.isRefined&&!i.extractedQuestions&&U.jsx(hx,{messageId:i.id,onFeedback:e})]})]})})]})},vx=({onFileSelect:i,disabled:e})=>{const t=pt.useRef(null),n=o=>{o.target.files&&o.target.files.length>0&&(i(o.target.files[0]),o.target.value="")},s=()=>{t.current?.click()};return U.jsxs(U.Fragment,{children:[U.jsx("input",{type:"file",ref:t,onChange:n,className:"hidden",accept:".txt,.pdf",disabled:e}),U.jsxs("button",{type:"button",onClick:s,disabled:e,className:"relative p-4 rounded-2xl text-gray-400 hover:text-blue-400 hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105 active:scale-95 glass group","aria-label":"Upload a text or PDF file",children:[U.jsx(CT,{className:"w-6 h-6 transform group-hover:-translate-y-0.5 transition-transform"}),U.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-blue-400 rounded-full opacity-0 group-hover:opacity-100 animate-pulse transition-opacity"})]})]})};fT.workerSrc=`https://aistudiocdn.com/pdfjs-dist@${gT}/build/pdf.worker.min.js`;const yx=()=>{const[i,e]=pt.useState([]),[t,n]=pt.useState(fn.IDLE),{searchKB:s}=AT(),o=pt.useRef(null),l=pt.useCallback(()=>{o.current?.scrollTo({top:o.current.scrollHeight,behavior:"smooth"})},[]);pt.useEffect(()=>{l()},[i,l]);const u=pt.useCallback(async A=>{if(!A.trim())return;const w={id:Date.now(),text:A,role:gi.USER},C={id:Date.now()+1,text:"",role:gi.AGENT,isLoading:!0};e(T=>[...T,w,C]),n(fn.LOADING);try{const T=new uu({apiKey:"AIzaSyCMG88v6XGTNnPsn44KvFo4ty2gyhZPWsY"});if(!await mT(T,A)){const H={...C,isLoading:!1,text:"As a mathematics professor, my focus is on math-related topics. Please ask me a question about mathematics."};e(O=>O.map(K=>K.id===C.id?H:K));return}const I=s(A),{answer:P,sources:M}=await vT(T,A,I),F={...C,isLoading:!1,text:P,sources:M,knowledgeSource:I?Vo.KNOWLEDGE_BASE:Vo.WEB_SEARCH};e(H=>H.map(O=>O.id===C.id?F:O))}catch(T){console.error(T);const x={...C,isLoading:!1,text:T instanceof Error?T.message:"Sorry, I encountered an error. Please check your API key and try again.",isError:!0};e(I=>I.map(P=>P.id===C.id?x:P))}finally{n(fn.IDLE)}},[s]),d=pt.useCallback(async(A,w)=>{const C=i.findIndex(I=>I.id===A);if(C===-1||C===0)return;const T=i[C],x=i[C-1].text;n(fn.LOADING),e(I=>I.map(P=>P.id===A?{...P,isRefined:!0}:P));try{const I=new uu({apiKey:"AIzaSyCMG88v6XGTNnPsn44KvFo4ty2gyhZPWsY"}),P=await yT(I,x,T.text,w),M={...T,id:Date.now(),text:P,isRefined:!0};e(F=>F.map(H=>H.id===A?M:H))}catch(I){console.error(I);const P={id:Date.now()+1,text:I instanceof Error?I.message:"Sorry, I could not refine the answer. Please try again.",role:gi.AGENT,isError:!0};e(M=>[...M,P]),e(M=>M.map(F=>F.id===A?{...F,isRefined:!1}:F))}finally{n(fn.IDLE)}},[i]),h=pt.useCallback(async A=>{await u(A)},[u]),p=async A=>{if(A.type==="application/pdf"){const w=await A.arrayBuffer(),C=await pT(w).promise;let T="";for(let x=1;x<=C.numPages;x++){const P=await(await C.getPage(x)).getTextContent();T+=P.items.map(M=>M.str).join(" ")}return T}else return A.text()},v=pt.useCallback(async A=>{if(!A||!A.type.startsWith("text/")&&A.type!=="application/pdf"){const C={id:Date.now(),text:"Please upload a valid .txt or .pdf file.",role:gi.AGENT,isError:!0};e(T=>[...T,C]);return}const w={id:Date.now()+1,text:`Analyzing ${A.name}...`,role:gi.AGENT,isLoading:!0};e(C=>[...C,w]),n(fn.LOADING);try{const C=await p(A);if(!C.trim())throw new Error("File is empty or could not be read.");const T=new uu({apiKey:"AIzaSyCMG88v6XGTNnPsn44KvFo4ty2gyhZPWsY"}),x=await _T(T,C);let I,P;x.length>0?(I="I have analyzed the document and found these questions. Select one to begin.",P=x):I="I've analyzed the document, but I couldn't find any specific mathematical questions. You can ask me a question about the document's content directly.";const M={...w,isLoading:!1,text:I,extractedQuestions:P};e(F=>F.map(H=>H.id===w.id?M:H))}catch(C){console.error(C);const T={...w,isLoading:!1,text:C instanceof Error?C.message:"Could not extract questions from the file. The file might be empty or in an unsupported format.",isError:!0};e(x=>x.map(I=>I.id===w.id?T:I))}finally{n(fn.IDLE)}},[]),y=["What is the Pythagorean theorem?","How do you find the area of a circle with radius 5?","Solve for x: 2x^2 - 8x - 10 = 0"];return U.jsxs("div",{className:"flex flex-col h-screen font-sans text-gray-100 relative z-10",children:[U.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 p-4 glass-strong shadow-2xl",children:U.jsxs("div",{className:"max-w-7xl mx-auto",children:[U.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-center gradient-text mb-1",children:"🧮 Math Professor AI"}),U.jsx("p",{className:"text-center text-sm text-gray-400",children:"Your AI-Powered Mathematics Companion"})]})}),U.jsxs("div",{className:"flex flex-col flex-grow w-full h-full max-w-6xl mx-auto pt-28 pb-32 px-4",children:[U.jsxs("main",{ref:o,className:"flex-grow overflow-y-auto space-y-6 scroll-smooth",children:[i.length===0&&U.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[U.jsxs("div",{className:"mb-8 relative",children:[U.jsx("div",{className:"absolute inset-0 blur-3xl opacity-30 bg-gradient-to-r from-blue-500 via-purple-500 to-cyan-500 rounded-full"}),U.jsx("div",{className:"relative w-24 h-24 md:w-32 md:h-32 mx-auto text-blue-400 glow-blue rounded-full p-6 glass",children:U.jsx(kT,{})})]}),U.jsx("h2",{className:"text-3xl md:text-5xl font-bold mb-3 text-white",children:"How can I help you today?"}),U.jsx("p",{className:"max-w-2xl mb-12 text-gray-400 text-lg",children:"Ask any math question or upload a document with problems to get started"}),U.jsx("div",{className:"w-full max-w-3xl grid grid-cols-1 md:grid-cols-2 gap-4",children:y.map((A,w)=>U.jsxs("button",{onClick:()=>u(A),className:"group text-left p-6 glass rounded-2xl hover:glass-strong card-hover border-2 border-transparent hover:border-blue-500/50 transition-all duration-300",style:{animationDelay:`${w*100}ms`},children:[U.jsxs("div",{className:"flex items-start gap-3",children:[U.jsx("span",{className:"text-2xl",children:"💡"}),U.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors flex-1",children:A})]}),U.jsxs("div",{className:"mt-3 flex items-center text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity",children:[U.jsx("span",{className:"text-sm",children:"Ask this question"}),U.jsx("svg",{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},A))}),U.jsxs("div",{className:"mt-16 grid grid-cols-1 md:grid-cols-3 gap-6 w-full max-w-4xl",children:[U.jsxs("div",{className:"text-center p-6 glass rounded-2xl",children:[U.jsx("div",{className:"text-3xl mb-3",children:"🤖"}),U.jsx("h3",{className:"font-semibold text-white mb-2",children:"AI-Powered"}),U.jsx("p",{className:"text-sm text-gray-400",children:"Advanced Gemini AI for accurate solutions"})]}),U.jsxs("div",{className:"text-center p-6 glass rounded-2xl",children:[U.jsx("div",{className:"text-3xl mb-3",children:"📚"}),U.jsx("h3",{className:"font-semibold text-white mb-2",children:"Step-by-Step"}),U.jsx("p",{className:"text-sm text-gray-400",children:"Detailed explanations for every problem"})]}),U.jsxs("div",{className:"text-center p-6 glass rounded-2xl",children:[U.jsx("div",{className:"text-3xl mb-3",children:"📄"}),U.jsx("h3",{className:"font-semibold text-white mb-2",children:"Document Upload"}),U.jsx("p",{className:"text-sm text-gray-400",children:"Extract questions from PDF & TXT files"})]})]})]}),i.map(A=>U.jsx(mx,{message:A,onFeedback:d,onQuestionSelect:h},A.id))]}),U.jsx("footer",{className:"fixed bottom-0 left-0 right-0 z-50 pb-6",children:U.jsx("div",{className:"max-w-6xl mx-auto px-4",children:U.jsx("div",{className:"glass-strong rounded-3xl shadow-2xl glow-blue border-2 border-white/10 overflow-hidden",children:U.jsx(RT,{onSendMessage:u,disabled:t===fn.LOADING,children:U.jsx(vx,{onFileSelect:v,disabled:t===fn.LOADING})})})})})]})]})},wm=document.getElementById("root");if(!wm)throw new Error("Could not find root element to mount to");const _x=Ry.createRoot(wm);_x.render(U.jsx(wy.StrictMode,{children:U.jsx(yx,{})}));
